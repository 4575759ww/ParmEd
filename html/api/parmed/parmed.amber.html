<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>parmed.amber package &mdash; ParmEd 2.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ParmEd 2.0 documentation" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="parmed-amber-package">
<h1>parmed.amber package<a class="headerlink" href="#parmed-amber-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.mdin.html">parmed.amber.mdin package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parmed.amber.mdin.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parmed.amber.mdin.cntrl.html">parmed.amber.mdin.cntrl module</a></li>
<li class="toctree-l3"><a class="reference internal" href="parmed.amber.mdin.ewald.html">parmed.amber.mdin.ewald module</a></li>
<li class="toctree-l3"><a class="reference internal" href="parmed.amber.mdin.mdin.html">parmed.amber.mdin.mdin module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parmed.amber.mdin.pb.html">parmed.amber.mdin.pb module</a></li>
<li class="toctree-l3"><a class="reference internal" href="parmed.amber.mdin.qmmm.html">parmed.amber.mdin.qmmm module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parmed.amber.mdin.html#module-parmed.amber.mdin">Module contents</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.amberformat.html">parmed.amber.amberformat module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.asciicrd.html">parmed.amber.asciicrd module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.mask.html">parmed.amber.mask module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.netcdffiles.html">parmed.amber.netcdffiles module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.offlib.html">parmed.amber.offlib module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.parameters.html">parmed.amber.parameters module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.readparm.html">parmed.amber.readparm module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parmed.amber.titratable_residues.html">parmed.amber.titratable_residues module</a><ul class="simple">
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="module-parmed.amber">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-parmed.amber" title="Permalink to this headline">¶</a></h2>
<p>Package that provides an API to Amber-specific files</p>
<dl class="class">
<dt id="parmed.amber.AmberFormat">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberFormat</tt><big>(</big><em>fname=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>A class that can parse and print files stored in the Amber topology or MDL
format. In particular, these files have the general form:</p>
<p><tt class="docutils literal"><span class="pre">`</span>
<span class="pre">%VERSION</span> <span class="pre">VERSION_STAMP</span> <span class="pre">=</span> <span class="pre">V00001.000</span>&nbsp; <span class="pre">DATE</span> <span class="pre">=</span> <span class="pre">XX/XX/XX</span>&nbsp; <span class="pre">XX:XX:XX</span>
<span class="pre">%FLAG</span> <span class="pre">&lt;FLAG_NAME&gt;</span>
<span class="pre">%COMMENT</span> <span class="pre">&lt;comments&gt;</span>
<span class="pre">%FORMAT(&lt;Fortran_Format&gt;)</span>
<span class="pre">...</span> <span class="pre">data</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">that</span> <span class="pre">Fortran</span> <span class="pre">Format</span>
<span class="pre">%FLAG</span> <span class="pre">&lt;FLAG_NAME2&gt;</span>
<span class="pre">%COMMENT</span> <span class="pre">&lt;comments&gt;</span>
<span class="pre">%FORMAT(&lt;Fortran_Format&gt;)</span>
<span class="pre">...</span> <span class="pre">data</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">that</span> <span class="pre">Fortran</span> <span class="pre">Format</span>
<span class="pre">`</span></tt></p>
<p>where the <cite>%COMMENT</cite> sections are entirely optional</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str=None</p>
<blockquote class="last">
<div><p>If provided, this file is parsed and the data structures will be loaded
from the data in this file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>parm_data</td>
<td>(dict {str) A dictionary that maps FLAG names to all of the data contained in that section of the Amber file.</td>
</tr>
<tr class="row-even"><td>formats</td>
<td>(dict {str) A dictionary that maps FLAG names to the FortranFormat instance in which the data is stored in that section</td>
</tr>
<tr class="row-odd"><td>parm_comments</td>
<td>(dict {str) A dictionary that maps FLAG names to the list of COMMENT lines that were stored in the original file</td>
</tr>
<tr class="row-even"><td>flag_list</td>
<td>(list) An ordered list of all FLAG names. This must be kept synchronized with <cite>parm_data</cite>, <cite>formats</cite>, and <cite>parm_comments</cite> such that every item in <cite>flag_list</cite> is a key to those 3 dicts and no other keys exist</td>
</tr>
<tr class="row-odd"><td>charge_flag</td>
<td>(str=&#8217;CHARGE&#8217;) The name of the name of the FLAG that describes partial atomic charge data. If this flag is found, then its data are multiplied by the ELECTROSTATIC_CONSTANT to convert back to fractions of electrons</td>
</tr>
<tr class="row-even"><td>version</td>
<td>(str) The VERSION string from the Amber file</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>(str) The file name of the originally parsed file (set to the fname parameter)</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.addFlag" title="parmed.amber.AmberFormat.addFlag"><tt class="xref py py-obj docutils literal"><span class="pre">addFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberFormat.add_flag" title="parmed.amber.AmberFormat.add_flag"><tt class="xref py py-obj docutils literal"><span class="pre">add_flag</span></tt></a>(flag_name,&nbsp;flag_format[,&nbsp;data,&nbsp;...])</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.deleteFlag" title="parmed.amber.AmberFormat.deleteFlag"><tt class="xref py py-obj docutils literal"><span class="pre">deleteFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberFormat.delete_flag" title="parmed.amber.AmberFormat.delete_flag"><tt class="xref py py-obj docutils literal"><span class="pre">delete_flag</span></tt></a>(flag_name)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.id_format" title="parmed.amber.AmberFormat.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as either Amber-format file (like prmtop) or an old-style topology file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberFormat.parse" title="parmed.amber.AmberFormat.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(filename,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Meant for use with the automatic file loader, this will automatically</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.rdparm" title="parmed.amber.AmberFormat.rdparm"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm</span></tt></a>(fname[,&nbsp;slow])</td>
<td>Parses the Amber format file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberFormat.rdparm_old" title="parmed.amber.AmberFormat.rdparm_old"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_old</span></tt></a>(prmtop_lines[,&nbsp;check])</td>
<td>This reads an old-style topology file and stores the results in the</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.rdparm_slow" title="parmed.amber.AmberFormat.rdparm_slow"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_slow</span></tt></a>(fname)</td>
<td>Parses the Amber format file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberFormat.set_version" title="parmed.amber.AmberFormat.set_version"><tt class="xref py py-obj docutils literal"><span class="pre">set_version</span></tt></a>()</td>
<td>Sets the version string</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.view_as" title="parmed.amber.AmberFormat.view_as"><tt class="xref py py-obj docutils literal"><span class="pre">view_as</span></tt></a>(cls)</td>
<td>Returns a view of the current object as another object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberFormat.writeParm" title="parmed.amber.AmberFormat.writeParm"><tt class="xref py py-obj docutils literal"><span class="pre">writeParm</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberFormat.write_parm" title="parmed.amber.AmberFormat.write_parm"><tt class="xref py py-obj docutils literal"><span class="pre">write_parm</span></tt></a>(name)</td>
<td>Writes the current data in parm_data into a new topology file with</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="parmed.amber.AmberFormat.addFlag">
<tt class="descname">addFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.addFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.add_flag">
<tt class="descname">add_flag</tt><big>(</big><em>flag_name</em>, <em>flag_format</em>, <em>data=None</em>, <em>num_items=-1</em>, <em>comments=None</em>, <em>after=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.add_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.deleteFlag">
<tt class="descname">deleteFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.deleteFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.delete_flag">
<tt class="descname">delete_flag</tt><big>(</big><em>flag_name</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.delete_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberFormat.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as either Amber-format file (like prmtop) or an
old-style topology file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber-style format, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberFormat.parse">
<em class="property">static </em><tt class="descname">parse</tt><big>(</big><em>filename</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Meant for use with the automatic file loader, this will automatically
return a subclass of AmberFormat corresponding to what the information
in the prmtop file contains (i.e., either an AmberParm, ChamberParm,
AmoebaParm, or AmberFormat)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.rdparm">
<tt class="descname">rdparm</tt><big>(</big><em>fname</em>, <em>slow=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.rdparm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.rdparm_old">
<tt class="descname">rdparm_old</tt><big>(</big><em>prmtop_lines</em>, <em>check=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.rdparm_old" title="Permalink to this definition">¶</a></dt>
<dd><p>This reads an old-style topology file and stores the results in the
same data structures as a new-style topology file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prmtop_lines</strong> : list of str</p>
<blockquote>
<div><p>List of all lines in the prmtop file</p>
</div></blockquote>
<p><strong>check</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, only the first couple sections will be read to determine if
this is, in fact, an old-style topology file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.rdparm_slow">
<tt class="descname">rdparm_slow</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.rdparm_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file. This parser is written in pure Python and
is therefore slower than the C++-optimized version</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.set_version">
<tt class="descname">set_version</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.set_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the version string</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.view_as">
<tt class="descname">view_as</tt><big>(</big><em>cls</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.view_as" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view of the current object as another object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : type</p>
<blockquote>
<div><p>Class definition of an AmberParm subclass for the current object to
be converted into</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of cls initialized from data in this object. This is NOT a deep</p>
<p>copy, so modifying the original object may modify this. The copy</p>
<p class="last">function will create a deep copy of any AmberFormat-derived object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.writeParm">
<tt class="descname">writeParm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.writeParm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberFormat.write_parm">
<tt class="descname">write_parm</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberFormat.write_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current data in parm_data into a new topology file with
the given name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote class="last">
<div><p>Name of the file to write the topology file to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.FortranFormat">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">FortranFormat</tt><big>(</big><em>format_string</em>, <em>strip_strings=True</em><big>)</big><a class="headerlink" href="#parmed.amber.FortranFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Processes Fortran format strings according to the Fortran specification for
such formats. This object handles reading and writing data with any valid
Fortran format. It does this by using the <cite>fortranformat</cite> project
[<a class="reference external" href="https://bitbucket.org/brendanarnold/py-fortranformat">https://bitbucket.org/brendanarnold/py-fortranformat</a>].</p>
<p>However, while <cite>fortranformat</cite> is very general and adheres well to the
standard, it is very slow. As a result, simple, common format strings have
been optimized and processes reads and writes between 3 and 5 times faster.
The format strings (case-insensitive) of the following form (where # can be
replaced by any number) are optimized:</p>
<blockquote>
<div><ul class="simple">
<li>#E#.#</li>
<li>#D#.#</li>
<li>#F#.#</li>
<li>#(F#.#)</li>
<li>#a#</li>
<li>#I#</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>format_string</strong> : str</p>
<blockquote>
<div><p>The Fortran Format string to process</p>
</div></blockquote>
<p><strong>strip_strings</strong> : bool=True</p>
<blockquote class="last">
<div><p>If True, strings are stripped before being processed by stripping
(only) trailing whitespace</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.FortranFormat.read" title="parmed.amber.FortranFormat.read"><tt class="xref py py-obj docutils literal"><span class="pre">read</span></tt></a>(line)</td>
<td>Reads the line and returns the converted data</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.FortranFormat.write" title="parmed.amber.FortranFormat.write"><tt class="xref py py-obj docutils literal"><span class="pre">write</span></tt></a>(items,&nbsp;dest)</td>
<td>Writes an iterable of data (or a single item) to the passed file-like</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.FortranFormat.floatre">
<tt class="descname">floatre</tt><em class="property"> = &lt;_sre.SRE_Pattern object at 0x1062ef840&gt;</em><a class="headerlink" href="#parmed.amber.FortranFormat.floatre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.FortranFormat.floatre2">
<tt class="descname">floatre2</tt><em class="property"> = &lt;_sre.SRE_Pattern object at 0x106329738&gt;</em><a class="headerlink" href="#parmed.amber.FortranFormat.floatre2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.FortranFormat.intre">
<tt class="descname">intre</tt><em class="property"> = &lt;_sre.SRE_Pattern object at 0x10630ea80&gt;</em><a class="headerlink" href="#parmed.amber.FortranFormat.intre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.FortranFormat.read">
<tt class="descname">read</tt><big>(</big><em>line</em><big>)</big><a class="headerlink" href="#parmed.amber.FortranFormat.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the line and returns the converted data</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.FortranFormat.strre">
<tt class="descname">strre</tt><em class="property"> = &lt;_sre.SRE_Pattern object at 0x10630e978&gt;</em><a class="headerlink" href="#parmed.amber.FortranFormat.strre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.FortranFormat.write">
<tt class="descname">write</tt><big>(</big><em>items</em>, <em>dest</em><big>)</big><a class="headerlink" href="#parmed.amber.FortranFormat.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes an iterable of data (or a single item) to the passed file-like
object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>items</strong> : iterable or single float/str/int</p>
<blockquote>
<div><p>These are the objects to write in this format. The types of each
item should match the type specified in this Format for that
argument</p>
</div></blockquote>
<p><strong>dest</strong> : file or file-like</p>
<blockquote class="last">
<div><p>This is the file to write the data to. It must have a <cite>write</cite> method
or an AttributeError will be raised</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method may be replaced with _write_string (for #a#-style formats)
or _write_ffwriter in the class initializer if no optimization is
provided for this format, but the call signatures and behavior are the
same for each of those functions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmberAsciiRestart">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberAsciiRestart</tt><big>(</big><em>fname</em>, <em>mode='r'</em>, <em>natom=0</em>, <em>hasbox=None</em>, <em>title=None</em>, <em>time=0.0</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberAsciiRestart" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">parmed.amber.asciicrd._AmberAsciiCoordinateFile</span></tt></p>
<p>Parser for the Amber ASCII inpcrd/restart file format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote class="last">
<div><blockquote>
<div><p>File name to open</p>
</div></blockquote>
<dl class="docutils">
<dt>mode <span class="classifier-delimiter">:</span> <span class="classifier">str={&#8216;r&#8217;, &#8216;w&#8217;}</span></dt>
<dd><p class="first last">Whether to open this file for &#8216;r&#8217;eading or &#8216;w&#8217;riting</p>
</dd>
<dt>natom <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of atoms in the system (necessary when mode=&#8217;w&#8217;)</p>
</dd>
<dt>hasbox <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Does the system have PBCs? Necessary when mode=&#8217;w&#8217;</p>
</dd>
<dt>title <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Title to write to a new trajectory (when mode=&#8217;w&#8217;)</p>
</dd>
<dt>time <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The time to write to the restart file in ps. Default is 0.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.box" title="parmed.amber.AmberAsciiRestart.box"><tt class="xref py py-obj docutils literal"><span class="pre">box</span></tt></a></td>
<td>Combined cell lengths and cell angles</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.cell_angles" title="parmed.amber.AmberAsciiRestart.cell_angles"><tt class="xref py py-obj docutils literal"><span class="pre">cell_angles</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.cell_lengths" title="parmed.amber.AmberAsciiRestart.cell_lengths"><tt class="xref py py-obj docutils literal"><span class="pre">cell_lengths</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.coordinates" title="parmed.amber.AmberAsciiRestart.coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">coordinates</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.positions" title="parmed.amber.AmberAsciiRestart.positions"><tt class="xref py py-obj docutils literal"><span class="pre">positions</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.velocities" title="parmed.amber.AmberAsciiRestart.velocities"><tt class="xref py py-obj docutils literal"><span class="pre">velocities</span></tt></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.close" title="parmed.amber.AmberAsciiRestart.close"><tt class="xref py py-obj docutils literal"><span class="pre">close</span></tt></a>()</td>
<td>Close the open file handler</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberAsciiRestart.id_format" title="parmed.amber.AmberAsciiRestart.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as an Amber restart/inpcrd file</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.CRDS_PER_LINE">
<tt class="descname">CRDS_PER_LINE</tt><em class="property"> = 6</em><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.CRDS_PER_LINE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.DEFAULT_TITLE">
<tt class="descname">DEFAULT_TITLE</tt><em class="property"> = 'restart created by ParmEd'</em><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.DEFAULT_TITLE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.box" title="Permalink to this definition">¶</a></dt>
<dd><p>Combined cell lengths and cell angles</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.cell_angles">
<tt class="descname">cell_angles</tt><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.cell_angles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.cell_lengths">
<tt class="descname">cell_lengths</tt><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.cell_lengths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberAsciiRestart.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the open file handler</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberAsciiRestart.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as an Amber restart/inpcrd file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber restart/inpcrd file. False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.positions">
<tt class="descname">positions</tt><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.positions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberAsciiRestart.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.AmberAsciiRestart.velocities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmberMdcrd">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberMdcrd</tt><big>(</big><em>fname</em>, <em>natom</em>, <em>hasbox</em>, <em>mode='r'</em>, <em>title=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMdcrd" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">parmed.amber.asciicrd._AmberAsciiCoordinateFile</span></tt></p>
<p>A class to parse Amber ASCII trajectory files. This is <em>much</em> slower than
parsing NetCDF files (or the equivalent parsing done in a compiled language
like C or C++). For large trajectories, this may be significant.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.box" title="parmed.amber.AmberMdcrd.box"><tt class="xref py py-obj docutils literal"><span class="pre">box</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.coordinates" title="parmed.amber.AmberMdcrd.coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">coordinates</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.frame" title="parmed.amber.AmberMdcrd.frame"><tt class="xref py py-obj docutils literal"><span class="pre">frame</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.positions" title="parmed.amber.AmberMdcrd.positions"><tt class="xref py py-obj docutils literal"><span class="pre">positions</span></tt></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.add_box" title="parmed.amber.AmberMdcrd.add_box"><tt class="xref py py-obj docutils literal"><span class="pre">add_box</span></tt></a>(stuff)</td>
<td>Prints &#8216;stuff&#8217; (which must be a 3-element list, array.array, tuple, or</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.add_coordinates" title="parmed.amber.AmberMdcrd.add_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">add_coordinates</span></tt></a>(stuff)</td>
<td>Prints &#8216;stuff&#8217; (which must be either an iterable of 3*natom or have an attribute &#8216;flatten&#8217; that converts it into an iterable of 3*natom) to the open file handler.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.close" title="parmed.amber.AmberMdcrd.close"><tt class="xref py py-obj docutils literal"><span class="pre">close</span></tt></a>()</td>
<td>Close the open file handler</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberMdcrd.id_format" title="parmed.amber.AmberMdcrd.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as an Amber mdcrd file</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.CRDS_PER_LINE">
<tt class="descname">CRDS_PER_LINE</tt><em class="property"> = 10</em><a class="headerlink" href="#parmed.amber.AmberMdcrd.CRDS_PER_LINE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.DEFAULT_TITLE">
<tt class="descname">DEFAULT_TITLE</tt><em class="property"> = 'trajectory created by ParmEd'</em><a class="headerlink" href="#parmed.amber.AmberMdcrd.DEFAULT_TITLE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberMdcrd.add_box">
<tt class="descname">add_box</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMdcrd.add_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints &#8216;stuff&#8217; (which must be a 3-element list, array.array, tuple, or
np.ndarray) as the box lengths for this frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : array or iterable</p>
<blockquote>
<div><p>This must be an iterable of length 3 with the box lengths</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>If the coordinate file is an old one being parsed or if you are</strong></p>
<p><strong>currently expected to provide coordinates, a RuntimeError is raised.</strong></p>
<p><strong>raised. If the provided box lengths are not length 3, a ValueError is</strong></p>
<p class="last"><strong>raised.</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberMdcrd.add_coordinates">
<tt class="descname">add_coordinates</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMdcrd.add_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints &#8216;stuff&#8217; (which must be either an iterable of 3*natom or have an
attribute &#8216;flatten&#8217; that converts it into an iterable of 3*natom) to the
open file handler. Can only be called on a &#8216;new&#8217; mdcrd, and adds these
coordinates to the current end of the file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : array or iterable</p>
<blockquote>
<div><p>This must be an iterable of length 3*natom or a numpy array that can
be flattened to a 3*natom-length array</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>If the coordinate file is an old one being parsed or if you are</strong></p>
<p><strong>currently expected to provide unit cell dimensions, a RuntimeError is</strong></p>
<p><strong>raised. If the provided coordinate data does not have length 3*natom, or</strong></p>
<p><strong>cannot be ``flatten()``ed to create a 3*natom array, a ValueError is</strong></p>
<p class="last"><strong>raised.</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.AmberMdcrd.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberMdcrd.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberMdcrd.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the open file handler</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.AmberMdcrd.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.extra_args">
<tt class="descname">extra_args</tt><em class="property"> = ('natom', 'hasbox')</em><a class="headerlink" href="#parmed.amber.AmberMdcrd.extra_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.frame">
<tt class="descname">frame</tt><a class="headerlink" href="#parmed.amber.AmberMdcrd.frame" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberMdcrd.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMdcrd.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as an Amber mdcrd file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber mdcrd file. False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberMdcrd.positions">
<tt class="descname">positions</tt><a class="headerlink" href="#parmed.amber.AmberMdcrd.positions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmberMask">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberMask</tt><big>(</big><em>parm</em>, <em>mask</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>What is hopefully a fully-fledged Amber mask parser implemented in Python.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>parm</strong> : Structure</p>
<blockquote>
<div><p>The topology structure for which to select atoms</p>
</div></blockquote>
<p><strong>mask</strong> : str</p>
<blockquote class="last">
<div><p>The mask string that selects a subset of atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberMask.Selected" title="parmed.amber.AmberMask.Selected"><tt class="xref py py-obj docutils literal"><span class="pre">Selected</span></tt></a>([invert])</td>
<td>Generator that returns the indexes of selected atoms</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberMask.Selection" title="parmed.amber.AmberMask.Selection"><tt class="xref py py-obj docutils literal"><span class="pre">Selection</span></tt></a>([prnlev,&nbsp;invert])</td>
<td>Parses the mask and analyzes the result to return an atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="parmed.amber.AmberMask.Selected">
<tt class="descname">Selected</tt><big>(</big><em>invert=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMask.Selected" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator that returns the indexes of selected atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>invert</strong> : bool, optional</p>
<blockquote>
<div><p>If True, all atoms <em>not</em> selected by the mask will be returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">generator of int</p>
<blockquote class="last">
<div><p>Each iteration will yield the index of the next atom that has been
selected by the mask. Atom indices are 0-based</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberMask.Selection">
<tt class="descname">Selection</tt><big>(</big><em>prnlev=0</em>, <em>invert=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberMask.Selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the mask and analyzes the result to return an atom
selection array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prnlev</strong> : int, optional</p>
<blockquote>
<div><p>Print debug information on the processing of the Amber mask string.
This is mainly useful if you are modifying the mask parser. Default
value is 0 (no printout), values between 1 and 8 control the level
of output (larger values produce more output). Default 0</p>
</div></blockquote>
<p><strong>invert</strong> : bool, optional</p>
<blockquote>
<div><p>If True, the returned array will invert the selection of the mask
(i.e., selected atoms will not be selected and vice-versa)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mask</strong> : list of int</p>
<blockquote class="last">
<div><p>A list with length equal to the number of atoms in the assigned
<a class="reference internal" href="parmed.structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></a> instance. Selected
atoms will have a value of 1 placed in the corresponding slot in the
return list while atoms not selected will be assigned 0.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="parmed.amber.use">
<tt class="descclassname">parmed.amber.</tt><tt class="descname">use</tt><big>(</big><em>package=None</em><big>)</big><a class="headerlink" href="#parmed.amber.use" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects the NetCDF package to use</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>package</strong> : str</p>
<blockquote class="last">
<div><p>This specifies which package to use, and may be either scipy, netCDF4,
Scientific/ScientificPython, or None.  If None, it chooses the
first available implementation from the above list (in that order).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The &#8216;netcdffiles&#8217; module calls this function to get the default NetCDF
implementation if none has been selected before, so calling this function is
unnecessary if the default implementation is sufficient. This is mostly
useful for development testing as the backend NetCDF choice is virtually
invisible to the user.</p>
<p>The NetCDF files have been tested against netCDF v. 1.0.4, Scientific
v. 2.9.1, and scipy v. 0.13.1. Later versions are expected to work barring
backwards-incompatible changes. Other versions are expected to work barring
bugs or backwards-incompatible changes in the current or earlier versions.</p>
</dd></dl>

<dl class="class">
<dt id="parmed.amber.NetCDFTraj">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">NetCDFTraj</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Class to read or write NetCDF restart files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>Name of the file to open</p>
</div></blockquote>
<p><strong>mode</strong> : str</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>Mode to open in:</dt>
<dd><ul class="first last simple">
<li>&#8216;w&#8217; means write-mode</li>
<li>&#8216;r&#8217; means read-mode</li>
</ul>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>You should use the open_new and open_old alternative constructors instead of
the default constructor</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.box" title="parmed.amber.NetCDFTraj.box"><tt class="xref py py-obj docutils literal"><span class="pre">box</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.cell_lengths_angles" title="parmed.amber.NetCDFTraj.cell_lengths_angles"><tt class="xref py py-obj docutils literal"><span class="pre">cell_lengths_angles</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.coordinates" title="parmed.amber.NetCDFTraj.coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">coordinates</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.forces" title="parmed.amber.NetCDFTraj.forces"><tt class="xref py py-obj docutils literal"><span class="pre">forces</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.remd_dimtype" title="parmed.amber.NetCDFTraj.remd_dimtype"><tt class="xref py py-obj docutils literal"><span class="pre">remd_dimtype</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.remd_indices" title="parmed.amber.NetCDFTraj.remd_indices"><tt class="xref py py-obj docutils literal"><span class="pre">remd_indices</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.temp0" title="parmed.amber.NetCDFTraj.temp0"><tt class="xref py py-obj docutils literal"><span class="pre">temp0</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.time" title="parmed.amber.NetCDFTraj.time"><tt class="xref py py-obj docutils literal"><span class="pre">time</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.velocities" title="parmed.amber.NetCDFTraj.velocities"><tt class="xref py py-obj docutils literal"><span class="pre">velocities</span></tt></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_box" title="parmed.amber.NetCDFTraj.add_box"><tt class="xref py py-obj docutils literal"><span class="pre">add_box</span></tt></a>(lengths[,&nbsp;angles])</td>
<td>Adds a new cell length and angle frame to the end of a NetCDF trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_cell_lengths_angles" title="parmed.amber.NetCDFTraj.add_cell_lengths_angles"><tt class="xref py py-obj docutils literal"><span class="pre">add_cell_lengths_angles</span></tt></a>(lengths[,&nbsp;angles])</td>
<td>Adds a new cell length and angle frame to the end of a NetCDF trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_coordinates" title="parmed.amber.NetCDFTraj.add_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">add_coordinates</span></tt></a>(stuff)</td>
<td>Adds a new coordinate frame to the end of a NetCDF trajectory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_forces" title="parmed.amber.NetCDFTraj.add_forces"><tt class="xref py py-obj docutils literal"><span class="pre">add_forces</span></tt></a>(stuff)</td>
<td>Adds a new coordinate frame to the end of a NetCDF trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_remd_indices" title="parmed.amber.NetCDFTraj.add_remd_indices"><tt class="xref py py-obj docutils literal"><span class="pre">add_remd_indices</span></tt></a>(stuff)</td>
<td>Add REMD indices to the current frame of the NetCDF file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_temp0" title="parmed.amber.NetCDFTraj.add_temp0"><tt class="xref py py-obj docutils literal"><span class="pre">add_temp0</span></tt></a>(stuff)</td>
<td>The temperature to add to the current frame of the NetCDF file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_time" title="parmed.amber.NetCDFTraj.add_time"><tt class="xref py py-obj docutils literal"><span class="pre">add_time</span></tt></a>(stuff)</td>
<td>Adds the time to the current frame of the NetCDF file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.add_velocities" title="parmed.amber.NetCDFTraj.add_velocities"><tt class="xref py py-obj docutils literal"><span class="pre">add_velocities</span></tt></a>(stuff)</td>
<td>Adds a new velocities frame to the end of a NetCDF trajectory.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.close" title="parmed.amber.NetCDFTraj.close"><tt class="xref py py-obj docutils literal"><span class="pre">close</span></tt></a>()</td>
<td>Closes the NetCDF file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.flush" title="parmed.amber.NetCDFTraj.flush"><tt class="xref py py-obj docutils literal"><span class="pre">flush</span></tt></a>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.id_format" title="parmed.amber.NetCDFTraj.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as an Amber NetCDF trajectory file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.open_new" title="parmed.amber.NetCDFTraj.open_new"><tt class="xref py py-obj docutils literal"><span class="pre">open_new</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Opens a new NetCDF file and sets the attributes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFTraj.open_old" title="parmed.amber.NetCDFTraj.open_old"><tt class="xref py py-obj docutils literal"><span class="pre">open_old</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Opens the NetCDF file and sets the global attributes that the file sets</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_box">
<tt class="descname">add_box</tt><big>(</big><em>lengths</em>, <em>angles=None</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new cell length and angle frame to the end of a NetCDF
trajectory.  This should only be called on objects created with the
&#8220;open_new&#8221; constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lengths</strong> : array of 3 (or 6) floats (or Quantities)</p>
<blockquote>
<div><p>This should be a 1-D array of 3 or 6 elements.  If 6 elements,
<cite>angles</cite> should be None (below) and the first 3 elements are the box
lengths (angstroms) and the last 3 are the box angles (degrees).</p>
</div></blockquote>
<p><strong>angles</strong> : 3-item iterable = None</p>
<blockquote class="last">
<div><p>These are the box angles (if lengths contains only 3 elements) in
degrees. Must be a 1-D array of 3 elements or None if lengths
includes angles as well.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_cell_lengths_angles">
<tt class="descname">add_cell_lengths_angles</tt><big>(</big><em>lengths</em>, <em>angles=None</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_cell_lengths_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new cell length and angle frame to the end of a NetCDF
trajectory.  This should only be called on objects created with the
&#8220;open_new&#8221; constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lengths</strong> : array of 3 (or 6) floats (or Quantities)</p>
<blockquote>
<div><p>This should be a 1-D array of 3 or 6 elements.  If 6 elements,
<cite>angles</cite> should be None (below) and the first 3 elements are the box
lengths (angstroms) and the last 3 are the box angles (degrees).</p>
</div></blockquote>
<p><strong>angles</strong> : 3-item iterable = None</p>
<blockquote class="last">
<div><p>These are the box angles (if lengths contains only 3 elements) in
degrees. Must be a 1-D array of 3 elements or None if lengths
includes angles as well.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_coordinates">
<tt class="descname">add_coordinates</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new coordinate frame to the end of a NetCDF trajectory. This
should only be called on objects created with the &#8220;open_new&#8221;
constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : iterable of floats or distance Quantity</p>
<blockquote class="last">
<div><p>This array of floats is converted into a numpy array of shape
(natom, 3). It can be passed either in the 2-D format of
[ [x1, y1, z1], [x2, y2, z2], ... ] or in the 1-D format of
[x1, y1, z1, x2, y2, z2, ... ].</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_forces">
<tt class="descname">add_forces</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new coordinate frame to the end of a NetCDF trajectory. This
should only be called on objects created with the &#8220;open_new&#8221;
constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : iterable of floats or energy/distance Quantity</p>
<blockquote class="last">
<div><p>This array of floats is converted into a numpy array of shape
(natom, 3). It can be passed either in the 2-D format of
[ [x1, y1, z1], [x2, y2, z2], ... ] or in the 1-D format of
[x1, y1, z1, x2, y2, z2, ... ].</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_remd_indices">
<tt class="descname">add_remd_indices</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_remd_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Add REMD indices to the current frame of the NetCDF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : iterable of int</p>
<blockquote class="last">
<div><p>The indices in each REMD dimension</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_temp0">
<tt class="descname">add_temp0</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_temp0" title="Permalink to this definition">¶</a></dt>
<dd><p>The temperature to add to the current frame of the NetCDF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : float or temperature Quantity</p>
<blockquote class="last">
<div><p>The temperature to add to the current NetCDF file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_time">
<tt class="descname">add_time</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the time to the current frame of the NetCDF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : float or time-dimension Quantity</p>
<blockquote class="last">
<div><p>The time to add to the current frame</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.add_velocities">
<tt class="descname">add_velocities</tt><big>(</big><em>stuff</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.add_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new velocities frame to the end of a NetCDF trajectory. This
should only be called on objects created with the &#8220;open_new&#8221;
constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stuff</strong> : iterable of floats or distance/time Quantity</p>
<blockquote class="last">
<div><p>This array of floats is converted into a numpy array of shape
(natom, 3). It can be passed either in the 2-D format of
[ [x1, y1, z1], [x2, y2, z2], ... ] or in the 1-D format of
[x1, y1, z1, x2, y2, z2, ... ].</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.cell_lengths_angles">
<tt class="descname">cell_lengths_angles</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.cell_lengths_angles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the NetCDF file</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFTraj.flush">
<tt class="descname">flush</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.flush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.forces">
<tt class="descname">forces</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.forces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.NetCDFTraj.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as an Amber NetCDF trajectory file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber NetCDF trajectory file. False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Remote NetCDF files cannot be loaded</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.NetCDFTraj.open_new">
<em class="property">classmethod </em><tt class="descname">open_new</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.open_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a new NetCDF file and sets the attributes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>Name of the new file to open (overwritten)</p>
</div></blockquote>
<p><strong>natom</strong> : int</p>
<blockquote>
<div><p>Number of atoms in the restart</p>
</div></blockquote>
<p><strong>box</strong> : bool</p>
<blockquote>
<div><p>Indicates if cell lengths and angles are written to the NetCDF file</p>
</div></blockquote>
<p><strong>crds</strong> : bool=True</p>
<blockquote>
<div><p>Indicates if coordinates are written to the NetCDF file</p>
</div></blockquote>
<p><strong>vels</strong> : bool=False</p>
<blockquote>
<div><p>Indicates if velocities are written to the NetCDF file</p>
</div></blockquote>
<p><strong>frcs</strong> : bool=False</p>
<blockquote>
<div><p>Indicates if forces are written to the NetCDF file</p>
</div></blockquote>
<p><strong>remd</strong> : str=None</p>
<blockquote>
<div><p>&#8216;T[emperature]&#8217; if replica temperature is written
&#8216;M[ulti]&#8217; if Multi-D REMD information is written
None if no REMD information is written</p>
</div></blockquote>
<p><strong>remd_dimension</strong> : int=None</p>
<blockquote>
<div><p>If remd above is &#8216;M[ulti]&#8217;, this is how many REMD dimensions exist</p>
</div></blockquote>
<p><strong>title</strong> : str=&#8217;&#8216;</p>
<blockquote class="last">
<div><p>The title of the NetCDF trajectory file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.NetCDFTraj.open_old">
<em class="property">classmethod </em><tt class="descname">open_old</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFTraj.open_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens the NetCDF file and sets the global attributes that the file sets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote class="last">
<div><p>File name of the trajectory to open. It must exist</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.remd_dimtype">
<tt class="descname">remd_dimtype</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.remd_dimtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.remd_indices">
<tt class="descname">remd_indices</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.remd_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.temp0">
<tt class="descname">temp0</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.temp0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.time">
<tt class="descname">time</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFTraj.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.NetCDFTraj.velocities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.NetCDFRestart">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">NetCDFRestart</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Class to read or write NetCDF restart files</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.box" title="parmed.amber.NetCDFRestart.box"><tt class="xref py py-obj docutils literal"><span class="pre">box</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.cell_angles" title="parmed.amber.NetCDFRestart.cell_angles"><tt class="xref py py-obj docutils literal"><span class="pre">cell_angles</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.cell_lengths" title="parmed.amber.NetCDFRestart.cell_lengths"><tt class="xref py py-obj docutils literal"><span class="pre">cell_lengths</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.coordinates" title="parmed.amber.NetCDFRestart.coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">coordinates</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.remd_dimtype" title="parmed.amber.NetCDFRestart.remd_dimtype"><tt class="xref py py-obj docutils literal"><span class="pre">remd_dimtype</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.remd_groups" title="parmed.amber.NetCDFRestart.remd_groups"><tt class="xref py py-obj docutils literal"><span class="pre">remd_groups</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.remd_indices" title="parmed.amber.NetCDFRestart.remd_indices"><tt class="xref py py-obj docutils literal"><span class="pre">remd_indices</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.temp0" title="parmed.amber.NetCDFRestart.temp0"><tt class="xref py py-obj docutils literal"><span class="pre">temp0</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.time" title="parmed.amber.NetCDFRestart.time"><tt class="xref py py-obj docutils literal"><span class="pre">time</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.velocities" title="parmed.amber.NetCDFRestart.velocities"><tt class="xref py py-obj docutils literal"><span class="pre">velocities</span></tt></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.close" title="parmed.amber.NetCDFRestart.close"><tt class="xref py py-obj docutils literal"><span class="pre">close</span></tt></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.flush" title="parmed.amber.NetCDFRestart.flush"><tt class="xref py py-obj docutils literal"><span class="pre">flush</span></tt></a>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.id_format" title="parmed.amber.NetCDFRestart.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as an Amber NetCDF restart file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.open_new" title="parmed.amber.NetCDFRestart.open_new"><tt class="xref py py-obj docutils literal"><span class="pre">open_new</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Opens a new NetCDF file and sets the attributes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.open_old" title="parmed.amber.NetCDFRestart.open_old"><tt class="xref py py-obj docutils literal"><span class="pre">open_old</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Opens the NetCDF file and sets the global attributes that the file sets</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.NetCDFRestart.parse" title="parmed.amber.NetCDFRestart.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Opens the NetCDF file and sets the global attributes that the file sets</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.cell_angles">
<tt class="descname">cell_angles</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.cell_angles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.cell_lengths">
<tt class="descname">cell_lengths</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.cell_lengths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFRestart.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.NetCDFRestart.flush">
<tt class="descname">flush</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart.flush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.NetCDFRestart.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as an Amber NetCDF restart file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber NetCDF restart file. False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Remote NetCDF files cannot be loaded</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.NetCDFRestart.open_new">
<em class="property">classmethod </em><tt class="descname">open_new</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart.open_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a new NetCDF file and sets the attributes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>Name of the new file to open (overwritten)</p>
</div></blockquote>
<p><strong>natom</strong> : int</p>
<blockquote>
<div><p>The number of atoms in the system</p>
</div></blockquote>
<p><strong>box</strong> : bool</p>
<blockquote>
<div><p>Whether unit cell information is written or not</p>
</div></blockquote>
<p><strong>vels</strong> : bool</p>
<blockquote>
<div><p>Whether velocity information is written or not</p>
</div></blockquote>
<p><strong>title</strong> : str=&#8217;&#8216;</p>
<blockquote>
<div><p>The title to write to the NetCDF restart file</p>
</div></blockquote>
<p><strong>remd</strong> : str=None</p>
<blockquote>
<div><p>None &#8211; No REMD information is written
&#8216;T[emperature]&#8217; &#8211; target temperature (or pH) will be written
&#8216;M[ulti-D]&#8217; &#8211; remd_indices and remd_groups will be written</p>
</div></blockquote>
<p><strong>remd_dimtypes</strong> : iterable of int=None</p>
<blockquote class="last">
<div><p>Array of exchange types for each group. The length will be the REMD
dimension (if <cite>remd</cite> above is &#8220;M[ulti-D]&#8221;)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><cite>remd</cite> is case-insensitive, and done based on first-letter matching</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.NetCDFRestart.open_old">
<em class="property">classmethod </em><tt class="descname">open_old</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart.open_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens the NetCDF file and sets the global attributes that the file sets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote class="last">
<div><p>Name of the file to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.NetCDFRestart.parse">
<em class="property">classmethod </em><tt class="descname">parse</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.NetCDFRestart.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens the NetCDF file and sets the global attributes that the file sets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote class="last">
<div><p>Name of the file to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.remd_dimtype">
<tt class="descname">remd_dimtype</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.remd_dimtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.remd_groups">
<tt class="descname">remd_groups</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.remd_groups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.remd_indices">
<tt class="descname">remd_indices</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.remd_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.temp0">
<tt class="descname">temp0</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.temp0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.time">
<tt class="descname">time</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.NetCDFRestart.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.NetCDFRestart.velocities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmberOFFLibrary">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberOFFLibrary</tt><a class="headerlink" href="#parmed.amber.AmberOFFLibrary" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Class containing static methods responsible for parsing and writing OFF
libraries</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberOFFLibrary.id_format" title="parmed.amber.AmberOFFLibrary.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Sees if an open file is an OFF library file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberOFFLibrary.parse" title="parmed.amber.AmberOFFLibrary.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(filename)</td>
<td>Parses an Amber OFF library</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberOFFLibrary.write" title="parmed.amber.AmberOFFLibrary.write"><tt class="xref py py-obj docutils literal"><span class="pre">write</span></tt></a>(lib,&nbsp;dest)</td>
<td>Writes a dictionary of ResidueTemplate units to a file in OFF format</td>
</tr>
</tbody>
</table>
<dl class="staticmethod">
<dt id="parmed.amber.AmberOFFLibrary.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberOFFLibrary.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Sees if an open file is an OFF library file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>The name of the file to see if it is an OFF file format</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is recognized as OFF, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberOFFLibrary.parse">
<em class="property">static </em><tt class="descname">parse</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberOFFLibrary.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses an Amber OFF library</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str or file-like iterable</p>
<blockquote>
<div><p>The file name or file object to parse. If it is an iterable, it will
be exhausted</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>residues</strong> : OrderedDict {str</p>
<blockquote>
<div><p>Dictionary pairing residue names with their <tt class="xref py py-class docutils literal"><span class="pre">ResidueTemplate</span></tt>
objects</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError if the first line does not match the file format. This line</strong></p>
<p><strong>will be consumed</strong></p>
<p><strong>IOError if filename is the name of a file that does not exist</strong></p>
<p><strong>RuntimeError if EOF is reached prematurely or other formatting issues</strong></p>
<p class="last"><strong>found</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberOFFLibrary.write">
<em class="property">static </em><tt class="descname">write</tt><big>(</big><em>lib</em>, <em>dest</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberOFFLibrary.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a dictionary of ResidueTemplate units to a file in OFF format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lib</strong> : dict {str</p>
<blockquote>
<div><p>Items can be either <tt class="xref py py-class docutils literal"><span class="pre">ResidueTemplate</span></tt> or
<tt class="xref py py-class docutils literal"><span class="pre">ResidueTemplateContainer</span></tt> instances</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote class="last">
<div><p>Either a file name or a file-like object to write the file to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmberParameterSet">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberParameterSet</tt><big>(</big><em>*filenames</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="parmed.parameters.html#parmed.parameters.ParameterSet" title="parmed.parameters.ParameterSet"><tt class="xref py py-class docutils literal"><span class="pre">parmed.parameters.ParameterSet</span></tt></a></p>
<p>Class storing parameters from an Amber parameter set</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : str or list of str</p>
<blockquote class="last">
<div><p>Either the name of a file or a list of filenames from which parameters
should be parsed.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Order is important in the list of files provided. The parameters are loaded
in the order they are provided, and any parameters that are specified in
multiple places are overwritten (that is, the <em>last</em> occurrence is the
parameter type that is used)</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.combining_rule" title="parmed.amber.AmberParameterSet.combining_rule"><tt class="xref py py-obj docutils literal"><span class="pre">combining_rule</span></tt></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.condense" title="parmed.amber.AmberParameterSet.condense"><tt class="xref py py-obj docutils literal"><span class="pre">condense</span></tt></a>([do_dihedrals])</td>
<td>This function goes through each of the parameter type dicts and eliminates duplicate types.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.from_leaprc" title="parmed.amber.AmberParameterSet.from_leaprc"><tt class="xref py py-obj docutils literal"><span class="pre">from_leaprc</span></tt></a>(fname)</td>
<td>Load a parameter set from a leaprc file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.from_structure" title="parmed.amber.AmberParameterSet.from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">from_structure</span></tt></a>(struct)</td>
<td>Extracts known parameters from a Structure instance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.id_format" title="parmed.amber.AmberParameterSet.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as either an Amber-style frcmod or parm.dat file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.load_parameters" title="parmed.amber.AmberParameterSet.load_parameters"><tt class="xref py py-obj docutils literal"><span class="pre">load_parameters</span></tt></a>(fname)</td>
<td>Load a set of parameters from a single parameter file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParameterSet.write" title="parmed.amber.AmberParameterSet.write"><tt class="xref py py-obj docutils literal"><span class="pre">write</span></tt></a>(dest[,&nbsp;title,&nbsp;style])</td>
<td>Writes a parm.dat file with the current parameters</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.AmberParameterSet.combining_rule">
<tt class="descname">combining_rule</tt><a class="headerlink" href="#parmed.amber.AmberParameterSet.combining_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParameterSet.condense">
<tt class="descname">condense</tt><big>(</big><em>do_dihedrals=True</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet.condense" title="Permalink to this definition">¶</a></dt>
<dd><p>This function goes through each of the parameter type dicts and
eliminates duplicate types. After calling this function, every unique
bond, angle, dihedral, improper, or cmap type will pair with EVERY key
in the type mapping dictionaries that points to the equivalent type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>do_dihedrals</strong> : bool=True</p>
<blockquote>
<div><p>Dihedrals can take the longest time to compress since testing their
equality takes the longest (this is complicated by the existence of
multi-term torsions). This flag will allow you to <em>skip</em> condensing
the dihedral parameter types (for large parameter sets, this can cut
the compression time in half)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">self</p>
<blockquote class="last">
<div><p>The instance that is being condensed</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The return value allows you to condense the types at construction time.</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmberParameterSet.from_leaprc">
<em class="property">classmethod </em><tt class="descname">from_leaprc</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet.from_leaprc" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a parameter set from a leaprc file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str or file-like</p>
<blockquote class="last">
<div><p>Name of the file or open file-object from which a leaprc-style file
will be read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This does not read all parts of a leaprc file &#8211; only those pertinent to
defining force field information. For instance, the following sections
and commands are processed:</p>
<ul class="simple">
<li>addAtomTypes</li>
<li>loadAmberParams</li>
<li>loadOFF</li>
</ul>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmberParameterSet.from_structure">
<em class="property">classmethod </em><tt class="descname">from_structure</tt><big>(</big><em>struct</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts known parameters from a Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <a class="reference internal" href="parmed.structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">parmed.structure.Structure</span></tt></a></p>
<blockquote>
<div><p>The parametrized <tt class="docutils literal"><span class="pre">Structure</span></tt> instance from which to extract
parameters into a ParameterSet</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>params</strong> : <tt class="xref py py-class docutils literal"><span class="pre">ParameterSet</span></tt></p>
<blockquote class="last">
<div><p>The parameter set with all parameters defined in the Structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberParameterSet.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as either an Amber-style frcmod or parm.dat
file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber-style parameter file. False otherwise.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParameterSet.load_parameters">
<tt class="descname">load_parameters</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet.load_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a set of parameters from a single parameter file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str or file-like</p>
<blockquote class="last">
<div><p>Parameter file to parse</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParameterSet.write">
<tt class="descname">write</tt><big>(</big><em>dest</em>, <em>title='Created by ParmEd'</em>, <em>style='frcmod'</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParameterSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a parm.dat file with the current parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>The file name or file-like object to write the parameters to</p>
</div></blockquote>
<p><strong>title</strong> : str, optional</p>
<blockquote>
<div><p>The title of the frcmod to write. Default is &#8216;Created by ParmEd&#8217;</p>
</div></blockquote>
<p><strong>style</strong> : str, optional</p>
<blockquote class="last">
<div><p>If &#8216;frcmod&#8217;, the parameters are written in frcmod-format. If &#8216;parm&#8217;,
the parameters are written in parm.dat-format. Default is &#8216;frcmod&#8217;</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmberParm">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmberParm</tt><big>(</big><em>prm_name=None</em>, <em>xyz=None</em>, <em>box=None</em>, <em>rst7_name=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="parmed.amber.amberformat.html#parmed.amber.amberformat.AmberFormat" title="parmed.amber.amberformat.AmberFormat"><tt class="xref py py-class docutils literal"><span class="pre">parmed.amber.amberformat.AmberFormat</span></tt></a>, <a class="reference internal" href="parmed.structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">parmed.structure.Structure</span></tt></a></p>
<p>Amber Topology (parm7 format) class. Gives low, and some high, level access
to topology data. You can interact with the raw data in the topology file
directly or interact with some of the high-level classes comprising the
system topology and parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prm_name</strong> : str, optional</p>
<blockquote>
<div><p>If provided, this file is parsed and the data structures will be loaded
from the data in this file</p>
</div></blockquote>
<p><strong>xyz</strong> : str or array, optional</p>
<blockquote>
<div><p>If provided, the coordinates and unit cell dimensions from the provided
Amber inpcrd/restart file will be loaded into the molecule, or the
coordinates will be loaded from the coordinate array</p>
</div></blockquote>
<p><strong>box</strong> : array, optional</p>
<blockquote class="last">
<div><p>If provided, the unit cell information will be set from the provided
unit cell dimensions (a, b, c, alpha, beta, and gamma, respectively)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.bonds_inc_h" title="parmed.amber.AmberParm.bonds_inc_h"><tt class="xref py py-obj docutils literal"><span class="pre">bonds_inc_h</span></tt></a></td>
<td>All bonds including hydrogen</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.bonds_without_h" title="parmed.amber.AmberParm.bonds_without_h"><tt class="xref py py-obj docutils literal"><span class="pre">bonds_without_h</span></tt></a></td>
<td>All bonds without hydrogen</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.angles_inc_h" title="parmed.amber.AmberParm.angles_inc_h"><tt class="xref py py-obj docutils literal"><span class="pre">angles_inc_h</span></tt></a></td>
<td>All angles including hydrogen</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.angles_without_h" title="parmed.amber.AmberParm.angles_without_h"><tt class="xref py py-obj docutils literal"><span class="pre">angles_without_h</span></tt></a></td>
<td>All angles including hydrogen</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.dihedrals_inc_h" title="parmed.amber.AmberParm.dihedrals_inc_h"><tt class="xref py py-obj docutils literal"><span class="pre">dihedrals_inc_h</span></tt></a></td>
<td>All dihedrals including hydrogen</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.dihedrals_without_h" title="parmed.amber.AmberParm.dihedrals_without_h"><tt class="xref py py-obj docutils literal"><span class="pre">dihedrals_without_h</span></tt></a></td>
<td>All dihedrals including hydrogen</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.chamber" title="parmed.amber.AmberParm.chamber"><tt class="xref py py-obj docutils literal"><span class="pre">chamber</span></tt></a></td>
<td>Whether this instance uses the CHARMM force field</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.amoeba" title="parmed.amber.AmberParm.amoeba"><tt class="xref py py-obj docutils literal"><span class="pre">amoeba</span></tt></a></td>
<td>Whether this instance uses the Amoeba force field</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.has_cmap" title="parmed.amber.AmberParm.has_cmap"><tt class="xref py py-obj docutils literal"><span class="pre">has_cmap</span></tt></a></td>
<td>Whether this instance has correction map terms or not</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>parm_data</td>
<td>(dict {str) A dictionary that maps FLAG names to all of the data contained in that section of the Amber file.</td>
</tr>
<tr class="row-even"><td>formats</td>
<td>(dict {str) A dictionary that maps FLAG names to the FortranFormat instance in which the data is stored in that section</td>
</tr>
<tr class="row-odd"><td>parm_comments</td>
<td>(dict {str) A dictionary that maps FLAG names to the list of COMMENT lines that were stored in the original file</td>
</tr>
<tr class="row-even"><td>flag_list</td>
<td>(list) An ordered list of all FLAG names. This must be kept synchronized with <cite>parm_data</cite>, <cite>formats</cite>, and <cite>parm_comments</cite> such that every item in <cite>flag_list</cite> is a key to those 3 dicts and no other keys exist</td>
</tr>
<tr class="row-odd"><td>charge_flag</td>
<td>(str=&#8217;CHARGE&#8217;) The name of the name of the FLAG that describes partial atomic charge data. If this flag is found, then its data are multiplied by the ELECTROSTATIC_CONSTANT to convert back to fractions of electrons</td>
</tr>
<tr class="row-even"><td>version</td>
<td>(str) The VERSION string from the Amber file</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>(str) The file name of the originally parsed file (set to the fname parameter)</td>
</tr>
<tr class="row-even"><td>LJ_types</td>
<td>(dict {str) A mapping whose keys are atom types paired with the nonbonded index of that type</td>
</tr>
<tr class="row-odd"><td>LJ_radius</td>
<td>(list(float)) A list of floats corresponding to the Rmin/2 parameter for every Lennard-Jones type. The indexes are the nonbonded index (<cite>nb_idx</cite> attribute of the <cite>Atom</cite> class) minus 1 to account for indexing from 0 in Python. The values are in Angstroms. To get the radius for a particular atom type, you can use <cite>LJ_radius[LJ_types[&#8220;type&#8221;]-1]</cite></td>
</tr>
<tr class="row-even"><td>LJ_depth</td>
<td>(list(float)) A list of Lennard-Jones epsilon parameters laid out the same way as LJ_radius, described above.</td>
</tr>
<tr class="row-odd"><td>atoms</td>
<td>(AtomList(Atom)) List of all atoms in the system</td>
</tr>
<tr class="row-even"><td>residues</td>
<td>(ResidueList(Residue)) List of all residues in the system</td>
</tr>
<tr class="row-odd"><td>bonds</td>
<td>(TrackedList(Bond)) List of bonds between two atoms in the system</td>
</tr>
<tr class="row-even"><td>angles</td>
<td>(TrackedList(Angle)) List of angles between three atoms in the system</td>
</tr>
<tr class="row-odd"><td>dihedrals</td>
<td>(TrackedList(Angle)) List of all proper and improper torsions between 4 atoms in the system</td>
</tr>
<tr class="row-even"><td>box</td>
<td>(list of 6 floats) Periodic boundary unit cell dimensions and angles</td>
</tr>
<tr class="row-odd"><td>bond_types</td>
<td>(TrackedList(BondType)) The bond types containing the parameters for each bond stretching term</td>
</tr>
<tr class="row-even"><td>angle_types</td>
<td>(TrackedList(AngleType)) The angle types containing the parameters for each angle bending term</td>
</tr>
<tr class="row-odd"><td>dihedral_types</td>
<td>(TrackedList(DihedralType)) The dihedral types containing the parameters for each torsional term</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.addFlag" title="parmed.amber.AmberParm.addFlag"><tt class="xref py py-obj docutils literal"><span class="pre">addFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.add_atom" title="parmed.amber.AmberParm.add_atom"><tt class="xref py py-obj docutils literal"><span class="pre">add_atom</span></tt></a>(atom,&nbsp;resname,&nbsp;resnum[,&nbsp;chain,&nbsp;...])</td>
<td>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if it has a different name or number as the last residue added and adding it to the <cite>atoms</cite> list.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.add_atom_to_residue" title="parmed.amber.AmberParm.add_atom_to_residue"><tt class="xref py py-obj docutils literal"><span class="pre">add_atom_to_residue</span></tt></a>(atom,&nbsp;residue)</td>
<td>Adds a new atom to the Structure at the end if the given residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.add_flag" title="parmed.amber.AmberParm.add_flag"><tt class="xref py py-obj docutils literal"><span class="pre">add_flag</span></tt></a>(flag_name,&nbsp;flag_format[,&nbsp;data,&nbsp;...])</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.copy" title="parmed.amber.AmberParm.copy"><tt class="xref py py-obj docutils literal"><span class="pre">copy</span></tt></a>(cls[,&nbsp;split_dihedrals])</td>
<td>Makes a copy of the current structure as an instance of a specified</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.createSystem" title="parmed.amber.AmberParm.createSystem"><tt class="xref py py-obj docutils literal"><span class="pre">createSystem</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Construct an OpenMM System representing the topology described by the prmtop file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.deleteFlag" title="parmed.amber.AmberParm.deleteFlag"><tt class="xref py py-obj docutils literal"><span class="pre">deleteFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.delete_flag" title="parmed.amber.AmberParm.delete_flag"><tt class="xref py py-obj docutils literal"><span class="pre">delete_flag</span></tt></a>(flag_name)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.fill_LJ" title="parmed.amber.AmberParm.fill_LJ"><tt class="xref py py-obj docutils literal"><span class="pre">fill_LJ</span></tt></a>()</td>
<td>Calculates the Lennard-Jones parameters (Rmin/2 and epsilon) for each atom type by computing their values from the A and B coefficients of each atom interacting with itself.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.from_rawdata" title="parmed.amber.AmberParm.from_rawdata"><tt class="xref py py-obj docutils literal"><span class="pre">from_rawdata</span></tt></a>(rawdata)</td>
<td>Take the raw data from a AmberFormat object and initialize an AmberParm from that data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.from_structure" title="parmed.amber.AmberParm.from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">from_structure</span></tt></a>(struct[,&nbsp;copy])</td>
<td>Take a Structure instance and initialize an AmberParm instance from that data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.get_coordinates" title="parmed.amber.AmberParm.get_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">get_coordinates</span></tt></a>([frame])</td>
<td>In some cases, multiple conformations may be stored in the Structure.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.has_1012" title="parmed.amber.AmberParm.has_1012"><tt class="xref py py-obj docutils literal"><span class="pre">has_1012</span></tt></a>()</td>
<td>This routine determines whether there are any defined 10-12</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.has_NBFIX" title="parmed.amber.AmberParm.has_NBFIX"><tt class="xref py py-obj docutils literal"><span class="pre">has_NBFIX</span></tt></a>()</td>
<td>This routine determines whether there are any off-diagonal Lennard-Jones modifications (i.e., if any two atoms have a L-J pair interaction that does not match the combined L-J parameters for that pair).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.id_format" title="parmed.amber.AmberParm.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as either Amber-format file (like prmtop) or an old-style topology file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.initialize_topology" title="parmed.amber.AmberParm.initialize_topology"><tt class="xref py py-obj docutils literal"><span class="pre">initialize_topology</span></tt></a>([xyz,&nbsp;box])</td>
<td>Initializes topology data structures, like the list of atoms, bonds, etc., after the topology file has been read.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.is_changed" title="parmed.amber.AmberParm.is_changed"><tt class="xref py py-obj docutils literal"><span class="pre">is_changed</span></tt></a>()</td>
<td>Determines if any of the topological arrays have changed since the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_atom_info" title="parmed.amber.AmberParm.load_atom_info"><tt class="xref py py-obj docutils literal"><span class="pre">load_atom_info</span></tt></a>()</td>
<td>Loads atom properties into the atoms that have been loaded.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_coordinates" title="parmed.amber.AmberParm.load_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">load_coordinates</span></tt></a>(coords)</td>
<td>Loads the coordinates into the atom list</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_dataframe" title="parmed.amber.AmberParm.load_dataframe"><tt class="xref py py-obj docutils literal"><span class="pre">load_dataframe</span></tt></a>(df)</td>
<td>Loads atomic properties from an input DataFrame</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_from_rawdata" title="parmed.amber.AmberParm.load_from_rawdata"><tt class="xref py py-obj docutils literal"><span class="pre">load_from_rawdata</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_from_structure" title="parmed.amber.AmberParm.load_from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">load_from_structure</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_pointers" title="parmed.amber.AmberParm.load_pointers"><tt class="xref py py-obj docutils literal"><span class="pre">load_pointers</span></tt></a>()</td>
<td>Loads the data in POINTERS section into a pointers dictionary with each</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_rst7" title="parmed.amber.AmberParm.load_rst7"><tt class="xref py py-obj docutils literal"><span class="pre">load_rst7</span></tt></a>(rst7)</td>
<td>Loads coordinates into the AmberParm class</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_structure" title="parmed.amber.AmberParm.load_structure"><tt class="xref py py-obj docutils literal"><span class="pre">load_structure</span></tt></a>()</td>
<td>Loads all of the topology instance variables.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.load_velocities" title="parmed.amber.AmberParm.load_velocities"><tt class="xref py py-obj docutils literal"><span class="pre">load_velocities</span></tt></a>(vels)</td>
<td>Loads the coordinates into the atom list</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_add_constraints" title="parmed.amber.AmberParm.omm_add_constraints"><tt class="xref py py-obj docutils literal"><span class="pre">omm_add_constraints</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds constraints to a given system</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_angle_force" title="parmed.amber.AmberParm.omm_angle_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_angle_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_bond_force" title="parmed.amber.AmberParm.omm_bond_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_bond_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_cmap_force" title="parmed.amber.AmberParm.omm_cmap_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_cmap_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM CMAP torsion force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_dihedral_force" title="parmed.amber.AmberParm.omm_dihedral_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_dihedral_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_gbsa_force" title="parmed.amber.AmberParm.omm_gbsa_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_gbsa_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates a Generalized Born force for running implicit solvent</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_improper_force" title="parmed.amber.AmberParm.omm_improper_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_improper_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM improper torsion force (quadratic bias)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_nonbonded_force" title="parmed.amber.AmberParm.omm_nonbonded_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_nonbonded_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM NonbondedForce (and CustomNonbondedForce if necessary) to define the nonbonded interatomic potential for this system.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_out_of_plane_bend_force" title="parmed.amber.AmberParm.omm_out_of_plane_bend_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_out_of_plane_bend_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba out-of-plane bend force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_pi_torsion_force" title="parmed.amber.AmberParm.omm_pi_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_pi_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba pi-torsion force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_rb_torsion_force" title="parmed.amber.AmberParm.omm_rb_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_rb_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_set_virtual_sites" title="parmed.amber.AmberParm.omm_set_virtual_sites"><tt class="xref py py-obj docutils literal"><span class="pre">omm_set_virtual_sites</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_stretch_bend_force" title="parmed.amber.AmberParm.omm_stretch_bend_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_stretch_bend_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Create the OpenMM Amoeba stretch-bend force for this system</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_torsion_torsion_force" title="parmed.amber.AmberParm.omm_torsion_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_torsion_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Create the OpenMM Amoeba coupled-torsion (CMAP) force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_trigonal_angle_force" title="parmed.amber.AmberParm.omm_trigonal_angle_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_trigonal_angle_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba trigonal-angle force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.omm_urey_bradley_force" title="parmed.amber.AmberParm.omm_urey_bradley_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_urey_bradley_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM Urey-Bradley force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.parse" title="parmed.amber.AmberParm.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(filename,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Meant for use with the automatic file loader, this will automatically</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.prune_empty_terms" title="parmed.amber.AmberParm.prune_empty_terms"><tt class="xref py py-obj docutils literal"><span class="pre">prune_empty_terms</span></tt></a>()</td>
<td>Looks through all of the topological lists and gets rid of terms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.ptr" title="parmed.amber.AmberParm.ptr"><tt class="xref py py-obj docutils literal"><span class="pre">ptr</span></tt></a>(pointer)</td>
<td>Returns the value of the given pointer, and converts to upper-case so it&#8217;s case-insensitive.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.rdparm" title="parmed.amber.AmberParm.rdparm"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm</span></tt></a>(fname[,&nbsp;slow])</td>
<td>Parses the Amber format file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.rdparm_old" title="parmed.amber.AmberParm.rdparm_old"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_old</span></tt></a>(prmtop_lines[,&nbsp;check])</td>
<td>This reads an old-style topology file and stores the results in the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.rdparm_slow" title="parmed.amber.AmberParm.rdparm_slow"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_slow</span></tt></a>(fname)</td>
<td>Parses the Amber format file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.recalculate_LJ" title="parmed.amber.AmberParm.recalculate_LJ"><tt class="xref py py-obj docutils literal"><span class="pre">recalculate_LJ</span></tt></a>()</td>
<td>Fills the <tt class="docutils literal"><span class="pre">LENNARD_JONES_ACOEF</span></tt> and <tt class="docutils literal"><span class="pre">LENNARD_JONES_BCOEF</span></tt> arrays in the <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> raw data dictionary by applying the canonical Lorentz-Berthelot combining rules to the values in <tt class="xref py py-attr docutils literal"><span class="pre">LJ_radius</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">LJ_depth</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.rediscover_molecules" title="parmed.amber.AmberParm.rediscover_molecules"><tt class="xref py py-obj docutils literal"><span class="pre">rediscover_molecules</span></tt></a>([solute_ions,&nbsp;fix_broken])</td>
<td>This determines the molecularity and sets the ATOMS_PER_MOLECULE and SOLVENT_POINTERS sections of the prmtops.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.remake_parm" title="parmed.amber.AmberParm.remake_parm"><tt class="xref py py-obj docutils literal"><span class="pre">remake_parm</span></tt></a>()</td>
<td>Fills <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> from the data in the parameter and topology</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.save" title="parmed.amber.AmberParm.save"><tt class="xref py py-obj docutils literal"><span class="pre">save</span></tt></a>(fname[,&nbsp;format,&nbsp;overwrite])</td>
<td>Saves the current Structure in the requested file format.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.set_version" title="parmed.amber.AmberParm.set_version"><tt class="xref py py-obj docutils literal"><span class="pre">set_version</span></tt></a>()</td>
<td>Sets the version string</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.split" title="parmed.amber.AmberParm.split"><tt class="xref py py-obj docutils literal"><span class="pre">split</span></tt></a>()</td>
<td>Split the current Structure into separate Structure instances for each unique molecule.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.strip" title="parmed.amber.AmberParm.strip"><tt class="xref py py-obj docutils literal"><span class="pre">strip</span></tt></a>(selection)</td>
<td>Deletes a subset of the atoms corresponding to an atom-based selection.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.to_dataframe" title="parmed.amber.AmberParm.to_dataframe"><tt class="xref py py-obj docutils literal"><span class="pre">to_dataframe</span></tt></a>()</td>
<td>Generates a DataFrame from the current Structure&#8217;s atomic properties</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.unchange" title="parmed.amber.AmberParm.unchange"><tt class="xref py py-obj docutils literal"><span class="pre">unchange</span></tt></a>()</td>
<td>Toggles all lists so that they do not indicate any changes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.update_dihedral_exclusions" title="parmed.amber.AmberParm.update_dihedral_exclusions"><tt class="xref py py-obj docutils literal"><span class="pre">update_dihedral_exclusions</span></tt></a>()</td>
<td>Nonbonded exclusions and exceptions have the following priority:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.view_as" title="parmed.amber.AmberParm.view_as"><tt class="xref py py-obj docutils literal"><span class="pre">view_as</span></tt></a>(cls)</td>
<td>Returns a view of the current object as another object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.writeParm" title="parmed.amber.AmberParm.writeParm"><tt class="xref py py-obj docutils literal"><span class="pre">writeParm</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.write_cif" title="parmed.amber.AmberParm.write_cif"><tt class="xref py py-obj docutils literal"><span class="pre">write_cif</span></tt></a>(struct,&nbsp;dest[,&nbsp;renumber,&nbsp;...])</td>
<td>Write a PDB file from the current Structure instance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.write_parm" title="parmed.amber.AmberParm.write_parm"><tt class="xref py py-obj docutils literal"><span class="pre">write_parm</span></tt></a>(name)</td>
<td>Writes the current data in parm_data into a new topology file with a given name.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.write_pdb" title="parmed.amber.AmberParm.write_pdb"><tt class="xref py py-obj docutils literal"><span class="pre">write_pdb</span></tt></a>(struct,&nbsp;dest[,&nbsp;renumber,&nbsp;...])</td>
<td>Write a PDB file from a Structure instance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmberParm.write_psf" title="parmed.amber.AmberParm.write_psf"><tt class="xref py py-obj docutils literal"><span class="pre">write_psf</span></tt></a>(struct,&nbsp;dest[,&nbsp;vmd])</td>
<td>Writes a PSF file from the stored molecule</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmberParm.write_rst7" title="parmed.amber.AmberParm.write_rst7"><tt class="xref py py-obj docutils literal"><span class="pre">write_rst7</span></tt></a>(name[,&nbsp;netcdf])</td>
<td>Writes a restart file with the current coordinates and velocities and</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.AmberParm.ANGLE_FORCE_GROUP">
<tt class="descname">ANGLE_FORCE_GROUP</tt><em class="property"> = 1</em><a class="headerlink" href="#parmed.amber.AmberParm.ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.BOND_FORCE_GROUP">
<tt class="descname">BOND_FORCE_GROUP</tt><em class="property"> = 0</em><a class="headerlink" href="#parmed.amber.AmberParm.BOND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.CMAP_FORCE_GROUP">
<tt class="descname">CMAP_FORCE_GROUP</tt><em class="property"> = 5</em><a class="headerlink" href="#parmed.amber.AmberParm.CMAP_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.DIHEDRAL_FORCE_GROUP">
<tt class="descname">DIHEDRAL_FORCE_GROUP</tt><em class="property"> = 2</em><a class="headerlink" href="#parmed.amber.AmberParm.DIHEDRAL_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.IMPROPER_FORCE_GROUP">
<tt class="descname">IMPROPER_FORCE_GROUP</tt><em class="property"> = 4</em><a class="headerlink" href="#parmed.amber.AmberParm.IMPROPER_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.NONBONDED_FORCE_GROUP">
<tt class="descname">NONBONDED_FORCE_GROUP</tt><em class="property"> = 11</em><a class="headerlink" href="#parmed.amber.AmberParm.NONBONDED_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.OUT_OF_PLANE_BEND_FORCE_GROUP">
<tt class="descname">OUT_OF_PLANE_BEND_FORCE_GROUP</tt><em class="property"> = 7</em><a class="headerlink" href="#parmed.amber.AmberParm.OUT_OF_PLANE_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.PI_TORSION_FORCE_GROUP">
<tt class="descname">PI_TORSION_FORCE_GROUP</tt><em class="property"> = 8</em><a class="headerlink" href="#parmed.amber.AmberParm.PI_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.RB_TORSION_FORCE_GROUP">
<tt class="descname">RB_TORSION_FORCE_GROUP</tt><em class="property"> = 12</em><a class="headerlink" href="#parmed.amber.AmberParm.RB_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.STRETCH_BEND_FORCE_GROUP">
<tt class="descname">STRETCH_BEND_FORCE_GROUP</tt><em class="property"> = 9</em><a class="headerlink" href="#parmed.amber.AmberParm.STRETCH_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.TORSION_TORSION_FORCE_GROUP">
<tt class="descname">TORSION_TORSION_FORCE_GROUP</tt><em class="property"> = 10</em><a class="headerlink" href="#parmed.amber.AmberParm.TORSION_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.TRIGONAL_ANGLE_FORCE_GROUP">
<tt class="descname">TRIGONAL_ANGLE_FORCE_GROUP</tt><em class="property"> = 6</em><a class="headerlink" href="#parmed.amber.AmberParm.TRIGONAL_ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.UREY_BRADLEY_FORCE_GROUP">
<tt class="descname">UREY_BRADLEY_FORCE_GROUP</tt><em class="property"> = 3</em><a class="headerlink" href="#parmed.amber.AmberParm.UREY_BRADLEY_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.addFlag">
<tt class="descname">addFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.addFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.add_atom">
<tt class="descname">add_atom</tt><big>(</big><em>atom</em>, <em>resname</em>, <em>resnum</em>, <em>chain=''</em>, <em>inscode=''</em>, <em>segid=''</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if
it has a different name or number as the last residue added and adding
it to the <cite>atoms</cite> list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></p>
<blockquote>
<div><p>The atom to add to this residue list</p>
</div></blockquote>
<p><strong>resname</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The name of the residue this atom belongs to</p>
</div></blockquote>
<p><strong>resnum</strong> : <tt class="docutils literal"><span class="pre">int</span></tt></p>
<blockquote>
<div><p>The number of the residue this atom belongs to</p>
</div></blockquote>
<p><strong>chain</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The chain ID character for this residue</p>
</div></blockquote>
<p><strong>inscode</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The insertion code ID character for this residue (it is stripped)</p>
</div></blockquote>
<p><strong>segid</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote class="last">
<div><p>The segment identifier for this residue (it is stripped)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the residue name and number differ from the last residue in this
list, a new residue is added and the atom is added to that residue</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.add_atom_to_residue">
<tt class="descname">add_atom_to_residue</tt><big>(</big><em>atom</em>, <em>residue</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.add_atom_to_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure at the end if the given residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></p>
<blockquote>
<div><p>The atom to add to the system</p>
</div></blockquote>
<p><strong>residue</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></p>
<blockquote class="last">
<div><p>The residue to which to add this atom. It MUST be part of this
Structure instance already or a ValueError is raised</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This atom is added at the end of the residue and is inserted into the
<cite>atoms</cite> list in such a way that all residues are composed of atoms
contiguous in the atoms list. For large systems, this may be a
relatively expensive operation</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.add_flag">
<tt class="descname">add_flag</tt><big>(</big><em>flag_name</em>, <em>flag_format</em>, <em>data=None</em>, <em>num_items=-1</em>, <em>comments=None</em>, <em>after=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.add_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.amoeba">
<tt class="descname">amoeba</tt><a class="headerlink" href="#parmed.amber.AmberParm.amoeba" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this instance uses the Amoeba force field</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.angles_inc_h">
<tt class="descname">angles_inc_h</tt><a class="headerlink" href="#parmed.amber.AmberParm.angles_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All angles including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.angles_without_h">
<tt class="descname">angles_without_h</tt><a class="headerlink" href="#parmed.amber.AmberParm.angles_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All angles including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.bonds_inc_h">
<tt class="descname">bonds_inc_h</tt><a class="headerlink" href="#parmed.amber.AmberParm.bonds_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All bonds including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.bonds_without_h">
<tt class="descname">bonds_without_h</tt><a class="headerlink" href="#parmed.amber.AmberParm.bonds_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All bonds without hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.AmberParm.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.box_vectors">
<tt class="descname">box_vectors</tt><a class="headerlink" href="#parmed.amber.AmberParm.box_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>3, 3-element tuple of unit cell vectors that are Quantity objects of
dimension length</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.chamber">
<tt class="descname">chamber</tt><a class="headerlink" href="#parmed.amber.AmberParm.chamber" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this instance uses the CHARMM force field</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.combining_rule">
<tt class="descname">combining_rule</tt><a class="headerlink" href="#parmed.amber.AmberParm.combining_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.AmberParm.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.coords">
<tt class="descname">coords</tt><a class="headerlink" href="#parmed.amber.AmberParm.coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.copy">
<tt class="descname">copy</tt><big>(</big><em>cls</em>, <em>split_dihedrals=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a copy of the current structure as an instance of a specified
subclass</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : Structure subclass</p>
<blockquote>
<div><p>The returned object is a copy of this structure as a <cite>cls</cite> instance</p>
</div></blockquote>
<p><strong>split_dihedrals</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, then the Dihedral entries will be split up so that each one
is paired with a single DihedralType (rather than a
DihedralTypeList)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><em>cls</em> instance</p>
<blockquote class="last">
<div><p>The instance of the Structure subclass <cite>cls</cite> with a copy of the
current Structure&#8217;s topology information</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.createSystem">
<tt class="descname">createSystem</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.createSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an OpenMM System representing the topology described by the
prmtop file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</div></blockquote>
<p><strong>switchDistance</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</div></blockquote>
<p><strong>constraints</strong> : None, app.HBonds, app.HAngles, or app.AllBonds</p>
<blockquote>
<div><p>Which type of constraints to add to the system (e.g., SHAKE). None
means no bonds are constrained. HBonds means bonds with hydrogen are
constrained</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool=True</p>
<blockquote>
<div><p>If True, water is kept rigid regardless of the value of constraints.
A value of False is ignored if constraints is not None.</p>
</div></blockquote>
<p><strong>implicitSolvent</strong> : None, app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</p>
<blockquote>
<div><p>The Generalized Born implicit solvent model to use.</p>
</div></blockquote>
<p><strong>implicitSolventKappa</strong> : float or 1/distance Quantity = None</p>
<blockquote>
<div><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</div></blockquote>
<p><strong>implicitSolventSaltConc</strong> : float or amount/volume Quantity=0 moles/liter</p>
<blockquote>
<div><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</div></blockquote>
<p><strong>temperature</strong> : float or temperature Quantity = 298.15 kelvin</p>
<blockquote>
<div><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</div></blockquote>
<p><strong>soluteDielectric</strong> : float=1.0</p>
<blockquote>
<div><p>The dielectric constant of the protein interior used in GB</p>
</div></blockquote>
<p><strong>solventDielectric</strong> : float=78.5</p>
<blockquote>
<div><p>The dielectric constant of the water used in GB</p>
</div></blockquote>
<p><strong>useSASA</strong> : bool=False</p>
<blockquote>
<div><p>If True, use the ACE non-polar solvation model. Otherwise, use no
SASA-based nonpolar solvation model.</p>
</div></blockquote>
<p><strong>removeCMMotion</strong> : bool=True</p>
<blockquote>
<div><p>If True, the center-of-mass motion will be removed periodically
during the simulation. If False, it will not.</p>
</div></blockquote>
<p><strong>hydrogenMass</strong> : float or mass quantity = None</p>
<blockquote>
<div><p>If not None, hydrogen masses will be changed to this mass and the
difference subtracted from the attached heavy atom (hydrogen mass
repartitioning)</p>
</div></blockquote>
<p><strong>ewaldErrorTolerance</strong> : float=0.0005</p>
<blockquote>
<div><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If False, the energies and forces from the constrained degrees of
freedom will NOT be computed. If True, they will (but those degrees
of freedom will <em>still</em> be constrained).</p>
</div></blockquote>
<p><strong>verbose</strong> : bool=False</p>
<blockquote class="last">
<div><p>If True, the progress of this subroutine will be printed to stdout</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function calls prune_empty_terms if any Topology lists have changed</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.deleteFlag">
<tt class="descname">deleteFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.deleteFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.delete_flag">
<tt class="descname">delete_flag</tt><big>(</big><em>flag_name</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.delete_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.dihedrals_inc_h">
<tt class="descname">dihedrals_inc_h</tt><a class="headerlink" href="#parmed.amber.AmberParm.dihedrals_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All dihedrals including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.dihedrals_without_h">
<tt class="descname">dihedrals_without_h</tt><a class="headerlink" href="#parmed.amber.AmberParm.dihedrals_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All dihedrals including hydrogen</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.fill_LJ">
<tt class="descname">fill_LJ</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.fill_LJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Lennard-Jones parameters (Rmin/2 and epsilon) for each
atom type by computing their values from the A and B coefficients of
each atom interacting with itself.</p>
<p>This fills the <tt class="xref py py-attr docutils literal"><span class="pre">LJ_radius</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">LJ_depth</span></tt>, and <tt class="xref py py-attr docutils literal"><span class="pre">LJ_types</span></tt>
data structures.</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmberParm.from_rawdata">
<em class="property">classmethod </em><tt class="descname">from_rawdata</tt><big>(</big><em>rawdata</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.from_rawdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the raw data from a AmberFormat object and initialize an AmberParm
from that data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rawdata</strong> : <a class="reference internal" href="#parmed.amber.AmberFormat" title="parmed.amber.AmberFormat"><tt class="xref py py-class docutils literal"><span class="pre">AmberFormat</span></tt></a></p>
<blockquote>
<div><p>An AmberFormat instance that has already been instantiated</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>parm</strong> : <a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a></p>
<blockquote class="last">
<div><p>An instance of this type from the data in rawdata</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmberParm.from_structure">
<em class="property">classmethod </em><tt class="descname">from_structure</tt><big>(</big><em>struct</em>, <em>copy=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a Structure instance and initialize an AmberParm instance from that
data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The input structure from which to construct an AmberParm instance</p>
</div></blockquote>
<p><strong>copy</strong> : bool</p>
<blockquote>
<div><p>If True, the input struct is deep-copied to make sure it does not
share any objects with the original <tt class="docutils literal"><span class="pre">struct</span></tt>. Default is False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>inst</strong> : <a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a></p>
<blockquote>
<div><p>The AmberParm instance derived from the input structure</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>TypeError</strong></p>
<blockquote class="last">
<div><p>If the structure has parameters not supported by the standard Amber
force field (i.e., standard bond, angle, and dihedral types)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Due to the nature of the prmtop file, struct almost <em>always</em> returns a
deep copy. The one exception is when struct is already of type
<a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a>, in which case the original object is returned unless
<tt class="docutils literal"><span class="pre">copy</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.get_coordinates">
<tt class="descname">get_coordinates</tt><big>(</big><em>frame='all'</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.get_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>In some cases, multiple conformations may be stored in the Structure.
This function retrieves a particular frame&#8217;s coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>frame</strong> : int or &#8216;all&#8217;, optional</p>
<blockquote>
<div><p>The frame number whose coordinates should be retrieved. Default is
&#8216;all&#8217;</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> : np.ndarray, shape([#,] natom, 3) or None</p>
<blockquote>
<div><p>If frame is &#8216;all&#8217;, all coordinates are returned with shape
(#, natom, 3). Otherwise the requested frame is returned with shape
(natom, 3). If no coordinates exist and &#8216;all&#8217; is requested, None is
returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>IndexError if there are fewer than ``frame`` coordinates</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.has_1012">
<tt class="descname">has_1012</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.has_1012" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine determines whether there are any defined 10-12
Lennard-Jones interactions that are non-zero</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>has_10_12</strong> : bool</p>
<blockquote class="last">
<div><p>If True, 10-12 interactions <em>are</em> defined for this particular system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.has_NBFIX">
<tt class="descname">has_NBFIX</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.has_NBFIX" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine determines whether there are any off-diagonal Lennard-Jones
modifications (i.e., if any two atoms have a L-J pair interaction that
does not match the combined L-J parameters for that pair).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>nbfix</strong> : bool</p>
<blockquote class="last">
<div><p>If True, off-diagonal elements in the combined Lennard-Jones matrix
exist. If False, they do not.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.has_cmap">
<tt class="descname">has_cmap</tt><a class="headerlink" href="#parmed.amber.AmberParm.has_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this instance has correction map terms or not</p>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberParm.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as either Amber-format file (like prmtop) or an
old-style topology file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber-style format, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.initialize_topology">
<tt class="descname">initialize_topology</tt><big>(</big><em>xyz=None</em>, <em>box=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.initialize_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes topology data structures, like the list of atoms, bonds,
etc., after the topology file has been read.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.is_changed">
<tt class="descname">is_changed</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.is_changed" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if any of the topological arrays have changed since the
last upload</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_atom_info">
<tt class="descname">load_atom_info</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_atom_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atom properties into the atoms that have been loaded. If any
arrays are too short or too long, an IndexError will be raised</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_coordinates">
<tt class="descname">load_coordinates</tt><big>(</big><em>coords</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the coordinates into the atom list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coords</strong> : list of floats</p>
<blockquote class="last">
<div><p>A 1-dimensional iterable of coordinates of shape (natom*3,) from
which all atomic coordinates are assigned. In Angstroms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is deprecated and will be removed in future versions. Just
set the &#8216;coordinates&#8217; attribute instead</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_dataframe">
<tt class="descname">load_dataframe</tt><big>(</big><em>df</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atomic properties from an input DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>A pandas DataFrame with atomic properties that will be used to set
the properties on the current list of atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.load_dataframe" title="parmed.utils.pandautils.load_dataframe"><tt class="xref py py-func docutils literal"><span class="pre">parmed.utils.pandautils.load_dataframe()</span></tt></a></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmberParm.load_from_rawdata">
<em class="property">classmethod </em><tt class="descname">load_from_rawdata</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_from_rawdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmberParm.load_from_structure">
<em class="property">classmethod </em><tt class="descname">load_from_structure</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_from_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_pointers">
<tt class="descname">load_pointers</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_pointers" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the data in POINTERS section into a pointers dictionary with each
key being the pointer name according to <a class="reference external" href="http://ambermd.org/formats.html">http://ambermd.org/formats.html</a></p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_rst7">
<tt class="descname">load_rst7</tt><big>(</big><em>rst7</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads coordinates into the AmberParm class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rst7</strong> : str or <a class="reference internal" href="#parmed.amber.Rst7" title="parmed.amber.Rst7"><tt class="xref py py-class docutils literal"><span class="pre">Rst7</span></tt></a></p>
<blockquote class="last">
<div><p>The Amber coordinate file (either ASCII restart or NetCDF restart)
object or filename to assign atomic coordinates from.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_structure">
<tt class="descname">load_structure</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all of the topology instance variables. This is necessary if we
actually want to modify the topological layout of our system
(like deleting atoms)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.load_velocities">
<tt class="descname">load_velocities</tt><big>(</big><em>vels</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.load_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the coordinates into the atom list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>vels</strong> : list of floats</p>
<blockquote class="last">
<div><p>A 1-dimensional iterable of velocities of shape (natom*3,) from
which all atomic velocities are assigned. In Angstroms/picosecond</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is deprecated and will be removed in future versions. Just
set the &#8216;velocities&#8217; attribute instead</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_add_constraints">
<tt class="descname">omm_add_constraints</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_add_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints to a given system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>system</strong> : mm.System</p>
<blockquote>
<div><p>The OpenMM system for which constraints should be added</p>
</div></blockquote>
<p><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>Which kind of constraints should be used</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool</p>
<blockquote class="last">
<div><p>If True, water bonds are constrained regardless of whether
constrains is None</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_angle_force">
<tt class="descname">omm_angle_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the
angles are for an Amoeba-parametrized system)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">force</p>
<blockquote class="last">
<div><p>HarmonicAngleForce (or AmoebaAngleForce if this is an Amoeba
system), or None if there are no angles to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_bond_force">
<tt class="descname">omm_bond_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_bond_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are
for an Amoeba-parametrized system)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool=True</p>
<blockquote>
<div><p>Should water-H bonds be constrained regardless of <cite>constraints</cite>?</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">force</p>
<blockquote class="last">
<div><p>HarmonicBondForce (or AmoebaBondForce if this is an Amoeba system),
or None if there are no bonds to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_cmap_force">
<tt class="descname">omm_cmap_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_cmap_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM CMAP torsion force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">CMAPTorsionForce</p>
<blockquote class="last">
<div><p>Or None, if no CMAP terms are present</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_dihedral_force">
<tt class="descname">omm_dihedral_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_dihedral_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PeriodicTorsionForce</p>
<blockquote class="last">
<div><p>Or None if no torsions are present in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_gbsa_force">
<tt class="descname">omm_gbsa_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_gbsa_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Generalized Born force for running implicit solvent
calculations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>implicitSolvent</strong> : app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</p>
<blockquote>
<div><p>The Generalized Born implicit solvent model to use.</p>
</div></blockquote>
<p><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace. Default is NoCutoff</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating opint number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff</p>
</div></blockquote>
<p><strong>implicitSolventKappa</strong> : float or 1/distance Quantity = None</p>
<blockquote>
<div><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</div></blockquote>
<p><strong>implicitSolventSaltConc</strong> : float or amount/volume Quantity=0 moles/liter</p>
<blockquote>
<div><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</div></blockquote>
<p><strong>temperature</strong> : float or temperature Quantity = 298.15 kelvin</p>
<blockquote>
<div><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</div></blockquote>
<p><strong>soluteDielectric</strong> : float=1.0</p>
<blockquote>
<div><p>The dielectric constant of the protein interior used in GB</p>
</div></blockquote>
<p><strong>solventDielectric</strong> : float=78.5</p>
<blockquote class="last">
<div><p>The dielectric constant of the water used in GB</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_improper_force">
<tt class="descname">omm_improper_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_improper_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM improper torsion force (quadratic bias)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">CustomTorsionForce</p>
<blockquote class="last">
<div><p>With the formula k*(phi-phi0)^2, or None if there are no impropers</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_nonbonded_force">
<tt class="descname">omm_nonbonded_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_nonbonded_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM NonbondedForce (and CustomNonbondedForce if
necessary) to define the nonbonded interatomic potential for this
system. A CustomNonbondedForce is used for the r^-4 part of the 12-6-4
Lennard-Jones potential as well as any modified off-diagonal (i.e.,
NBFIX) terms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</div></blockquote>
<p><strong>switchDistance</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</div></blockquote>
<p><strong>ewaldErrorTolerance</strong> : float=0.0005</p>
<blockquote>
<div><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</div></blockquote>
<p><strong>reactionFieldDielectric</strong> : float=78.5</p>
<blockquote>
<div><p>If the nonbondedMethod is CutoffPeriodic or CutoffNonPeriodic, the
region beyond the cutoff is treated using a reaction field method
with this dielectric constant. It should be set to 1 if another
implicit solvent model is being used (e.g., GB)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NonbondedForce [, CustomNonbondedForce]</p>
<blockquote class="last">
<div><p>If a CustomNonbondedForce is necessary, the return value is a
2-element tuple of NonbondedForce, CustomNonbondedForce. If only a
NonbondedForce is necessary, that is the return value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_out_of_plane_bend_force">
<tt class="descname">omm_out_of_plane_bend_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_out_of_plane_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba out-of-plane bend force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaOutOfPlaneBendForce</p>
<blockquote class="last">
<div><p>The out-of-plane bend Angle force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_pi_torsion_force">
<tt class="descname">omm_pi_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_pi_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba pi-torsion force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaPiTorsionForce</p>
<blockquote class="last">
<div><p>The pi-torsion force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_rb_torsion_force">
<tt class="descname">omm_rb_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_rb_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">RBTorsionForce</p>
<blockquote class="last">
<div><p>Or None if no torsions are present in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_set_virtual_sites">
<tt class="descname">omm_set_virtual_sites</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_set_virtual_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra
points defined in this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>system</strong> : mm.System</p>
<blockquote class="last">
<div><p>The system for which the virtual sites will be set. All particles
must have already been added to this System before calling this
method</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_stretch_bend_force">
<tt class="descname">omm_stretch_bend_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_stretch_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba stretch-bend force for this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaStretchBendForce</p>
<blockquote class="last">
<div><p>The stretch-bend force containing all terms in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_torsion_torsion_force">
<tt class="descname">omm_torsion_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_torsion_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba coupled-torsion (CMAP) force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaTorsionTorsionForce</p>
<blockquote class="last">
<div><p>The torsion-torsion (CMAP) force with all coupled-torsion parameters
for this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_trigonal_angle_force">
<tt class="descname">omm_trigonal_angle_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_trigonal_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba trigonal-angle force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaInPlaneAngleForce</p>
<blockquote class="last">
<div><p>The trigonal in-plane Angle force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.omm_urey_bradley_force">
<tt class="descname">omm_urey_bradley_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.omm_urey_bradley_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM Urey-Bradley force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HarmonicBondForce</p>
<blockquote class="last">
<div><p>Or None, if no urey-bradleys are present</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmberParm.parse">
<em class="property">static </em><tt class="descname">parse</tt><big>(</big><em>filename</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Meant for use with the automatic file loader, this will automatically
return a subclass of AmberFormat corresponding to what the information
in the prmtop file contains (i.e., either an AmberParm, ChamberParm,
AmoebaParm, or AmberFormat)</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.positions">
<tt class="descname">positions</tt><a class="headerlink" href="#parmed.amber.AmberParm.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of 3-element Quantity tuples of dimension length representing the
atomic positions for every atom in the system. If set with unitless
numbers, those numbers are assumed to be in angstroms. If any atoms do
not have coordinates, this is simply <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.prune_empty_terms">
<tt class="descname">prune_empty_terms</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.prune_empty_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks through all of the topological lists and gets rid of terms
in which at least one of the atoms is None or has an <cite>idx</cite> attribute set
to -1 (indicating that it has been removed from the <cite>atoms</cite> atom list)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.ptr">
<tt class="descname">ptr</tt><big>(</big><em>pointer</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.ptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the given pointer, and converts to upper-case so
it&#8217;s case-insensitive. A non-existent pointer meets with a KeyError</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pointer</strong> : str</p>
<blockquote>
<div><p>The AMBER pointer for which to extract the value</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The returned integer is the value of that pointer</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.rdparm">
<tt class="descname">rdparm</tt><big>(</big><em>fname</em>, <em>slow=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.rdparm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.rdparm_old">
<tt class="descname">rdparm_old</tt><big>(</big><em>prmtop_lines</em>, <em>check=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.rdparm_old" title="Permalink to this definition">¶</a></dt>
<dd><p>This reads an old-style topology file and stores the results in the
same data structures as a new-style topology file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prmtop_lines</strong> : list of str</p>
<blockquote>
<div><p>List of all lines in the prmtop file</p>
</div></blockquote>
<p><strong>check</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, only the first couple sections will be read to determine if
this is, in fact, an old-style topology file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.rdparm_slow">
<tt class="descname">rdparm_slow</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.rdparm_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file. This parser is written in pure Python and
is therefore slower than the C++-optimized version</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.recalculate_LJ">
<tt class="descname">recalculate_LJ</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.recalculate_LJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the <tt class="docutils literal"><span class="pre">LENNARD_JONES_ACOEF</span></tt> and <tt class="docutils literal"><span class="pre">LENNARD_JONES_BCOEF</span></tt> arrays in
the <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> raw data dictionary by applying the canonical
Lorentz-Berthelot combining rules to the values in <tt class="xref py py-attr docutils literal"><span class="pre">LJ_radius</span></tt> and
<tt class="xref py py-attr docutils literal"><span class="pre">LJ_depth</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.rediscover_molecules">
<tt class="descname">rediscover_molecules</tt><big>(</big><em>solute_ions=True</em>, <em>fix_broken=True</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.rediscover_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>This determines the molecularity and sets the ATOMS_PER_MOLECULE and
SOLVENT_POINTERS sections of the prmtops. Returns the new atom sequence
in terms of the &#8216;old&#8217; atom indexes if re-ordering was necessary to fix
the tleap bug. Returns None otherwise.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.remake_parm">
<tt class="descname">remake_parm</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.remake_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> from the data in the parameter and topology
arrays (e.g., <tt class="xref py py-attr docutils literal"><span class="pre">atoms</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">bonds</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">bond_types</span></tt>, ...)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.save">
<tt class="descname">save</tt><big>(</big><em>fname</em>, <em>format=None</em>, <em>overwrite=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current Structure in the requested file format. Supported
formats can be specified explicitly or determined by file-name
extension. The following formats are supported, with the recognized
suffix and <tt class="docutils literal"><span class="pre">format</span></tt> keyword shown in parentheses:</p>
<blockquote>
<div><ul class="simple">
<li>PDB (.pdb, pdb)</li>
<li>PDBx/mmCIF (.cif, cif)</li>
<li>PQR (.pqr, pqr)</li>
<li>Amber topology file (.prmtop/.parm7, amber)</li>
<li>CHARMM PSF file (.psf, charmm)</li>
<li>CHARMM coordinate file (.crd, charmmcrd)</li>
<li>Gromacs topology file (.top, gromacs)</li>
<li>Gromacs GRO file (.gro, gro)</li>
<li>Mol2 file (.mol2, mol2)</li>
<li>Mol3 file (.mol3, mol3)</li>
<li>Amber ASCII restart (.rst7/.inpcrd/.restrt, rst7)</li>
<li>Amber NetCDF restart (.ncrst, ncrst)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>Name of the file to save. If <tt class="docutils literal"><span class="pre">format</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> (see below), the
file type will be determined based on the filename extension. If the
type cannot be determined, a ValueError is raised.</p>
</div></blockquote>
<p><strong>format</strong> : str, optional</p>
<blockquote>
<div><p>The case-insensitive keyword specifying what type of file <tt class="docutils literal"><span class="pre">fname</span></tt>
should be saved as. If <tt class="docutils literal"><span class="pre">None</span></tt> (default), the file type will be
determined from filename extension of <tt class="docutils literal"><span class="pre">fname</span></tt></p>
</div></blockquote>
<p><strong>overwrite</strong> : bool, optional</p>
<blockquote>
<div><p>If True, allow the target file to be overwritten. Otherwise, an
IOError is raised if the file exists. Default is False</p>
</div></blockquote>
<p><strong>kwargs</strong> : keyword-arguments</p>
<blockquote>
<div><p>Remaining arguments are passed on to the file writing routines that
are called by this function</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError if either filename extension or ``format`` are not recognized</strong></p>
<p><strong>TypeError if the structure cannot be converted to the desired format for</strong></p>
<p><strong>whatever reason</strong></p>
<p><strong>IOError if the file cannot be written either because it exists and</strong></p>
<p><strong>``overwrite`` is ``False``, the filesystem is read-only, or write</strong></p>
<p class="last"><strong>permissions are not granted for the user</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.set_version">
<tt class="descname">set_version</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.set_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the version string</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.split">
<tt class="descname">split</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the current Structure into separate Structure instances for each
unique molecule. A molecule is defined as all atoms connected by a graph
of covalent bonds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>[structs, counts]</strong> : list of (<tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt>, list) tuples</p>
<blockquote class="last">
<div><p>List of all molecules in the order that they appear first in the
parent structure accompanied by the list of the molecule numbers
in which that molecule appears in the Structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.strip">
<tt class="descname">strip</tt><big>(</big><em>selection</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a subset of the atoms corresponding to an atom-based selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>selection</strong> : AmberMask, str, or iterable of bool</p>
<blockquote class="last">
<div><p>This is the selection of atoms that will be deleted from this
structure. If it is a string, it will be interpreted as an
AmberMask. If it is an AmberMask, it will be converted to a
selection of atoms. If it is an iterable, it must be the same length
as the <cite>atoms</cite> list.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.to_dataframe">
<tt class="descname">to_dataframe</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a DataFrame from the current Structure&#8217;s atomic properties</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote class="last">
<div><p>DataFrame with all atomic properties</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.create_dataframe" title="parmed.utils.pandautils.create_dataframe"><tt class="xref py py-func docutils literal"><span class="pre">parmed.utils.pandautils.create_dataframe()</span></tt></a>, <tt class="xref py py-obj docutils literal"><span class="pre">documentation</span></tt></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.topology">
<tt class="descname">topology</tt><a class="headerlink" href="#parmed.amber.AmberParm.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>The OpenMM Topology object. Cached when possible, but any changes to the
Structure instance results in the topology being deleted and rebuilt</p>
<p class="rubric">Notes</p>
<p>This function calls <tt class="docutils literal"><span class="pre">prune_empty_terms</span></tt> if any topology lists have
changed.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.unchange">
<tt class="descname">unchange</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.unchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggles all lists so that they do not indicate any changes</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.update_dihedral_exclusions">
<tt class="descname">update_dihedral_exclusions</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.update_dihedral_exclusions" title="Permalink to this definition">¶</a></dt>
<dd><p>Nonbonded exclusions and exceptions have the following priority:</p>
<p>bond -&gt; angle -&gt; dihedral</p>
<p>Since bonds and angles are completely excluded, any ring systems in
which two atoms are attached by a bond or angle as well as a dihedral
should be completely excluded as the bond and angle exclusion rules take
precedence.  If a Bond or Angle was _added_ to the structure between a
pair of atoms previously connected only by a dihedral term, it&#8217;s
possible that those two atoms have both an exclusion <em>and</em> an exception
defined. The result of this scenario is that sander and pmemd will
happily compute an energy, _including_ the 1-4 nonbonded terms between
atoms now connected by a bond or an Angle.  OpenMM, on the other hand,
will complain about an exception specified multiple times. This method
scans through all of the dihedrals in which <cite>ignore_end</cite> is <cite>False</cite> and
turns it to <cite>True</cite> if the two end atoms are in the bond or angle
partners arrays</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.AmberParm.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>A (natom, 3)-shape numpy array with atomic velocities for every atom in
the system (in units of angstrom/picosecond), or None if there are no
velocities</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.vels">
<tt class="descname">vels</tt><a class="headerlink" href="#parmed.amber.AmberParm.vels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmberParm.view">
<tt class="descname">view</tt><a class="headerlink" href="#parmed.amber.AmberParm.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an indexable object that can be indexed like a standard
Structure, but returns a <em>view</em> rather than a copy</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><tt class="xref py py-obj docutils literal"><span class="pre">Structure.__getitem__</span></tt></p>
</div>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.view_as">
<tt class="descname">view_as</tt><big>(</big><em>cls</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.view_as" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view of the current object as another object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : type</p>
<blockquote>
<div><p>Class definition of an AmberParm subclass for the current object to
be converted into</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of cls initialized from data in this object. This is NOT a deep</p>
<p>copy, so modifying the original object may modify this. The copy</p>
<p class="last">function will create a deep copy of any AmberFormat-derived object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.writeParm">
<tt class="descname">writeParm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.writeParm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.write_cif">
<tt class="descname">write_cif</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>renumber=True</em>, <em>coordinates=None</em>, <em>altlocs='all'</em>, <em>write_anisou=False</em>, <em>standard_resnames=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.write_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from the current Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The structure from which to write the PDBx/mmCIF file</p>
</div></blockquote>
<p><strong>dest</strong> : <tt class="docutils literal"><span class="pre">str</span> <span class="pre">or</span> <span class="pre">file-like</span></tt></p>
<blockquote>
<div><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</div></blockquote>
<p><strong>renumber</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously</p>
</div></blockquote>
<p><strong>coordinates</strong> : <tt class="docutils literal"><span class="pre">array-like</span> <span class="pre">of</span> <span class="pre">float</span></tt></p>
<blockquote>
<div><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the &#8220;original&#8221; PDB file if they
differ)</p>
</div></blockquote>
<p><strong>altlocs</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; : (default) print all alternate locations</li>
<li>&#8216;first&#8217; : print only the first alternate locations</li>
<li>&#8216;occupancy&#8217; : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</div></blockquote>
<p><strong>write_anisou</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written</p>
</div></blockquote>
<p><strong>standard_resnames</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.write_parm">
<tt class="descname">write_parm</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.write_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current data in parm_data into a new topology file with a
given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file to write the prmtop to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.write_pdb">
<tt class="descname">write_pdb</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>renumber=True</em>, <em>coordinates=None</em>, <em>altlocs='all'</em>, <em>write_anisou=False</em>, <em>charmm=False</em>, <em>standard_resnames=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.write_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from a Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The structure from which to write the PDB file</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</div></blockquote>
<p><strong>renumber</strong> : bool, optional</p>
<blockquote>
<div><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously. Default is True</p>
</div></blockquote>
<p><strong>coordinates</strong> : array-like of float, optional</p>
<blockquote>
<div><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the &#8220;original&#8221; PDB file if they
differ)</p>
</div></blockquote>
<p><strong>altlocs</strong> : str, optional</p>
<blockquote>
<div><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; : (default) print all alternate locations</li>
<li>&#8216;first&#8217; : print only the first alternate locations</li>
<li>&#8216;occupancy&#8217; : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</div></blockquote>
<p><strong>write_anisou</strong> : bool, optional</p>
<blockquote>
<div><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written. Default is False</p>
</div></blockquote>
<p><strong>charmm</strong> : bool, optional</p>
<blockquote>
<div><p>If True, SEGID will be written in columns 73 to 76 of the PDB file
in the typical CHARMM-style PDB output. This will be omitted for any
atom that does not contain a SEGID identifier. Default is False</p>
</div></blockquote>
<p><strong>standard_resnames</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.write_psf">
<tt class="descname">write_psf</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>vmd=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.write_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a PSF file from the stored molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The Structure instance from which the PSF should be written</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>The place to write the output PSF file.  If it has a &#8220;write&#8221;
attribute, it will be used to print the PSF file. Otherwise, it will
be treated like a string and a file will be opened, printed, then
closed</p>
</div></blockquote>
<p><strong>vmd</strong> : bool</p>
<blockquote class="last">
<div><p>If True, it will write out a PSF in the format that VMD prints it in
(i.e., no NUMLP/NUMLPH or MOLNT sections)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">CharmmPsfFile</span><span class="p">(</span><span class="s">&#39;testfiles/test.psf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">write_psf</span><span class="p">(</span><span class="s">&#39;testfiles/test2.psf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmberParm.write_rst7">
<tt class="descname">write_rst7</tt><big>(</big><em>name</em>, <em>netcdf=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmberParm.write_rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a restart file with the current coordinates and velocities and
box info if it&#8217;s present</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote>
<div><p>Name of the file to write the restart file to</p>
</div></blockquote>
<p><strong>netcdf</strong> : bool=False</p>
<blockquote class="last">
<div><p>If True, write a NetCDF-format restart file (requires a NetCDF
backend; scipy, netCDF4, or ScientificPython; to be installed)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If <cite>netcdf</cite> is not specified and the filename extension given by <cite>name</cite>
is <cite>.ncrst</cite>, the a NetCDF restart file will be written. However, an
explicit value for <cite>netcdf</cite> will override any filename extensions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.ChamberParm">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">ChamberParm</tt><big>(</big><em>prm_name=None</em>, <em>xyz=None</em>, <em>box=None</em>, <em>rst7_name=None</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">parmed.amber._amberparm.AmberParm</span></tt></p>
<p>Chamber Topology (parm7 format) class. Gives low, and some high, level
access to topology data or interact with some of the high-level classes
comprising the system topology and parameters.  The ChamberParm class uses
the same attributes that the AmberParm class uses, and only the ones unique
to ChamberParm will be shown below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prm_name</strong> : str, optional</p>
<blockquote>
<div><p>If provided, this file is parsed and the data structures will be loaded
from the data in this file</p>
</div></blockquote>
<p><strong>xyz</strong> : str or array, optional</p>
<blockquote>
<div><p>If provided, the coordinates and unit cell dimensions from the provided
Amber inpcrd/restart file will be loaded into the molecule, or the
coordinates will be loaded from the coordinate array</p>
</div></blockquote>
<p><strong>box</strong> : array, optional</p>
<blockquote class="last">
<div><p>If provided, the unit cell information will be set from the provided
unit cell dimensions (a, b, c, alpha, beta, and gamma, respectively)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="docutils">
<dt><tt class="xref py py-obj docutils literal"><span class="pre">See</span></tt></dt>
<dd>class:<cite>AmberParm</cite> for list of other attributes present in ChamberParm</dd>
</dl>
<p class="last"><tt class="xref py py-obj docutils literal"><span class="pre">instances</span></tt></p>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>LJ_14_radius</td>
<td>(list(float)) The same as LJ_radius, except specific for 1-4 nonbonded parameters, which may differ in the CHARMM force field</td>
</tr>
<tr class="row-even"><td>LJ_14_depth</td>
<td>(list(float)) The same as LJ_depth, except specific for 1-4 nonbonded parameters, which may differ in the CHARMM force field</td>
</tr>
<tr class="row-odd"><td>urey_bradleys</td>
<td>(TrackedList(UreyBradley)) List of Urey-Bradley terms between two atoms in a valence angle</td>
</tr>
<tr class="row-even"><td>impropers</td>
<td>(TrackedList(Improper)) List of CHARMM-style improper torsions</td>
</tr>
<tr class="row-odd"><td>cmaps</td>
<td>(TrackedList(Cmap)) List of coupled-torsion correction map parameters</td>
</tr>
<tr class="row-even"><td>urey_bradley_types</td>
<td>(TrackedList(UreyBradleyType)) List of parameters defining the Urey-Bradley terms</td>
</tr>
<tr class="row-odd"><td>improper_types</td>
<td>(TrackedList(Improper)) List of parameters defining the Improper terms</td>
</tr>
<tr class="row-even"><td>cmap_types</td>
<td>(TrackedList(CmapType)) List of parameters defining the CMAP terms</td>
</tr>
<tr class="row-odd"><td>chamber</td>
<td>(bool=True) On ChamberParm instances, this is always True to indicate that it is a CHAMBER-style topology file</td>
</tr>
<tr class="row-even"><td>amoeba</td>
<td>(bool=False) On ChamberParm instances, this is always False to indicate that it is not an AMOEBA-style topology file</td>
</tr>
<tr class="row-odd"><td>has_cmap</td>
<td>(bool) True if CMAP parameters are present in this system; False otherwise</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.addFlag" title="parmed.amber.ChamberParm.addFlag"><tt class="xref py py-obj docutils literal"><span class="pre">addFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.add_atom" title="parmed.amber.ChamberParm.add_atom"><tt class="xref py py-obj docutils literal"><span class="pre">add_atom</span></tt></a>(atom,&nbsp;resname,&nbsp;resnum[,&nbsp;chain,&nbsp;...])</td>
<td>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if it has a different name or number as the last residue added and adding it to the <cite>atoms</cite> list.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.add_atom_to_residue" title="parmed.amber.ChamberParm.add_atom_to_residue"><tt class="xref py py-obj docutils literal"><span class="pre">add_atom_to_residue</span></tt></a>(atom,&nbsp;residue)</td>
<td>Adds a new atom to the Structure at the end if the given residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.add_flag" title="parmed.amber.ChamberParm.add_flag"><tt class="xref py py-obj docutils literal"><span class="pre">add_flag</span></tt></a>(flag_name,&nbsp;flag_format[,&nbsp;data,&nbsp;...])</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.copy" title="parmed.amber.ChamberParm.copy"><tt class="xref py py-obj docutils literal"><span class="pre">copy</span></tt></a>(cls[,&nbsp;split_dihedrals])</td>
<td>Makes a copy of the current structure as an instance of a specified</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.createSystem" title="parmed.amber.ChamberParm.createSystem"><tt class="xref py py-obj docutils literal"><span class="pre">createSystem</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Construct an OpenMM System representing the topology described by the prmtop file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.deleteFlag" title="parmed.amber.ChamberParm.deleteFlag"><tt class="xref py py-obj docutils literal"><span class="pre">deleteFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.delete_flag" title="parmed.amber.ChamberParm.delete_flag"><tt class="xref py py-obj docutils literal"><span class="pre">delete_flag</span></tt></a>(flag_name)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.fill_LJ" title="parmed.amber.ChamberParm.fill_LJ"><tt class="xref py py-obj docutils literal"><span class="pre">fill_LJ</span></tt></a>()</td>
<td>Fills the LJ_radius, LJ_depth arrays and LJ_types dictionary with data from LENNARD_JONES_ACOEF and LENNARD_JONES_BCOEF sections of the prmtop files, by undoing the canonical combining rules.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.from_rawdata" title="parmed.amber.ChamberParm.from_rawdata"><tt class="xref py py-obj docutils literal"><span class="pre">from_rawdata</span></tt></a>(rawdata)</td>
<td>Take the raw data from a AmberFormat object and initialize an AmberParm from that data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.from_structure" title="parmed.amber.ChamberParm.from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">from_structure</span></tt></a>(struct[,&nbsp;copy])</td>
<td>Take a Structure instance and initialize a ChamberParm instance from that data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.get_coordinates" title="parmed.amber.ChamberParm.get_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">get_coordinates</span></tt></a>([frame])</td>
<td>In some cases, multiple conformations may be stored in the Structure.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.has_1012" title="parmed.amber.ChamberParm.has_1012"><tt class="xref py py-obj docutils literal"><span class="pre">has_1012</span></tt></a>()</td>
<td>This routine determines whether there are any defined 10-12</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.has_NBFIX" title="parmed.amber.ChamberParm.has_NBFIX"><tt class="xref py py-obj docutils literal"><span class="pre">has_NBFIX</span></tt></a>()</td>
<td>This routine determines whether there are any off-diagonal Lennard-Jones modifications (i.e., if any two atoms have a L-J pair interaction that does not match the combined L-J parameters for that pair).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.id_format" title="parmed.amber.ChamberParm.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as either Amber-format file (like prmtop) or an old-style topology file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.initialize_topology" title="parmed.amber.ChamberParm.initialize_topology"><tt class="xref py py-obj docutils literal"><span class="pre">initialize_topology</span></tt></a>([xyz,&nbsp;box])</td>
<td>Initializes topology data structures, like the list of atoms, bonds, etc., after the topology file has been read.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.is_changed" title="parmed.amber.ChamberParm.is_changed"><tt class="xref py py-obj docutils literal"><span class="pre">is_changed</span></tt></a>()</td>
<td>Determines if any of the topological arrays have changed since the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_atom_info" title="parmed.amber.ChamberParm.load_atom_info"><tt class="xref py py-obj docutils literal"><span class="pre">load_atom_info</span></tt></a>()</td>
<td>Loads atom properties into the atoms that have been loaded.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_coordinates" title="parmed.amber.ChamberParm.load_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">load_coordinates</span></tt></a>(coords)</td>
<td>Loads the coordinates into the atom list</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_dataframe" title="parmed.amber.ChamberParm.load_dataframe"><tt class="xref py py-obj docutils literal"><span class="pre">load_dataframe</span></tt></a>(df)</td>
<td>Loads atomic properties from an input DataFrame</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_from_rawdata" title="parmed.amber.ChamberParm.load_from_rawdata"><tt class="xref py py-obj docutils literal"><span class="pre">load_from_rawdata</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_from_structure" title="parmed.amber.ChamberParm.load_from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">load_from_structure</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_pointers" title="parmed.amber.ChamberParm.load_pointers"><tt class="xref py py-obj docutils literal"><span class="pre">load_pointers</span></tt></a>()</td>
<td>Loads the data in POINTERS section into a pointers dictionary with each</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_rst7" title="parmed.amber.ChamberParm.load_rst7"><tt class="xref py py-obj docutils literal"><span class="pre">load_rst7</span></tt></a>(rst7)</td>
<td>Loads coordinates into the AmberParm class</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_structure" title="parmed.amber.ChamberParm.load_structure"><tt class="xref py py-obj docutils literal"><span class="pre">load_structure</span></tt></a>()</td>
<td>Loads all of the topology instance variables.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.load_velocities" title="parmed.amber.ChamberParm.load_velocities"><tt class="xref py py-obj docutils literal"><span class="pre">load_velocities</span></tt></a>(vels)</td>
<td>Loads the coordinates into the atom list</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_add_constraints" title="parmed.amber.ChamberParm.omm_add_constraints"><tt class="xref py py-obj docutils literal"><span class="pre">omm_add_constraints</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds constraints to a given system</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_angle_force" title="parmed.amber.ChamberParm.omm_angle_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_angle_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_bond_force" title="parmed.amber.ChamberParm.omm_bond_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_bond_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_cmap_force" title="parmed.amber.ChamberParm.omm_cmap_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_cmap_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM CMAP torsion force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_dihedral_force" title="parmed.amber.ChamberParm.omm_dihedral_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_dihedral_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_gbsa_force" title="parmed.amber.ChamberParm.omm_gbsa_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_gbsa_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates a Generalized Born force for running implicit solvent</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_improper_force" title="parmed.amber.ChamberParm.omm_improper_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_improper_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM improper torsion force (quadratic bias)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_nonbonded_force" title="parmed.amber.ChamberParm.omm_nonbonded_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_nonbonded_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM NonbondedForce (and CustomNonbondedForce if necessary) to define the nonbonded interatomic potential for this system.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_out_of_plane_bend_force" title="parmed.amber.ChamberParm.omm_out_of_plane_bend_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_out_of_plane_bend_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba out-of-plane bend force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_pi_torsion_force" title="parmed.amber.ChamberParm.omm_pi_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_pi_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba pi-torsion force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_rb_torsion_force" title="parmed.amber.ChamberParm.omm_rb_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_rb_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_set_virtual_sites" title="parmed.amber.ChamberParm.omm_set_virtual_sites"><tt class="xref py py-obj docutils literal"><span class="pre">omm_set_virtual_sites</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_stretch_bend_force" title="parmed.amber.ChamberParm.omm_stretch_bend_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_stretch_bend_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Create the OpenMM Amoeba stretch-bend force for this system</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_torsion_torsion_force" title="parmed.amber.ChamberParm.omm_torsion_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_torsion_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Create the OpenMM Amoeba coupled-torsion (CMAP) force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_trigonal_angle_force" title="parmed.amber.ChamberParm.omm_trigonal_angle_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_trigonal_angle_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba trigonal-angle force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.omm_urey_bradley_force" title="parmed.amber.ChamberParm.omm_urey_bradley_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_urey_bradley_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM Urey-Bradley force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.parse" title="parmed.amber.ChamberParm.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(filename,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Meant for use with the automatic file loader, this will automatically</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.prune_empty_terms" title="parmed.amber.ChamberParm.prune_empty_terms"><tt class="xref py py-obj docutils literal"><span class="pre">prune_empty_terms</span></tt></a>()</td>
<td>Looks through all of the topological lists and gets rid of terms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.ptr" title="parmed.amber.ChamberParm.ptr"><tt class="xref py py-obj docutils literal"><span class="pre">ptr</span></tt></a>(pointer)</td>
<td>Returns the value of the given pointer, and converts to upper-case so it&#8217;s case-insensitive.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.rdparm" title="parmed.amber.ChamberParm.rdparm"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm</span></tt></a>(fname[,&nbsp;slow])</td>
<td>Parses the Amber format file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.rdparm_old" title="parmed.amber.ChamberParm.rdparm_old"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_old</span></tt></a>(prmtop_lines[,&nbsp;check])</td>
<td>This reads an old-style topology file and stores the results in the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.rdparm_slow" title="parmed.amber.ChamberParm.rdparm_slow"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_slow</span></tt></a>(fname)</td>
<td>Parses the Amber format file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.recalculate_LJ" title="parmed.amber.ChamberParm.recalculate_LJ"><tt class="xref py py-obj docutils literal"><span class="pre">recalculate_LJ</span></tt></a>()</td>
<td>Takes the values of the LJ_radius and LJ_depth arrays and recalculates the LENNARD_JONES_A/BCOEF topology sections from the canonical combining rules.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.rediscover_molecules" title="parmed.amber.ChamberParm.rediscover_molecules"><tt class="xref py py-obj docutils literal"><span class="pre">rediscover_molecules</span></tt></a>([solute_ions,&nbsp;fix_broken])</td>
<td>This determines the molecularity and sets the ATOMS_PER_MOLECULE and SOLVENT_POINTERS sections of the prmtops.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.remake_parm" title="parmed.amber.ChamberParm.remake_parm"><tt class="xref py py-obj docutils literal"><span class="pre">remake_parm</span></tt></a>()</td>
<td>Fills <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> from the data in the parameter and topology</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.save" title="parmed.amber.ChamberParm.save"><tt class="xref py py-obj docutils literal"><span class="pre">save</span></tt></a>(fname[,&nbsp;format,&nbsp;overwrite])</td>
<td>Saves the current Structure in the requested file format.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.set_version" title="parmed.amber.ChamberParm.set_version"><tt class="xref py py-obj docutils literal"><span class="pre">set_version</span></tt></a>()</td>
<td>Sets the version string</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.split" title="parmed.amber.ChamberParm.split"><tt class="xref py py-obj docutils literal"><span class="pre">split</span></tt></a>()</td>
<td>Split the current Structure into separate Structure instances for each unique molecule.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.strip" title="parmed.amber.ChamberParm.strip"><tt class="xref py py-obj docutils literal"><span class="pre">strip</span></tt></a>(selection)</td>
<td>Deletes a subset of the atoms corresponding to an atom-based selection.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.to_dataframe" title="parmed.amber.ChamberParm.to_dataframe"><tt class="xref py py-obj docutils literal"><span class="pre">to_dataframe</span></tt></a>()</td>
<td>Generates a DataFrame from the current Structure&#8217;s atomic properties</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.unchange" title="parmed.amber.ChamberParm.unchange"><tt class="xref py py-obj docutils literal"><span class="pre">unchange</span></tt></a>()</td>
<td>Toggles all lists so that they do not indicate any changes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.update_dihedral_exclusions" title="parmed.amber.ChamberParm.update_dihedral_exclusions"><tt class="xref py py-obj docutils literal"><span class="pre">update_dihedral_exclusions</span></tt></a>()</td>
<td>Nonbonded exclusions and exceptions have the following priority:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.view_as" title="parmed.amber.ChamberParm.view_as"><tt class="xref py py-obj docutils literal"><span class="pre">view_as</span></tt></a>(cls)</td>
<td>Returns a view of the current object as another object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.writeParm" title="parmed.amber.ChamberParm.writeParm"><tt class="xref py py-obj docutils literal"><span class="pre">writeParm</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.write_cif" title="parmed.amber.ChamberParm.write_cif"><tt class="xref py py-obj docutils literal"><span class="pre">write_cif</span></tt></a>(struct,&nbsp;dest[,&nbsp;renumber,&nbsp;...])</td>
<td>Write a PDB file from the current Structure instance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.write_parm" title="parmed.amber.ChamberParm.write_parm"><tt class="xref py py-obj docutils literal"><span class="pre">write_parm</span></tt></a>(name)</td>
<td>Writes the current data in parm_data into a new topology file with a given name.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.write_pdb" title="parmed.amber.ChamberParm.write_pdb"><tt class="xref py py-obj docutils literal"><span class="pre">write_pdb</span></tt></a>(struct,&nbsp;dest[,&nbsp;renumber,&nbsp;...])</td>
<td>Write a PDB file from a Structure instance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.ChamberParm.write_psf" title="parmed.amber.ChamberParm.write_psf"><tt class="xref py py-obj docutils literal"><span class="pre">write_psf</span></tt></a>(struct,&nbsp;dest[,&nbsp;vmd])</td>
<td>Writes a PSF file from the stored molecule</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.ChamberParm.write_rst7" title="parmed.amber.ChamberParm.write_rst7"><tt class="xref py py-obj docutils literal"><span class="pre">write_rst7</span></tt></a>(name[,&nbsp;netcdf])</td>
<td>Writes a restart file with the current coordinates and velocities and</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.ChamberParm.ANGLE_FORCE_GROUP">
<tt class="descname">ANGLE_FORCE_GROUP</tt><em class="property"> = 1</em><a class="headerlink" href="#parmed.amber.ChamberParm.ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.BOND_FORCE_GROUP">
<tt class="descname">BOND_FORCE_GROUP</tt><em class="property"> = 0</em><a class="headerlink" href="#parmed.amber.ChamberParm.BOND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.CMAP_FORCE_GROUP">
<tt class="descname">CMAP_FORCE_GROUP</tt><em class="property"> = 5</em><a class="headerlink" href="#parmed.amber.ChamberParm.CMAP_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.DIHEDRAL_FORCE_GROUP">
<tt class="descname">DIHEDRAL_FORCE_GROUP</tt><em class="property"> = 2</em><a class="headerlink" href="#parmed.amber.ChamberParm.DIHEDRAL_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.IMPROPER_FORCE_GROUP">
<tt class="descname">IMPROPER_FORCE_GROUP</tt><em class="property"> = 4</em><a class="headerlink" href="#parmed.amber.ChamberParm.IMPROPER_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.NONBONDED_FORCE_GROUP">
<tt class="descname">NONBONDED_FORCE_GROUP</tt><em class="property"> = 11</em><a class="headerlink" href="#parmed.amber.ChamberParm.NONBONDED_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.OUT_OF_PLANE_BEND_FORCE_GROUP">
<tt class="descname">OUT_OF_PLANE_BEND_FORCE_GROUP</tt><em class="property"> = 7</em><a class="headerlink" href="#parmed.amber.ChamberParm.OUT_OF_PLANE_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.PI_TORSION_FORCE_GROUP">
<tt class="descname">PI_TORSION_FORCE_GROUP</tt><em class="property"> = 8</em><a class="headerlink" href="#parmed.amber.ChamberParm.PI_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.RB_TORSION_FORCE_GROUP">
<tt class="descname">RB_TORSION_FORCE_GROUP</tt><em class="property"> = 12</em><a class="headerlink" href="#parmed.amber.ChamberParm.RB_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.STRETCH_BEND_FORCE_GROUP">
<tt class="descname">STRETCH_BEND_FORCE_GROUP</tt><em class="property"> = 9</em><a class="headerlink" href="#parmed.amber.ChamberParm.STRETCH_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.TORSION_TORSION_FORCE_GROUP">
<tt class="descname">TORSION_TORSION_FORCE_GROUP</tt><em class="property"> = 10</em><a class="headerlink" href="#parmed.amber.ChamberParm.TORSION_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.TRIGONAL_ANGLE_FORCE_GROUP">
<tt class="descname">TRIGONAL_ANGLE_FORCE_GROUP</tt><em class="property"> = 6</em><a class="headerlink" href="#parmed.amber.ChamberParm.TRIGONAL_ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.UREY_BRADLEY_FORCE_GROUP">
<tt class="descname">UREY_BRADLEY_FORCE_GROUP</tt><em class="property"> = 3</em><a class="headerlink" href="#parmed.amber.ChamberParm.UREY_BRADLEY_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.addFlag">
<tt class="descname">addFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.addFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.add_atom">
<tt class="descname">add_atom</tt><big>(</big><em>atom</em>, <em>resname</em>, <em>resnum</em>, <em>chain=''</em>, <em>inscode=''</em>, <em>segid=''</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if
it has a different name or number as the last residue added and adding
it to the <cite>atoms</cite> list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></p>
<blockquote>
<div><p>The atom to add to this residue list</p>
</div></blockquote>
<p><strong>resname</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The name of the residue this atom belongs to</p>
</div></blockquote>
<p><strong>resnum</strong> : <tt class="docutils literal"><span class="pre">int</span></tt></p>
<blockquote>
<div><p>The number of the residue this atom belongs to</p>
</div></blockquote>
<p><strong>chain</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The chain ID character for this residue</p>
</div></blockquote>
<p><strong>inscode</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The insertion code ID character for this residue (it is stripped)</p>
</div></blockquote>
<p><strong>segid</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote class="last">
<div><p>The segment identifier for this residue (it is stripped)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the residue name and number differ from the last residue in this
list, a new residue is added and the atom is added to that residue</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.add_atom_to_residue">
<tt class="descname">add_atom_to_residue</tt><big>(</big><em>atom</em>, <em>residue</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.add_atom_to_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure at the end if the given residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></p>
<blockquote>
<div><p>The atom to add to the system</p>
</div></blockquote>
<p><strong>residue</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></p>
<blockquote class="last">
<div><p>The residue to which to add this atom. It MUST be part of this
Structure instance already or a ValueError is raised</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This atom is added at the end of the residue and is inserted into the
<cite>atoms</cite> list in such a way that all residues are composed of atoms
contiguous in the atoms list. For large systems, this may be a
relatively expensive operation</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.add_flag">
<tt class="descname">add_flag</tt><big>(</big><em>flag_name</em>, <em>flag_format</em>, <em>data=None</em>, <em>num_items=-1</em>, <em>comments=None</em>, <em>after=None</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.add_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.amoeba">
<tt class="descname">amoeba</tt><a class="headerlink" href="#parmed.amber.ChamberParm.amoeba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.angles_inc_h">
<tt class="descname">angles_inc_h</tt><a class="headerlink" href="#parmed.amber.ChamberParm.angles_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All angles including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.angles_without_h">
<tt class="descname">angles_without_h</tt><a class="headerlink" href="#parmed.amber.ChamberParm.angles_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All angles including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.bonds_inc_h">
<tt class="descname">bonds_inc_h</tt><a class="headerlink" href="#parmed.amber.ChamberParm.bonds_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All bonds including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.bonds_without_h">
<tt class="descname">bonds_without_h</tt><a class="headerlink" href="#parmed.amber.ChamberParm.bonds_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All bonds without hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.ChamberParm.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.box_vectors">
<tt class="descname">box_vectors</tt><a class="headerlink" href="#parmed.amber.ChamberParm.box_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>3, 3-element tuple of unit cell vectors that are Quantity objects of
dimension length</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.chamber">
<tt class="descname">chamber</tt><a class="headerlink" href="#parmed.amber.ChamberParm.chamber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.combining_rule">
<tt class="descname">combining_rule</tt><a class="headerlink" href="#parmed.amber.ChamberParm.combining_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.ChamberParm.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.coords">
<tt class="descname">coords</tt><a class="headerlink" href="#parmed.amber.ChamberParm.coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.copy">
<tt class="descname">copy</tt><big>(</big><em>cls</em>, <em>split_dihedrals=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a copy of the current structure as an instance of a specified
subclass</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : Structure subclass</p>
<blockquote>
<div><p>The returned object is a copy of this structure as a <cite>cls</cite> instance</p>
</div></blockquote>
<p><strong>split_dihedrals</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, then the Dihedral entries will be split up so that each one
is paired with a single DihedralType (rather than a
DihedralTypeList)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><em>cls</em> instance</p>
<blockquote class="last">
<div><p>The instance of the Structure subclass <cite>cls</cite> with a copy of the
current Structure&#8217;s topology information</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.createSystem">
<tt class="descname">createSystem</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.createSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an OpenMM System representing the topology described by the
prmtop file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</div></blockquote>
<p><strong>switchDistance</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</div></blockquote>
<p><strong>constraints</strong> : None, app.HBonds, app.HAngles, or app.AllBonds</p>
<blockquote>
<div><p>Which type of constraints to add to the system (e.g., SHAKE). None
means no bonds are constrained. HBonds means bonds with hydrogen are
constrained</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool=True</p>
<blockquote>
<div><p>If True, water is kept rigid regardless of the value of constraints.
A value of False is ignored if constraints is not None.</p>
</div></blockquote>
<p><strong>implicitSolvent</strong> : None, app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</p>
<blockquote>
<div><p>The Generalized Born implicit solvent model to use.</p>
</div></blockquote>
<p><strong>implicitSolventKappa</strong> : float or 1/distance Quantity = None</p>
<blockquote>
<div><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</div></blockquote>
<p><strong>implicitSolventSaltConc</strong> : float or amount/volume Quantity=0 moles/liter</p>
<blockquote>
<div><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</div></blockquote>
<p><strong>temperature</strong> : float or temperature Quantity = 298.15 kelvin</p>
<blockquote>
<div><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</div></blockquote>
<p><strong>soluteDielectric</strong> : float=1.0</p>
<blockquote>
<div><p>The dielectric constant of the protein interior used in GB</p>
</div></blockquote>
<p><strong>solventDielectric</strong> : float=78.5</p>
<blockquote>
<div><p>The dielectric constant of the water used in GB</p>
</div></blockquote>
<p><strong>useSASA</strong> : bool=False</p>
<blockquote>
<div><p>If True, use the ACE non-polar solvation model. Otherwise, use no
SASA-based nonpolar solvation model.</p>
</div></blockquote>
<p><strong>removeCMMotion</strong> : bool=True</p>
<blockquote>
<div><p>If True, the center-of-mass motion will be removed periodically
during the simulation. If False, it will not.</p>
</div></blockquote>
<p><strong>hydrogenMass</strong> : float or mass quantity = None</p>
<blockquote>
<div><p>If not None, hydrogen masses will be changed to this mass and the
difference subtracted from the attached heavy atom (hydrogen mass
repartitioning)</p>
</div></blockquote>
<p><strong>ewaldErrorTolerance</strong> : float=0.0005</p>
<blockquote>
<div><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If False, the energies and forces from the constrained degrees of
freedom will NOT be computed. If True, they will (but those degrees
of freedom will <em>still</em> be constrained).</p>
</div></blockquote>
<p><strong>verbose</strong> : bool=False</p>
<blockquote class="last">
<div><p>If True, the progress of this subroutine will be printed to stdout</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function calls prune_empty_terms if any Topology lists have changed</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.deleteFlag">
<tt class="descname">deleteFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.deleteFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.delete_flag">
<tt class="descname">delete_flag</tt><big>(</big><em>flag_name</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.delete_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.dihedrals_inc_h">
<tt class="descname">dihedrals_inc_h</tt><a class="headerlink" href="#parmed.amber.ChamberParm.dihedrals_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All dihedrals including hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.dihedrals_without_h">
<tt class="descname">dihedrals_without_h</tt><a class="headerlink" href="#parmed.amber.ChamberParm.dihedrals_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All dihedrals including hydrogen</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.fill_LJ">
<tt class="descname">fill_LJ</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.fill_LJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the LJ_radius, LJ_depth arrays and LJ_types dictionary with data
from LENNARD_JONES_ACOEF and LENNARD_JONES_BCOEF sections of the prmtop
files, by undoing the canonical combining rules.</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.ChamberParm.from_rawdata">
<em class="property">classmethod </em><tt class="descname">from_rawdata</tt><big>(</big><em>rawdata</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.from_rawdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the raw data from a AmberFormat object and initialize an AmberParm
from that data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rawdata</strong> : <a class="reference internal" href="#parmed.amber.AmberFormat" title="parmed.amber.AmberFormat"><tt class="xref py py-class docutils literal"><span class="pre">AmberFormat</span></tt></a></p>
<blockquote>
<div><p>An AmberFormat instance that has already been instantiated</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>parm</strong> : <a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a></p>
<blockquote class="last">
<div><p>An instance of this type from the data in rawdata</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.ChamberParm.from_structure">
<em class="property">classmethod </em><tt class="descname">from_structure</tt><big>(</big><em>struct</em>, <em>copy=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a Structure instance and initialize a ChamberParm instance from
that data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : Structure</p>
<blockquote>
<div><p>The input structure from which to construct a ChamberParm instance</p>
</div></blockquote>
<p><strong>copy</strong> : bool</p>
<blockquote>
<div><p>If True, the input struct is deep-copied to make sure it does not
share any objects with the original <tt class="docutils literal"><span class="pre">struct</span></tt>. Default is False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>inst</strong> : <a class="reference internal" href="#parmed.amber.ChamberParm" title="parmed.amber.ChamberParm"><tt class="xref py py-class docutils literal"><span class="pre">ChamberParm</span></tt></a></p>
<blockquote class="last">
<div><p>The ChamberParm instance derived from the input structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Due to the nature of the prmtop file, struct almost <em>always</em> returns a
deep copy. The one exception is when struct is already of type
<a class="reference internal" href="#parmed.amber.ChamberParm" title="parmed.amber.ChamberParm"><tt class="xref py py-class docutils literal"><span class="pre">ChamberParm</span></tt></a>, in which case the original object is returned
unless <tt class="docutils literal"><span class="pre">copy</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.get_coordinates">
<tt class="descname">get_coordinates</tt><big>(</big><em>frame='all'</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.get_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>In some cases, multiple conformations may be stored in the Structure.
This function retrieves a particular frame&#8217;s coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>frame</strong> : int or &#8216;all&#8217;, optional</p>
<blockquote>
<div><p>The frame number whose coordinates should be retrieved. Default is
&#8216;all&#8217;</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> : np.ndarray, shape([#,] natom, 3) or None</p>
<blockquote>
<div><p>If frame is &#8216;all&#8217;, all coordinates are returned with shape
(#, natom, 3). Otherwise the requested frame is returned with shape
(natom, 3). If no coordinates exist and &#8216;all&#8217; is requested, None is
returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>IndexError if there are fewer than ``frame`` coordinates</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.has_1012">
<tt class="descname">has_1012</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.has_1012" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine determines whether there are any defined 10-12
Lennard-Jones interactions that are non-zero</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>has_10_12</strong> : bool</p>
<blockquote class="last">
<div><p>If True, 10-12 interactions <em>are</em> defined for this particular system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.has_NBFIX">
<tt class="descname">has_NBFIX</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.has_NBFIX" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine determines whether there are any off-diagonal Lennard-Jones
modifications (i.e., if any two atoms have a L-J pair interaction that
does not match the combined L-J parameters for that pair).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>nbfix</strong> : bool</p>
<blockquote class="last">
<div><p>If True, off-diagonal elements in the combined Lennard-Jones matrix
exist. If False, they do not.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.has_cmap">
<tt class="descname">has_cmap</tt><a class="headerlink" href="#parmed.amber.ChamberParm.has_cmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.ChamberParm.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as either Amber-format file (like prmtop) or an
old-style topology file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber-style format, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.initialize_topology">
<tt class="descname">initialize_topology</tt><big>(</big><em>xyz=None</em>, <em>box=None</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.initialize_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes topology data structures, like the list of atoms, bonds,
etc., after the topology file has been read. The following methods are
called:</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.is_changed">
<tt class="descname">is_changed</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.is_changed" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if any of the topological arrays have changed since the
last upload</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_atom_info">
<tt class="descname">load_atom_info</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_atom_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atom properties into the atoms that have been loaded. If any
arrays are too short or too long, an IndexError will be raised</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_coordinates">
<tt class="descname">load_coordinates</tt><big>(</big><em>coords</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the coordinates into the atom list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coords</strong> : list of floats</p>
<blockquote class="last">
<div><p>A 1-dimensional iterable of coordinates of shape (natom*3,) from
which all atomic coordinates are assigned. In Angstroms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is deprecated and will be removed in future versions. Just
set the &#8216;coordinates&#8217; attribute instead</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_dataframe">
<tt class="descname">load_dataframe</tt><big>(</big><em>df</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atomic properties from an input DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>A pandas DataFrame with atomic properties that will be used to set
the properties on the current list of atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.load_dataframe" title="parmed.utils.pandautils.load_dataframe"><tt class="xref py py-func docutils literal"><span class="pre">parmed.utils.pandautils.load_dataframe()</span></tt></a></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.ChamberParm.load_from_rawdata">
<em class="property">classmethod </em><tt class="descname">load_from_rawdata</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_from_rawdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.ChamberParm.load_from_structure">
<em class="property">classmethod </em><tt class="descname">load_from_structure</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_from_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_pointers">
<tt class="descname">load_pointers</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_pointers" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the data in POINTERS section into a pointers dictionary with each
key being the pointer name according to <a class="reference external" href="http://ambermd.org/formats.html">http://ambermd.org/formats.html</a></p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_rst7">
<tt class="descname">load_rst7</tt><big>(</big><em>rst7</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads coordinates into the AmberParm class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rst7</strong> : str or <a class="reference internal" href="#parmed.amber.Rst7" title="parmed.amber.Rst7"><tt class="xref py py-class docutils literal"><span class="pre">Rst7</span></tt></a></p>
<blockquote class="last">
<div><p>The Amber coordinate file (either ASCII restart or NetCDF restart)
object or filename to assign atomic coordinates from.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_structure">
<tt class="descname">load_structure</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all of the topology instance variables. This is necessary if we
actually want to modify the topological layout of our system
(like deleting atoms)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.load_velocities">
<tt class="descname">load_velocities</tt><big>(</big><em>vels</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.load_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the coordinates into the atom list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>vels</strong> : list of floats</p>
<blockquote class="last">
<div><p>A 1-dimensional iterable of velocities of shape (natom*3,) from
which all atomic velocities are assigned. In Angstroms/picosecond</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is deprecated and will be removed in future versions. Just
set the &#8216;velocities&#8217; attribute instead</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_add_constraints">
<tt class="descname">omm_add_constraints</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_add_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints to a given system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>system</strong> : mm.System</p>
<blockquote>
<div><p>The OpenMM system for which constraints should be added</p>
</div></blockquote>
<p><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>Which kind of constraints should be used</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool</p>
<blockquote class="last">
<div><p>If True, water bonds are constrained regardless of whether
constrains is None</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_angle_force">
<tt class="descname">omm_angle_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the
angles are for an Amoeba-parametrized system)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">force</p>
<blockquote class="last">
<div><p>HarmonicAngleForce (or AmoebaAngleForce if this is an Amoeba
system), or None if there are no angles to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_bond_force">
<tt class="descname">omm_bond_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_bond_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are
for an Amoeba-parametrized system)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool=True</p>
<blockquote>
<div><p>Should water-H bonds be constrained regardless of <cite>constraints</cite>?</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">force</p>
<blockquote class="last">
<div><p>HarmonicBondForce (or AmoebaBondForce if this is an Amoeba system),
or None if there are no bonds to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_cmap_force">
<tt class="descname">omm_cmap_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_cmap_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM CMAP torsion force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">CMAPTorsionForce</p>
<blockquote class="last">
<div><p>Or None, if no CMAP terms are present</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_dihedral_force">
<tt class="descname">omm_dihedral_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_dihedral_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PeriodicTorsionForce</p>
<blockquote class="last">
<div><p>Or None if no torsions are present in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_gbsa_force">
<tt class="descname">omm_gbsa_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_gbsa_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Generalized Born force for running implicit solvent
calculations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>implicitSolvent</strong> : app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</p>
<blockquote>
<div><p>The Generalized Born implicit solvent model to use.</p>
</div></blockquote>
<p><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace. Default is NoCutoff</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating opint number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff</p>
</div></blockquote>
<p><strong>implicitSolventKappa</strong> : float or 1/distance Quantity = None</p>
<blockquote>
<div><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</div></blockquote>
<p><strong>implicitSolventSaltConc</strong> : float or amount/volume Quantity=0 moles/liter</p>
<blockquote>
<div><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</div></blockquote>
<p><strong>temperature</strong> : float or temperature Quantity = 298.15 kelvin</p>
<blockquote>
<div><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</div></blockquote>
<p><strong>soluteDielectric</strong> : float=1.0</p>
<blockquote>
<div><p>The dielectric constant of the protein interior used in GB</p>
</div></blockquote>
<p><strong>solventDielectric</strong> : float=78.5</p>
<blockquote class="last">
<div><p>The dielectric constant of the water used in GB</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_improper_force">
<tt class="descname">omm_improper_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_improper_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM improper torsion force (quadratic bias)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">CustomTorsionForce</p>
<blockquote class="last">
<div><p>With the formula k*(phi-phi0)^2, or None if there are no impropers</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_nonbonded_force">
<tt class="descname">omm_nonbonded_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_nonbonded_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM NonbondedForce (and CustomNonbondedForce if
necessary) to define the nonbonded interatomic potential for this
system. A CustomNonbondedForce is used for the r^-4 part of the 12-6-4
Lennard-Jones potential as well as any modified off-diagonal (i.e.,
NBFIX) terms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</div></blockquote>
<p><strong>switchDistance</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</div></blockquote>
<p><strong>ewaldErrorTolerance</strong> : float=0.0005</p>
<blockquote>
<div><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</div></blockquote>
<p><strong>reactionFieldDielectric</strong> : float=78.5</p>
<blockquote>
<div><p>If the nonbondedMethod is CutoffPeriodic or CutoffNonPeriodic, the
region beyond the cutoff is treated using a reaction field method
with this dielectric constant. It should be set to 1 if another
implicit solvent model is being used (e.g., GB)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NonbondedForce [, CustomNonbondedForce]</p>
<blockquote class="last">
<div><p>If a CustomNonbondedForce is necessary, the return value is a
2-element tuple of NonbondedForce, CustomNonbondedForce. If only a
NonbondedForce is necessary, that is the return value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_out_of_plane_bend_force">
<tt class="descname">omm_out_of_plane_bend_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_out_of_plane_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba out-of-plane bend force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaOutOfPlaneBendForce</p>
<blockquote class="last">
<div><p>The out-of-plane bend Angle force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_pi_torsion_force">
<tt class="descname">omm_pi_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_pi_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba pi-torsion force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaPiTorsionForce</p>
<blockquote class="last">
<div><p>The pi-torsion force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_rb_torsion_force">
<tt class="descname">omm_rb_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_rb_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">RBTorsionForce</p>
<blockquote class="last">
<div><p>Or None if no torsions are present in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_set_virtual_sites">
<tt class="descname">omm_set_virtual_sites</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_set_virtual_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra
points defined in this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>system</strong> : mm.System</p>
<blockquote class="last">
<div><p>The system for which the virtual sites will be set. All particles
must have already been added to this System before calling this
method</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_stretch_bend_force">
<tt class="descname">omm_stretch_bend_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_stretch_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba stretch-bend force for this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaStretchBendForce</p>
<blockquote class="last">
<div><p>The stretch-bend force containing all terms in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_torsion_torsion_force">
<tt class="descname">omm_torsion_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_torsion_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba coupled-torsion (CMAP) force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaTorsionTorsionForce</p>
<blockquote class="last">
<div><p>The torsion-torsion (CMAP) force with all coupled-torsion parameters
for this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_trigonal_angle_force">
<tt class="descname">omm_trigonal_angle_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_trigonal_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba trigonal-angle force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaInPlaneAngleForce</p>
<blockquote class="last">
<div><p>The trigonal in-plane Angle force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.omm_urey_bradley_force">
<tt class="descname">omm_urey_bradley_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.omm_urey_bradley_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM Urey-Bradley force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HarmonicBondForce</p>
<blockquote class="last">
<div><p>Or None, if no urey-bradleys are present</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.ChamberParm.parse">
<em class="property">static </em><tt class="descname">parse</tt><big>(</big><em>filename</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Meant for use with the automatic file loader, this will automatically
return a subclass of AmberFormat corresponding to what the information
in the prmtop file contains (i.e., either an AmberParm, ChamberParm,
AmoebaParm, or AmberFormat)</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.positions">
<tt class="descname">positions</tt><a class="headerlink" href="#parmed.amber.ChamberParm.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of 3-element Quantity tuples of dimension length representing the
atomic positions for every atom in the system. If set with unitless
numbers, those numbers are assumed to be in angstroms. If any atoms do
not have coordinates, this is simply <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.prune_empty_terms">
<tt class="descname">prune_empty_terms</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.prune_empty_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks through all of the topological lists and gets rid of terms
in which at least one of the atoms is None or has an <cite>idx</cite> attribute set
to -1 (indicating that it has been removed from the <cite>atoms</cite> atom list)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.ptr">
<tt class="descname">ptr</tt><big>(</big><em>pointer</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.ptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the given pointer, and converts to upper-case so
it&#8217;s case-insensitive. A non-existent pointer meets with a KeyError</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pointer</strong> : str</p>
<blockquote>
<div><p>The AMBER pointer for which to extract the value</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The returned integer is the value of that pointer</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.rdparm">
<tt class="descname">rdparm</tt><big>(</big><em>fname</em>, <em>slow=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.rdparm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.rdparm_old">
<tt class="descname">rdparm_old</tt><big>(</big><em>prmtop_lines</em>, <em>check=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.rdparm_old" title="Permalink to this definition">¶</a></dt>
<dd><p>This reads an old-style topology file and stores the results in the
same data structures as a new-style topology file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prmtop_lines</strong> : list of str</p>
<blockquote>
<div><p>List of all lines in the prmtop file</p>
</div></blockquote>
<p><strong>check</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, only the first couple sections will be read to determine if
this is, in fact, an old-style topology file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.rdparm_slow">
<tt class="descname">rdparm_slow</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.rdparm_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file. This parser is written in pure Python and
is therefore slower than the C++-optimized version</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.recalculate_LJ">
<tt class="descname">recalculate_LJ</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.recalculate_LJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the values of the LJ_radius and LJ_depth arrays and recalculates
the LENNARD_JONES_A/BCOEF topology sections from the canonical
combining rules.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.rediscover_molecules">
<tt class="descname">rediscover_molecules</tt><big>(</big><em>solute_ions=True</em>, <em>fix_broken=True</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.rediscover_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>This determines the molecularity and sets the ATOMS_PER_MOLECULE and
SOLVENT_POINTERS sections of the prmtops. Returns the new atom sequence
in terms of the &#8216;old&#8217; atom indexes if re-ordering was necessary to fix
the tleap bug. Returns None otherwise.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.remake_parm">
<tt class="descname">remake_parm</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.remake_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> from the data in the parameter and topology
arrays (e.g., <tt class="xref py py-attr docutils literal"><span class="pre">atoms</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">bonds</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">bond_types</span></tt>, ...)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.save">
<tt class="descname">save</tt><big>(</big><em>fname</em>, <em>format=None</em>, <em>overwrite=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current Structure in the requested file format. Supported
formats can be specified explicitly or determined by file-name
extension. The following formats are supported, with the recognized
suffix and <tt class="docutils literal"><span class="pre">format</span></tt> keyword shown in parentheses:</p>
<blockquote>
<div><ul class="simple">
<li>PDB (.pdb, pdb)</li>
<li>PDBx/mmCIF (.cif, cif)</li>
<li>PQR (.pqr, pqr)</li>
<li>Amber topology file (.prmtop/.parm7, amber)</li>
<li>CHARMM PSF file (.psf, charmm)</li>
<li>CHARMM coordinate file (.crd, charmmcrd)</li>
<li>Gromacs topology file (.top, gromacs)</li>
<li>Gromacs GRO file (.gro, gro)</li>
<li>Mol2 file (.mol2, mol2)</li>
<li>Mol3 file (.mol3, mol3)</li>
<li>Amber ASCII restart (.rst7/.inpcrd/.restrt, rst7)</li>
<li>Amber NetCDF restart (.ncrst, ncrst)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>Name of the file to save. If <tt class="docutils literal"><span class="pre">format</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> (see below), the
file type will be determined based on the filename extension. If the
type cannot be determined, a ValueError is raised.</p>
</div></blockquote>
<p><strong>format</strong> : str, optional</p>
<blockquote>
<div><p>The case-insensitive keyword specifying what type of file <tt class="docutils literal"><span class="pre">fname</span></tt>
should be saved as. If <tt class="docutils literal"><span class="pre">None</span></tt> (default), the file type will be
determined from filename extension of <tt class="docutils literal"><span class="pre">fname</span></tt></p>
</div></blockquote>
<p><strong>overwrite</strong> : bool, optional</p>
<blockquote>
<div><p>If True, allow the target file to be overwritten. Otherwise, an
IOError is raised if the file exists. Default is False</p>
</div></blockquote>
<p><strong>kwargs</strong> : keyword-arguments</p>
<blockquote>
<div><p>Remaining arguments are passed on to the file writing routines that
are called by this function</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError if either filename extension or ``format`` are not recognized</strong></p>
<p><strong>TypeError if the structure cannot be converted to the desired format for</strong></p>
<p><strong>whatever reason</strong></p>
<p><strong>IOError if the file cannot be written either because it exists and</strong></p>
<p><strong>``overwrite`` is ``False``, the filesystem is read-only, or write</strong></p>
<p class="last"><strong>permissions are not granted for the user</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.set_version">
<tt class="descname">set_version</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.set_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the version string</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.split">
<tt class="descname">split</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the current Structure into separate Structure instances for each
unique molecule. A molecule is defined as all atoms connected by a graph
of covalent bonds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>[structs, counts]</strong> : list of (<tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt>, list) tuples</p>
<blockquote class="last">
<div><p>List of all molecules in the order that they appear first in the
parent structure accompanied by the list of the molecule numbers
in which that molecule appears in the Structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.strip">
<tt class="descname">strip</tt><big>(</big><em>selection</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a subset of the atoms corresponding to an atom-based selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>selection</strong> : AmberMask, str, or iterable of bool</p>
<blockquote class="last">
<div><p>This is the selection of atoms that will be deleted from this
structure. If it is a string, it will be interpreted as an
AmberMask. If it is an AmberMask, it will be converted to a
selection of atoms. If it is an iterable, it must be the same length
as the <cite>atoms</cite> list.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.to_dataframe">
<tt class="descname">to_dataframe</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a DataFrame from the current Structure&#8217;s atomic properties</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote class="last">
<div><p>DataFrame with all atomic properties</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.create_dataframe" title="parmed.utils.pandautils.create_dataframe"><tt class="xref py py-func docutils literal"><span class="pre">parmed.utils.pandautils.create_dataframe()</span></tt></a>, <tt class="xref py py-obj docutils literal"><span class="pre">documentation</span></tt></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.topology">
<tt class="descname">topology</tt><a class="headerlink" href="#parmed.amber.ChamberParm.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>The OpenMM Topology object. Cached when possible, but any changes to the
Structure instance results in the topology being deleted and rebuilt</p>
<p class="rubric">Notes</p>
<p>This function calls <tt class="docutils literal"><span class="pre">prune_empty_terms</span></tt> if any topology lists have
changed.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.unchange">
<tt class="descname">unchange</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.unchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggles all lists so that they do not indicate any changes</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.update_dihedral_exclusions">
<tt class="descname">update_dihedral_exclusions</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.update_dihedral_exclusions" title="Permalink to this definition">¶</a></dt>
<dd><p>Nonbonded exclusions and exceptions have the following priority:</p>
<p>bond -&gt; angle -&gt; dihedral</p>
<p>Since bonds and angles are completely excluded, any ring systems in
which two atoms are attached by a bond or angle as well as a dihedral
should be completely excluded as the bond and angle exclusion rules take
precedence.  If a Bond or Angle was _added_ to the structure between a
pair of atoms previously connected only by a dihedral term, it&#8217;s
possible that those two atoms have both an exclusion <em>and</em> an exception
defined. The result of this scenario is that sander and pmemd will
happily compute an energy, _including_ the 1-4 nonbonded terms between
atoms now connected by a bond or an Angle.  OpenMM, on the other hand,
will complain about an exception specified multiple times. This method
scans through all of the dihedrals in which <cite>ignore_end</cite> is <cite>False</cite> and
turns it to <cite>True</cite> if the two end atoms are in the bond or angle
partners arrays</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.ChamberParm.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>A (natom, 3)-shape numpy array with atomic velocities for every atom in
the system (in units of angstrom/picosecond), or None if there are no
velocities</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.vels">
<tt class="descname">vels</tt><a class="headerlink" href="#parmed.amber.ChamberParm.vels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.ChamberParm.view">
<tt class="descname">view</tt><a class="headerlink" href="#parmed.amber.ChamberParm.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an indexable object that can be indexed like a standard
Structure, but returns a <em>view</em> rather than a copy</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><tt class="xref py py-obj docutils literal"><span class="pre">Structure.__getitem__</span></tt></p>
</div>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.view_as">
<tt class="descname">view_as</tt><big>(</big><em>cls</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.view_as" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view of the current object as another object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : type</p>
<blockquote>
<div><p>Class definition of an AmberParm subclass for the current object to
be converted into</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of cls initialized from data in this object. This is NOT a deep</p>
<p>copy, so modifying the original object may modify this. The copy</p>
<p class="last">function will create a deep copy of any AmberFormat-derived object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.writeParm">
<tt class="descname">writeParm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.writeParm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.write_cif">
<tt class="descname">write_cif</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>renumber=True</em>, <em>coordinates=None</em>, <em>altlocs='all'</em>, <em>write_anisou=False</em>, <em>standard_resnames=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.write_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from the current Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The structure from which to write the PDBx/mmCIF file</p>
</div></blockquote>
<p><strong>dest</strong> : <tt class="docutils literal"><span class="pre">str</span> <span class="pre">or</span> <span class="pre">file-like</span></tt></p>
<blockquote>
<div><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</div></blockquote>
<p><strong>renumber</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously</p>
</div></blockquote>
<p><strong>coordinates</strong> : <tt class="docutils literal"><span class="pre">array-like</span> <span class="pre">of</span> <span class="pre">float</span></tt></p>
<blockquote>
<div><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the &#8220;original&#8221; PDB file if they
differ)</p>
</div></blockquote>
<p><strong>altlocs</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; : (default) print all alternate locations</li>
<li>&#8216;first&#8217; : print only the first alternate locations</li>
<li>&#8216;occupancy&#8217; : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</div></blockquote>
<p><strong>write_anisou</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written</p>
</div></blockquote>
<p><strong>standard_resnames</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.write_parm">
<tt class="descname">write_parm</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.write_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current data in parm_data into a new topology file with a
given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file to write the prmtop to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.write_pdb">
<tt class="descname">write_pdb</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>renumber=True</em>, <em>coordinates=None</em>, <em>altlocs='all'</em>, <em>write_anisou=False</em>, <em>charmm=False</em>, <em>standard_resnames=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.write_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from a Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The structure from which to write the PDB file</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</div></blockquote>
<p><strong>renumber</strong> : bool, optional</p>
<blockquote>
<div><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously. Default is True</p>
</div></blockquote>
<p><strong>coordinates</strong> : array-like of float, optional</p>
<blockquote>
<div><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the &#8220;original&#8221; PDB file if they
differ)</p>
</div></blockquote>
<p><strong>altlocs</strong> : str, optional</p>
<blockquote>
<div><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; : (default) print all alternate locations</li>
<li>&#8216;first&#8217; : print only the first alternate locations</li>
<li>&#8216;occupancy&#8217; : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</div></blockquote>
<p><strong>write_anisou</strong> : bool, optional</p>
<blockquote>
<div><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written. Default is False</p>
</div></blockquote>
<p><strong>charmm</strong> : bool, optional</p>
<blockquote>
<div><p>If True, SEGID will be written in columns 73 to 76 of the PDB file
in the typical CHARMM-style PDB output. This will be omitted for any
atom that does not contain a SEGID identifier. Default is False</p>
</div></blockquote>
<p><strong>standard_resnames</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.write_psf">
<tt class="descname">write_psf</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>vmd=False</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.write_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a PSF file from the stored molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The Structure instance from which the PSF should be written</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>The place to write the output PSF file.  If it has a &#8220;write&#8221;
attribute, it will be used to print the PSF file. Otherwise, it will
be treated like a string and a file will be opened, printed, then
closed</p>
</div></blockquote>
<p><strong>vmd</strong> : bool</p>
<blockquote class="last">
<div><p>If True, it will write out a PSF in the format that VMD prints it in
(i.e., no NUMLP/NUMLPH or MOLNT sections)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">CharmmPsfFile</span><span class="p">(</span><span class="s">&#39;testfiles/test.psf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">write_psf</span><span class="p">(</span><span class="s">&#39;testfiles/test2.psf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.ChamberParm.write_rst7">
<tt class="descname">write_rst7</tt><big>(</big><em>name</em>, <em>netcdf=None</em><big>)</big><a class="headerlink" href="#parmed.amber.ChamberParm.write_rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a restart file with the current coordinates and velocities and
box info if it&#8217;s present</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote>
<div><p>Name of the file to write the restart file to</p>
</div></blockquote>
<p><strong>netcdf</strong> : bool=False</p>
<blockquote class="last">
<div><p>If True, write a NetCDF-format restart file (requires a NetCDF
backend; scipy, netCDF4, or ScientificPython; to be installed)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If <cite>netcdf</cite> is not specified and the filename extension given by <cite>name</cite>
is <cite>.ncrst</cite>, the a NetCDF restart file will be written. However, an
explicit value for <cite>netcdf</cite> will override any filename extensions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.AmoebaParm">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">AmoebaParm</tt><big>(</big><em>prm_name=None</em>, <em>xyz=None</em>, <em>box=None</em>, <em>rst7_name=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">parmed.amber._amberparm.AmberParm</span></tt></p>
<p>Tinker Topology (parm7 format) class defining the AMOEBA force field. Gives
low, and some high, level access to topology data.  You can interact with
the raw data in the topology file directly or interact with some of the
high-level classes comprising the system topology and parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prm_name</strong> : str=None</p>
<blockquote>
<div><p>If provided, this file is parsed and the data structures will be loaded
from the data in this file</p>
</div></blockquote>
<p><strong>rst7_name</strong> : str=None</p>
<blockquote class="last">
<div><p>If provided, the coordinates and unit cell dimensions from the provided
Amber inpcrd/restart file will be loaded into the molecule</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.bonds_inc_h" title="parmed.amber.AmoebaParm.bonds_inc_h"><tt class="xref py py-obj docutils literal"><span class="pre">bonds_inc_h</span></tt></a></td>
<td>All bonds with at least one atom being hydrogen</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.bonds_without_h" title="parmed.amber.AmoebaParm.bonds_without_h"><tt class="xref py py-obj docutils literal"><span class="pre">bonds_without_h</span></tt></a></td>
<td>All bonds in which neither atom is hydrogen</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.angles_inc_h" title="parmed.amber.AmoebaParm.angles_inc_h"><tt class="xref py py-obj docutils literal"><span class="pre">angles_inc_h</span></tt></a></td>
<td>All angles in which at least one atom is hydrogen</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.angles_without_h" title="parmed.amber.AmoebaParm.angles_without_h"><tt class="xref py py-obj docutils literal"><span class="pre">angles_without_h</span></tt></a></td>
<td>All angles in which no atom is hydrogen</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.dihedrals_inc_h" title="parmed.amber.AmoebaParm.dihedrals_inc_h"><tt class="xref py py-obj docutils literal"><span class="pre">dihedrals_inc_h</span></tt></a></td>
<td>All dihedrals in which at least one atom is hydrogen</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.dihedrals_without_h" title="parmed.amber.AmoebaParm.dihedrals_without_h"><tt class="xref py py-obj docutils literal"><span class="pre">dihedrals_without_h</span></tt></a></td>
<td>All dihedrals in which no atom is hydrogen</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.has_cmap" title="parmed.amber.AmoebaParm.has_cmap"><tt class="xref py py-obj docutils literal"><span class="pre">has_cmap</span></tt></a></td>
<td>Whether this instance has correction map terms or not</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>parm_data</td>
<td>(dict {str) A dictionary that maps FLAG names to all of the data contained in that section of the Amber file.</td>
</tr>
<tr class="row-even"><td>formats</td>
<td>(dict {str) A dictionary that maps FLAG names to the FortranFormat instance in which the data is stored in that section</td>
</tr>
<tr class="row-odd"><td>parm_comments</td>
<td>(dict {str) A dictionary that maps FLAG names to the list of COMMENT lines that were stored in the original file</td>
</tr>
<tr class="row-even"><td>flag_list</td>
<td>(list) An ordered list of all FLAG names. This must be kept synchronized with <cite>parm_data</cite>, <cite>formats</cite>, and <cite>parm_comments</cite> such that every item in <cite>flag_list</cite> is a key to those 3 dicts and no other keys exist</td>
</tr>
<tr class="row-odd"><td>version</td>
<td>(str) The VERSION string from the Amber file</td>
</tr>
<tr class="row-even"><td>name</td>
<td>(str) The file name of the originally parsed file (set to the fname parameter)</td>
</tr>
<tr class="row-odd"><td>atoms</td>
<td>(AtomList(Atom)) List of all atoms in the system</td>
</tr>
<tr class="row-even"><td>residues</td>
<td>(ResidueList(Residue)) List of all residues in the system</td>
</tr>
<tr class="row-odd"><td>bonds</td>
<td>(TrackedList(Bond)) List of bonds between two atoms in the system</td>
</tr>
<tr class="row-even"><td>angles</td>
<td>(TrackedList(Angle)) List of regular angles between three atoms in the system</td>
</tr>
<tr class="row-odd"><td>dihedrals</td>
<td>(TrackedList(Angle)) List of all proper torsions between 4 atoms in the system</td>
</tr>
<tr class="row-even"><td>urey_bradleys</td>
<td>(TrackedList(UreyBradley)) List of all Urey-Bradley terms between 2 atoms connected by an angle</td>
</tr>
<tr class="row-odd"><td>trigonal_angles</td>
<td>(TrackedList(TrigonalAngle)) List of all trigonal angle terms</td>
</tr>
<tr class="row-even"><td>out_of_plane_bends</td>
<td>(TrackedList(OutOfPlaneBend)) List of all out-of-plane bending terms</td>
</tr>
<tr class="row-odd"><td>pi_torsions</td>
<td>(TrackedList(PiTorsion)) List of all pi-torsion terms</td>
</tr>
<tr class="row-even"><td>stretch_bends</td>
<td>(TrackedList(StretchBend)) List of all stretch-bending terms</td>
</tr>
<tr class="row-odd"><td>torsion_torsions</td>
<td>(TrackedList(TorsionTorsion)) List of all coupled torsion-torsion terms</td>
</tr>
<tr class="row-even"><td>chiral_frames</td>
<td>(TrackedList(ChiralFrame)) List of all chiral centers</td>
</tr>
<tr class="row-odd"><td>multipole_frames</td>
<td>(TrackedList(MultipoleFrame)) List of all multipole frames of reference</td>
</tr>
<tr class="row-even"><td>adjusts</td>
<td>(TrackedList(NonbondedException)) List of all nonbonded exception parameters used for adjusting nonbonded interactions between particular pairs of atoms</td>
</tr>
<tr class="row-odd"><td>box</td>
<td>(list of 6 floats) Periodic boundary unit cell dimensions and angles</td>
</tr>
<tr class="row-even"><td>bond_types</td>
<td>(TrackedList(BondType)) The bond types containing the parameters for each bond stretching term</td>
</tr>
<tr class="row-odd"><td>angle_types</td>
<td>(TrackedList(AngleType)) The angle types containing the parameters for each angle bending term</td>
</tr>
<tr class="row-even"><td>dihedral_types</td>
<td>(TrackedList(DihedralType)) The dihedral types containing the parameters for each torsional term</td>
</tr>
<tr class="row-odd"><td>urey_bradley_types</td>
<td>(TrackedList(BondType)) The Urey-Bradley types containing the parameters for each term</td>
</tr>
<tr class="row-even"><td>trigonal_angle_types</td>
<td>(TrackedList(AngleType)) The trigonal angle types containing the parameters for each term</td>
</tr>
<tr class="row-odd"><td>out_of_plane_bend_types</td>
<td>(TrackedList(AngleType)) The out-of-plane bending angle type containing parameters for each term</td>
</tr>
<tr class="row-even"><td>pi_torsion_types</td>
<td>(TrackedList(DihedralType)) The pi-torsion type containing parameters for each torsional term</td>
</tr>
<tr class="row-odd"><td>stretch_bend_types</td>
<td>(TrackedList(StretchBendType)) The stretch-bend type containing parameters for each term</td>
</tr>
<tr class="row-even"><td>torsion_torsion_types</td>
<td>(TrackedList(TorsionTorsionType)) The coupled torsion-torsion type containing parameters for coupled torsions</td>
</tr>
<tr class="row-odd"><td>adjust_types</td>
<td>(TrackedList(NonbondedExceptionType)) The nonbonded exception scaling factors for pairs of particles</td>
</tr>
<tr class="row-even"><td>chamber</td>
<td>(bool=False) On AmberParm instances, this is always False to indicate that it is not a CHAMBER-style topology file</td>
</tr>
<tr class="row-odd"><td>amoeba</td>
<td>(bool=False) On AmberParm instances, this is always False to indicate that it is not an AMOEBA-style topology file</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.addFlag" title="parmed.amber.AmoebaParm.addFlag"><tt class="xref py py-obj docutils literal"><span class="pre">addFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.add_atom" title="parmed.amber.AmoebaParm.add_atom"><tt class="xref py py-obj docutils literal"><span class="pre">add_atom</span></tt></a>(atom,&nbsp;resname,&nbsp;resnum[,&nbsp;chain,&nbsp;...])</td>
<td>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if it has a different name or number as the last residue added and adding it to the <cite>atoms</cite> list.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.add_atom_to_residue" title="parmed.amber.AmoebaParm.add_atom_to_residue"><tt class="xref py py-obj docutils literal"><span class="pre">add_atom_to_residue</span></tt></a>(atom,&nbsp;residue)</td>
<td>Adds a new atom to the Structure at the end if the given residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.add_flag" title="parmed.amber.AmoebaParm.add_flag"><tt class="xref py py-obj docutils literal"><span class="pre">add_flag</span></tt></a>(flag_name,&nbsp;flag_format[,&nbsp;data,&nbsp;...])</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.copy" title="parmed.amber.AmoebaParm.copy"><tt class="xref py py-obj docutils literal"><span class="pre">copy</span></tt></a>(cls[,&nbsp;split_dihedrals])</td>
<td>Makes a copy of the current structure as an instance of a specified</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.createSystem" title="parmed.amber.AmoebaParm.createSystem"><tt class="xref py py-obj docutils literal"><span class="pre">createSystem</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Construct an OpenMM System representing the topology described by the prmtop file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.deleteFlag" title="parmed.amber.AmoebaParm.deleteFlag"><tt class="xref py py-obj docutils literal"><span class="pre">deleteFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.delete_flag" title="parmed.amber.AmoebaParm.delete_flag"><tt class="xref py py-obj docutils literal"><span class="pre">delete_flag</span></tt></a>(flag_name)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.fill_LJ" title="parmed.amber.AmoebaParm.fill_LJ"><tt class="xref py py-obj docutils literal"><span class="pre">fill_LJ</span></tt></a>()</td>
<td>Calculates the Lennard-Jones parameters (Rmin/2 and epsilon) for each atom type by computing their values from the A and B coefficients of each atom interacting with itself.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.from_rawdata" title="parmed.amber.AmoebaParm.from_rawdata"><tt class="xref py py-obj docutils literal"><span class="pre">from_rawdata</span></tt></a>(rawdata)</td>
<td>Take the raw data from a AmberFormat object and initialize an AmberParm from that data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.from_structure" title="parmed.amber.AmoebaParm.from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">from_structure</span></tt></a>(struct[,&nbsp;copy])</td>
<td>Take a Structure instance and initialize an AmberParm instance from that data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.get_coordinates" title="parmed.amber.AmoebaParm.get_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">get_coordinates</span></tt></a>([frame])</td>
<td>In some cases, multiple conformations may be stored in the Structure.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.has_1012" title="parmed.amber.AmoebaParm.has_1012"><tt class="xref py py-obj docutils literal"><span class="pre">has_1012</span></tt></a>()</td>
<td>This routine determines whether there are any defined 10-12</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.has_NBFIX" title="parmed.amber.AmoebaParm.has_NBFIX"><tt class="xref py py-obj docutils literal"><span class="pre">has_NBFIX</span></tt></a>()</td>
<td>This routine determines whether there are any off-diagonal Lennard-Jones modifications (i.e., if any two atoms have a L-J pair interaction that does not match the combined L-J parameters for that pair).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.id_format" title="parmed.amber.AmoebaParm.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as either Amber-format file (like prmtop) or an old-style topology file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.initialize_topology" title="parmed.amber.AmoebaParm.initialize_topology"><tt class="xref py py-obj docutils literal"><span class="pre">initialize_topology</span></tt></a>([xyz,&nbsp;box])</td>
<td>Initializes topology data structures, like the list of atoms, bonds, etc., after the topology file has been read.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.is_changed" title="parmed.amber.AmoebaParm.is_changed"><tt class="xref py py-obj docutils literal"><span class="pre">is_changed</span></tt></a>()</td>
<td>Determines if any of the topological arrays have changed since the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_atom_info" title="parmed.amber.AmoebaParm.load_atom_info"><tt class="xref py py-obj docutils literal"><span class="pre">load_atom_info</span></tt></a>()</td>
<td>Loads atom properties into the atoms that have been loaded.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_coordinates" title="parmed.amber.AmoebaParm.load_coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">load_coordinates</span></tt></a>(coords)</td>
<td>Loads the coordinates into the atom list</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_dataframe" title="parmed.amber.AmoebaParm.load_dataframe"><tt class="xref py py-obj docutils literal"><span class="pre">load_dataframe</span></tt></a>(df)</td>
<td>Loads atomic properties from an input DataFrame</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_from_rawdata" title="parmed.amber.AmoebaParm.load_from_rawdata"><tt class="xref py py-obj docutils literal"><span class="pre">load_from_rawdata</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_from_structure" title="parmed.amber.AmoebaParm.load_from_structure"><tt class="xref py py-obj docutils literal"><span class="pre">load_from_structure</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_pointers" title="parmed.amber.AmoebaParm.load_pointers"><tt class="xref py py-obj docutils literal"><span class="pre">load_pointers</span></tt></a>()</td>
<td>Loads the data in POINTERS section into a pointers dictionary with each</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_rst7" title="parmed.amber.AmoebaParm.load_rst7"><tt class="xref py py-obj docutils literal"><span class="pre">load_rst7</span></tt></a>(rst7)</td>
<td>Loads coordinates into the AmberParm class</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_structure" title="parmed.amber.AmoebaParm.load_structure"><tt class="xref py py-obj docutils literal"><span class="pre">load_structure</span></tt></a>()</td>
<td>Loads all of the topology instance variables.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.load_velocities" title="parmed.amber.AmoebaParm.load_velocities"><tt class="xref py py-obj docutils literal"><span class="pre">load_velocities</span></tt></a>(vels)</td>
<td>Loads the coordinates into the atom list</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.mdin_skeleton" title="parmed.amber.AmoebaParm.mdin_skeleton"><tt class="xref py py-obj docutils literal"><span class="pre">mdin_skeleton</span></tt></a>()</td>
<td>Returns the skeleton of an mdin file with the &amp;amoeba namelist set up correctly for the potential terms that are present in this topology file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_add_constraints" title="parmed.amber.AmoebaParm.omm_add_constraints"><tt class="xref py py-obj docutils literal"><span class="pre">omm_add_constraints</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds constraints to a given system</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_angle_force" title="parmed.amber.AmoebaParm.omm_angle_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_angle_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_bond_force" title="parmed.amber.AmoebaParm.omm_bond_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_bond_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_cmap_force" title="parmed.amber.AmoebaParm.omm_cmap_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_cmap_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM CMAP torsion force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_dihedral_force" title="parmed.amber.AmoebaParm.omm_dihedral_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_dihedral_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_gbsa_force" title="parmed.amber.AmoebaParm.omm_gbsa_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_gbsa_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates a Generalized Born force for running implicit solvent</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_improper_force" title="parmed.amber.AmoebaParm.omm_improper_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_improper_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM improper torsion force (quadratic bias)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_nonbonded_force" title="parmed.amber.AmoebaParm.omm_nonbonded_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_nonbonded_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM NonbondedForce (and CustomNonbondedForce if necessary) to define the nonbonded interatomic potential for this system.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_out_of_plane_bend_force" title="parmed.amber.AmoebaParm.omm_out_of_plane_bend_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_out_of_plane_bend_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba out-of-plane bend force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_pi_torsion_force" title="parmed.amber.AmoebaParm.omm_pi_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_pi_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba pi-torsion force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_rb_torsion_force" title="parmed.amber.AmoebaParm.omm_rb_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_rb_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_set_virtual_sites" title="parmed.amber.AmoebaParm.omm_set_virtual_sites"><tt class="xref py py-obj docutils literal"><span class="pre">omm_set_virtual_sites</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_stretch_bend_force" title="parmed.amber.AmoebaParm.omm_stretch_bend_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_stretch_bend_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Create the OpenMM Amoeba stretch-bend force for this system</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_torsion_torsion_force" title="parmed.amber.AmoebaParm.omm_torsion_torsion_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_torsion_torsion_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Create the OpenMM Amoeba coupled-torsion (CMAP) force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_trigonal_angle_force" title="parmed.amber.AmoebaParm.omm_trigonal_angle_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_trigonal_angle_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the Amoeba trigonal-angle force</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.omm_urey_bradley_force" title="parmed.amber.AmoebaParm.omm_urey_bradley_force"><tt class="xref py py-obj docutils literal"><span class="pre">omm_urey_bradley_force</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Creates the OpenMM Urey-Bradley force</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.parse" title="parmed.amber.AmoebaParm.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(filename,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Meant for use with the automatic file loader, this will automatically</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.prune_empty_terms" title="parmed.amber.AmoebaParm.prune_empty_terms"><tt class="xref py py-obj docutils literal"><span class="pre">prune_empty_terms</span></tt></a>()</td>
<td>Looks through all of the topological lists and gets rid of terms</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.ptr" title="parmed.amber.AmoebaParm.ptr"><tt class="xref py py-obj docutils literal"><span class="pre">ptr</span></tt></a>(pointer)</td>
<td>Returns the value of the given pointer, and converts to upper-case so it&#8217;s case-insensitive.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.rdparm" title="parmed.amber.AmoebaParm.rdparm"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm</span></tt></a>(fname[,&nbsp;slow])</td>
<td>Parses the Amber format file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.rdparm_old" title="parmed.amber.AmoebaParm.rdparm_old"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_old</span></tt></a>(prmtop_lines[,&nbsp;check])</td>
<td>This reads an old-style topology file and stores the results in the</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.rdparm_slow" title="parmed.amber.AmoebaParm.rdparm_slow"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_slow</span></tt></a>(fname)</td>
<td>Parses the Amber format file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.recalculate_LJ" title="parmed.amber.AmoebaParm.recalculate_LJ"><tt class="xref py py-obj docutils literal"><span class="pre">recalculate_LJ</span></tt></a>()</td>
<td>Fills the <tt class="docutils literal"><span class="pre">LENNARD_JONES_ACOEF</span></tt> and <tt class="docutils literal"><span class="pre">LENNARD_JONES_BCOEF</span></tt> arrays in the <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> raw data dictionary by applying the canonical Lorentz-Berthelot combining rules to the values in <tt class="xref py py-attr docutils literal"><span class="pre">LJ_radius</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">LJ_depth</span></tt>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.rediscover_molecules" title="parmed.amber.AmoebaParm.rediscover_molecules"><tt class="xref py py-obj docutils literal"><span class="pre">rediscover_molecules</span></tt></a>([solute_ions,&nbsp;fix_broken])</td>
<td>This determines the molecularity and sets the ATOMS_PER_MOLECULE and SOLVENT_POINTERS sections of the prmtops.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.remake_parm" title="parmed.amber.AmoebaParm.remake_parm"><tt class="xref py py-obj docutils literal"><span class="pre">remake_parm</span></tt></a>()</td>
<td>Recomputes the topology file parameters and fills parm_data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.save" title="parmed.amber.AmoebaParm.save"><tt class="xref py py-obj docutils literal"><span class="pre">save</span></tt></a>(fname[,&nbsp;format,&nbsp;overwrite])</td>
<td>Saves the current Structure in the requested file format.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.set_version" title="parmed.amber.AmoebaParm.set_version"><tt class="xref py py-obj docutils literal"><span class="pre">set_version</span></tt></a>()</td>
<td>Sets the version string</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.split" title="parmed.amber.AmoebaParm.split"><tt class="xref py py-obj docutils literal"><span class="pre">split</span></tt></a>()</td>
<td>Split the current Structure into separate Structure instances for each unique molecule.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.strip" title="parmed.amber.AmoebaParm.strip"><tt class="xref py py-obj docutils literal"><span class="pre">strip</span></tt></a>(selection)</td>
<td>Deletes a subset of the atoms corresponding to an atom-based selection.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.to_dataframe" title="parmed.amber.AmoebaParm.to_dataframe"><tt class="xref py py-obj docutils literal"><span class="pre">to_dataframe</span></tt></a>()</td>
<td>Generates a DataFrame from the current Structure&#8217;s atomic properties</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.unchange" title="parmed.amber.AmoebaParm.unchange"><tt class="xref py py-obj docutils literal"><span class="pre">unchange</span></tt></a>()</td>
<td>Toggles all lists so that they do not indicate any changes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.update_dihedral_exclusions" title="parmed.amber.AmoebaParm.update_dihedral_exclusions"><tt class="xref py py-obj docutils literal"><span class="pre">update_dihedral_exclusions</span></tt></a>()</td>
<td>Nonbonded exclusions and exceptions have the following priority:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.view_as" title="parmed.amber.AmoebaParm.view_as"><tt class="xref py py-obj docutils literal"><span class="pre">view_as</span></tt></a>(cls)</td>
<td>Returns a view of the current object as another object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.writeParm" title="parmed.amber.AmoebaParm.writeParm"><tt class="xref py py-obj docutils literal"><span class="pre">writeParm</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.write_cif" title="parmed.amber.AmoebaParm.write_cif"><tt class="xref py py-obj docutils literal"><span class="pre">write_cif</span></tt></a>(struct,&nbsp;dest[,&nbsp;renumber,&nbsp;...])</td>
<td>Write a PDB file from the current Structure instance</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.write_parm" title="parmed.amber.AmoebaParm.write_parm"><tt class="xref py py-obj docutils literal"><span class="pre">write_parm</span></tt></a>(name)</td>
<td>Writes the current data in parm_data into a new topology file with a given name.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.write_pdb" title="parmed.amber.AmoebaParm.write_pdb"><tt class="xref py py-obj docutils literal"><span class="pre">write_pdb</span></tt></a>(struct,&nbsp;dest[,&nbsp;renumber,&nbsp;...])</td>
<td>Write a PDB file from a Structure instance</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.write_psf" title="parmed.amber.AmoebaParm.write_psf"><tt class="xref py py-obj docutils literal"><span class="pre">write_psf</span></tt></a>(struct,&nbsp;dest[,&nbsp;vmd])</td>
<td>Writes a PSF file from the stored molecule</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.AmoebaParm.write_rst7" title="parmed.amber.AmoebaParm.write_rst7"><tt class="xref py py-obj docutils literal"><span class="pre">write_rst7</span></tt></a>(name[,&nbsp;netcdf])</td>
<td>Writes a restart file with the current coordinates and velocities and</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.ANGLE_FORCE_GROUP">
<tt class="descname">ANGLE_FORCE_GROUP</tt><em class="property"> = 1</em><a class="headerlink" href="#parmed.amber.AmoebaParm.ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.BOND_FORCE_GROUP">
<tt class="descname">BOND_FORCE_GROUP</tt><em class="property"> = 0</em><a class="headerlink" href="#parmed.amber.AmoebaParm.BOND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.CMAP_FORCE_GROUP">
<tt class="descname">CMAP_FORCE_GROUP</tt><em class="property"> = 5</em><a class="headerlink" href="#parmed.amber.AmoebaParm.CMAP_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.DIHEDRAL_FORCE_GROUP">
<tt class="descname">DIHEDRAL_FORCE_GROUP</tt><em class="property"> = 2</em><a class="headerlink" href="#parmed.amber.AmoebaParm.DIHEDRAL_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.IMPROPER_FORCE_GROUP">
<tt class="descname">IMPROPER_FORCE_GROUP</tt><em class="property"> = 4</em><a class="headerlink" href="#parmed.amber.AmoebaParm.IMPROPER_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.NONBONDED_FORCE_GROUP">
<tt class="descname">NONBONDED_FORCE_GROUP</tt><em class="property"> = 11</em><a class="headerlink" href="#parmed.amber.AmoebaParm.NONBONDED_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.OUT_OF_PLANE_BEND_FORCE_GROUP">
<tt class="descname">OUT_OF_PLANE_BEND_FORCE_GROUP</tt><em class="property"> = 7</em><a class="headerlink" href="#parmed.amber.AmoebaParm.OUT_OF_PLANE_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.PI_TORSION_FORCE_GROUP">
<tt class="descname">PI_TORSION_FORCE_GROUP</tt><em class="property"> = 8</em><a class="headerlink" href="#parmed.amber.AmoebaParm.PI_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.RB_TORSION_FORCE_GROUP">
<tt class="descname">RB_TORSION_FORCE_GROUP</tt><em class="property"> = 12</em><a class="headerlink" href="#parmed.amber.AmoebaParm.RB_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.STRETCH_BEND_FORCE_GROUP">
<tt class="descname">STRETCH_BEND_FORCE_GROUP</tt><em class="property"> = 9</em><a class="headerlink" href="#parmed.amber.AmoebaParm.STRETCH_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.TORSION_TORSION_FORCE_GROUP">
<tt class="descname">TORSION_TORSION_FORCE_GROUP</tt><em class="property"> = 10</em><a class="headerlink" href="#parmed.amber.AmoebaParm.TORSION_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.TRIGONAL_ANGLE_FORCE_GROUP">
<tt class="descname">TRIGONAL_ANGLE_FORCE_GROUP</tt><em class="property"> = 6</em><a class="headerlink" href="#parmed.amber.AmoebaParm.TRIGONAL_ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.UREY_BRADLEY_FORCE_GROUP">
<tt class="descname">UREY_BRADLEY_FORCE_GROUP</tt><em class="property"> = 3</em><a class="headerlink" href="#parmed.amber.AmoebaParm.UREY_BRADLEY_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.addFlag">
<tt class="descname">addFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.addFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.add_atom">
<tt class="descname">add_atom</tt><big>(</big><em>atom</em>, <em>resname</em>, <em>resnum</em>, <em>chain=''</em>, <em>inscode=''</em>, <em>segid=''</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if
it has a different name or number as the last residue added and adding
it to the <cite>atoms</cite> list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></p>
<blockquote>
<div><p>The atom to add to this residue list</p>
</div></blockquote>
<p><strong>resname</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The name of the residue this atom belongs to</p>
</div></blockquote>
<p><strong>resnum</strong> : <tt class="docutils literal"><span class="pre">int</span></tt></p>
<blockquote>
<div><p>The number of the residue this atom belongs to</p>
</div></blockquote>
<p><strong>chain</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The chain ID character for this residue</p>
</div></blockquote>
<p><strong>inscode</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The insertion code ID character for this residue (it is stripped)</p>
</div></blockquote>
<p><strong>segid</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote class="last">
<div><p>The segment identifier for this residue (it is stripped)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the residue name and number differ from the last residue in this
list, a new residue is added and the atom is added to that residue</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.add_atom_to_residue">
<tt class="descname">add_atom_to_residue</tt><big>(</big><em>atom</em>, <em>residue</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.add_atom_to_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure at the end if the given residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></p>
<blockquote>
<div><p>The atom to add to the system</p>
</div></blockquote>
<p><strong>residue</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></p>
<blockquote class="last">
<div><p>The residue to which to add this atom. It MUST be part of this
Structure instance already or a ValueError is raised</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This atom is added at the end of the residue and is inserted into the
<cite>atoms</cite> list in such a way that all residues are composed of atoms
contiguous in the atoms list. For large systems, this may be a
relatively expensive operation</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.add_flag">
<tt class="descname">add_flag</tt><big>(</big><em>flag_name</em>, <em>flag_format</em>, <em>data=None</em>, <em>num_items=-1</em>, <em>comments=None</em>, <em>after=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.add_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.amoeba">
<tt class="descname">amoeba</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.amoeba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.angles_inc_h">
<tt class="descname">angles_inc_h</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.angles_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All angles in which at least one atom is hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.angles_without_h">
<tt class="descname">angles_without_h</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.angles_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All angles in which no atom is hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.bonds_inc_h">
<tt class="descname">bonds_inc_h</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.bonds_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All bonds with at least one atom being hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.bonds_without_h">
<tt class="descname">bonds_without_h</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.bonds_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All bonds in which neither atom is hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.box_vectors">
<tt class="descname">box_vectors</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.box_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>3, 3-element tuple of unit cell vectors that are Quantity objects of
dimension length</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.chamber">
<tt class="descname">chamber</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.chamber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.combining_rule">
<tt class="descname">combining_rule</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.combining_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.coords">
<tt class="descname">coords</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.copy">
<tt class="descname">copy</tt><big>(</big><em>cls</em>, <em>split_dihedrals=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a copy of the current structure as an instance of a specified
subclass</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : Structure subclass</p>
<blockquote>
<div><p>The returned object is a copy of this structure as a <cite>cls</cite> instance</p>
</div></blockquote>
<p><strong>split_dihedrals</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, then the Dihedral entries will be split up so that each one
is paired with a single DihedralType (rather than a
DihedralTypeList)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><em>cls</em> instance</p>
<blockquote class="last">
<div><p>The instance of the Structure subclass <cite>cls</cite> with a copy of the
current Structure&#8217;s topology information</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.createSystem">
<tt class="descname">createSystem</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.createSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an OpenMM System representing the topology described by the
prmtop file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</div></blockquote>
<p><strong>switchDistance</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</div></blockquote>
<p><strong>constraints</strong> : None, app.HBonds, app.HAngles, or app.AllBonds</p>
<blockquote>
<div><p>Which type of constraints to add to the system (e.g., SHAKE). None
means no bonds are constrained. HBonds means bonds with hydrogen are
constrained</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool=True</p>
<blockquote>
<div><p>If True, water is kept rigid regardless of the value of constraints.
A value of False is ignored if constraints is not None.</p>
</div></blockquote>
<p><strong>implicitSolvent</strong> : None, app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</p>
<blockquote>
<div><p>The Generalized Born implicit solvent model to use.</p>
</div></blockquote>
<p><strong>implicitSolventKappa</strong> : float or 1/distance Quantity = None</p>
<blockquote>
<div><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</div></blockquote>
<p><strong>implicitSolventSaltConc</strong> : float or amount/volume Quantity=0 moles/liter</p>
<blockquote>
<div><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</div></blockquote>
<p><strong>temperature</strong> : float or temperature Quantity = 298.15 kelvin</p>
<blockquote>
<div><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</div></blockquote>
<p><strong>soluteDielectric</strong> : float=1.0</p>
<blockquote>
<div><p>The dielectric constant of the protein interior used in GB</p>
</div></blockquote>
<p><strong>solventDielectric</strong> : float=78.5</p>
<blockquote>
<div><p>The dielectric constant of the water used in GB</p>
</div></blockquote>
<p><strong>useSASA</strong> : bool=False</p>
<blockquote>
<div><p>If True, use the ACE non-polar solvation model. Otherwise, use no
SASA-based nonpolar solvation model.</p>
</div></blockquote>
<p><strong>removeCMMotion</strong> : bool=True</p>
<blockquote>
<div><p>If True, the center-of-mass motion will be removed periodically
during the simulation. If False, it will not.</p>
</div></blockquote>
<p><strong>hydrogenMass</strong> : float or mass quantity = None</p>
<blockquote>
<div><p>If not None, hydrogen masses will be changed to this mass and the
difference subtracted from the attached heavy atom (hydrogen mass
repartitioning)</p>
</div></blockquote>
<p><strong>ewaldErrorTolerance</strong> : float=0.0005</p>
<blockquote>
<div><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If False, the energies and forces from the constrained degrees of
freedom will NOT be computed. If True, they will (but those degrees
of freedom will <em>still</em> be constrained).</p>
</div></blockquote>
<p><strong>verbose</strong> : bool=False</p>
<blockquote class="last">
<div><p>If True, the progress of this subroutine will be printed to stdout</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function calls prune_empty_terms if any Topology lists have changed</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.deleteFlag">
<tt class="descname">deleteFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.deleteFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.delete_flag">
<tt class="descname">delete_flag</tt><big>(</big><em>flag_name</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.delete_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.dihedrals_inc_h">
<tt class="descname">dihedrals_inc_h</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.dihedrals_inc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All dihedrals in which at least one atom is hydrogen</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.dihedrals_without_h">
<tt class="descname">dihedrals_without_h</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.dihedrals_without_h" title="Permalink to this definition">¶</a></dt>
<dd><p>All dihedrals in which no atom is hydrogen</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.fill_LJ">
<tt class="descname">fill_LJ</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.fill_LJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Lennard-Jones parameters (Rmin/2 and epsilon) for each
atom type by computing their values from the A and B coefficients of
each atom interacting with itself.</p>
<p>This fills the <tt class="xref py py-attr docutils literal"><span class="pre">LJ_radius</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">LJ_depth</span></tt>, and <tt class="xref py py-attr docutils literal"><span class="pre">LJ_types</span></tt>
data structures.</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmoebaParm.from_rawdata">
<em class="property">classmethod </em><tt class="descname">from_rawdata</tt><big>(</big><em>rawdata</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.from_rawdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the raw data from a AmberFormat object and initialize an AmberParm
from that data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rawdata</strong> : <a class="reference internal" href="#parmed.amber.AmberFormat" title="parmed.amber.AmberFormat"><tt class="xref py py-class docutils literal"><span class="pre">AmberFormat</span></tt></a></p>
<blockquote>
<div><p>An AmberFormat instance that has already been instantiated</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>parm</strong> : <a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a></p>
<blockquote class="last">
<div><p>An instance of this type from the data in rawdata</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmoebaParm.from_structure">
<em class="property">classmethod </em><tt class="descname">from_structure</tt><big>(</big><em>struct</em>, <em>copy=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a Structure instance and initialize an AmberParm instance from that
data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The input structure from which to construct an AmberParm instance</p>
</div></blockquote>
<p><strong>copy</strong> : bool</p>
<blockquote>
<div><p>If True, the input struct is deep-copied to make sure it does not
share any objects with the original <tt class="docutils literal"><span class="pre">struct</span></tt>. Default is False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>inst</strong> : <a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a></p>
<blockquote>
<div><p>The AmberParm instance derived from the input structure</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>TypeError</strong></p>
<blockquote class="last">
<div><p>If the structure has parameters not supported by the standard Amber
force field (i.e., standard bond, angle, and dihedral types)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Due to the nature of the prmtop file, struct almost <em>always</em> returns a
deep copy. The one exception is when struct is already of type
<a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a>, in which case the original object is returned unless
<tt class="docutils literal"><span class="pre">copy</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.get_coordinates">
<tt class="descname">get_coordinates</tt><big>(</big><em>frame='all'</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.get_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>In some cases, multiple conformations may be stored in the Structure.
This function retrieves a particular frame&#8217;s coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>frame</strong> : int or &#8216;all&#8217;, optional</p>
<blockquote>
<div><p>The frame number whose coordinates should be retrieved. Default is
&#8216;all&#8217;</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> : np.ndarray, shape([#,] natom, 3) or None</p>
<blockquote>
<div><p>If frame is &#8216;all&#8217;, all coordinates are returned with shape
(#, natom, 3). Otherwise the requested frame is returned with shape
(natom, 3). If no coordinates exist and &#8216;all&#8217; is requested, None is
returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>IndexError if there are fewer than ``frame`` coordinates</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.has_1012">
<tt class="descname">has_1012</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.has_1012" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine determines whether there are any defined 10-12
Lennard-Jones interactions that are non-zero</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>has_10_12</strong> : bool</p>
<blockquote class="last">
<div><p>If True, 10-12 interactions <em>are</em> defined for this particular system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.has_NBFIX">
<tt class="descname">has_NBFIX</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.has_NBFIX" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine determines whether there are any off-diagonal Lennard-Jones
modifications (i.e., if any two atoms have a L-J pair interaction that
does not match the combined L-J parameters for that pair).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>nbfix</strong> : bool</p>
<blockquote class="last">
<div><p>If True, off-diagonal elements in the combined Lennard-Jones matrix
exist. If False, they do not.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.has_cmap">
<tt class="descname">has_cmap</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.has_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this instance has correction map terms or not</p>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmoebaParm.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as either Amber-format file (like prmtop) or an
old-style topology file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber-style format, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.initialize_topology">
<tt class="descname">initialize_topology</tt><big>(</big><em>xyz=None</em>, <em>box=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.initialize_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes topology data structures, like the list of atoms, bonds,
etc., after the topology file has been read.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>AmberError if it is not an Amoeba-styled topology file</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.is_changed">
<tt class="descname">is_changed</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.is_changed" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if any of the topological arrays have changed since the
last upload</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_atom_info">
<tt class="descname">load_atom_info</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_atom_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atom properties into the atoms that have been loaded. If any
arrays are too short or too long, an IndexError will be raised</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_coordinates">
<tt class="descname">load_coordinates</tt><big>(</big><em>coords</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the coordinates into the atom list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coords</strong> : list of floats</p>
<blockquote class="last">
<div><p>A 1-dimensional iterable of coordinates of shape (natom*3,) from
which all atomic coordinates are assigned. In Angstroms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is deprecated and will be removed in future versions. Just
set the &#8216;coordinates&#8217; attribute instead</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_dataframe">
<tt class="descname">load_dataframe</tt><big>(</big><em>df</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atomic properties from an input DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : pandas.DataFrame</p>
<blockquote class="last">
<div><p>A pandas DataFrame with atomic properties that will be used to set
the properties on the current list of atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.load_dataframe" title="parmed.utils.pandautils.load_dataframe"><tt class="xref py py-func docutils literal"><span class="pre">parmed.utils.pandautils.load_dataframe()</span></tt></a></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmoebaParm.load_from_rawdata">
<em class="property">classmethod </em><tt class="descname">load_from_rawdata</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_from_rawdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.AmoebaParm.load_from_structure">
<em class="property">classmethod </em><tt class="descname">load_from_structure</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_from_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_pointers">
<tt class="descname">load_pointers</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_pointers" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the data in POINTERS section into a pointers dictionary with each
key being the pointer name according to <a class="reference external" href="http://ambermd.org/formats.html">http://ambermd.org/formats.html</a></p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_rst7">
<tt class="descname">load_rst7</tt><big>(</big><em>rst7</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads coordinates into the AmberParm class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rst7</strong> : str or <a class="reference internal" href="#parmed.amber.Rst7" title="parmed.amber.Rst7"><tt class="xref py py-class docutils literal"><span class="pre">Rst7</span></tt></a></p>
<blockquote class="last">
<div><p>The Amber coordinate file (either ASCII restart or NetCDF restart)
object or filename to assign atomic coordinates from.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_structure">
<tt class="descname">load_structure</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all of the topology instance variables. This is necessary if we
actually want to modify the topological layout of our system</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.load_velocities">
<tt class="descname">load_velocities</tt><big>(</big><em>vels</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.load_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the coordinates into the atom list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>vels</strong> : list of floats</p>
<blockquote class="last">
<div><p>A 1-dimensional iterable of velocities of shape (natom*3,) from
which all atomic velocities are assigned. In Angstroms/picosecond</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is deprecated and will be removed in future versions. Just
set the &#8216;velocities&#8217; attribute instead</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.mdin_skeleton">
<tt class="descname">mdin_skeleton</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.mdin_skeleton" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the skeleton of an mdin file with the &amp;amoeba namelist set up
correctly for the potential terms that are present in this topology
file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">str</p>
<blockquote class="last">
<div><p>A skeleton MDIN file with all of the do_* variables in the &amp;amoeba
section set correctly. It is commented for easy editing</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_add_constraints">
<tt class="descname">omm_add_constraints</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_add_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints to a given system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>system</strong> : mm.System</p>
<blockquote>
<div><p>The OpenMM system for which constraints should be added</p>
</div></blockquote>
<p><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>Which kind of constraints should be used</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool</p>
<blockquote class="last">
<div><p>If True, water bonds are constrained regardless of whether
constrains is None</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_angle_force">
<tt class="descname">omm_angle_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the
angles are for an Amoeba-parametrized system)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">force</p>
<blockquote class="last">
<div><p>HarmonicAngleForce (or AmoebaAngleForce if this is an Amoeba
system), or None if there are no angles to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_bond_force">
<tt class="descname">omm_bond_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_bond_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are
for an Amoeba-parametrized system)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraints</strong> : None, app.HBonds, app.AllBonds, or app.HAngles</p>
<blockquote>
<div><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</div></blockquote>
<p><strong>rigidWater</strong> : bool=True</p>
<blockquote>
<div><p>Should water-H bonds be constrained regardless of <cite>constraints</cite>?</p>
</div></blockquote>
<p><strong>flexibleConstraints</strong> : bool=True</p>
<blockquote>
<div><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">force</p>
<blockquote class="last">
<div><p>HarmonicBondForce (or AmoebaBondForce if this is an Amoeba system),
or None if there are no bonds to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_cmap_force">
<tt class="descname">omm_cmap_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_cmap_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM CMAP torsion force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">CMAPTorsionForce</p>
<blockquote class="last">
<div><p>Or None, if no CMAP terms are present</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_dihedral_force">
<tt class="descname">omm_dihedral_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_dihedral_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PeriodicTorsionForce</p>
<blockquote class="last">
<div><p>Or None if no torsions are present in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_gbsa_force">
<tt class="descname">omm_gbsa_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_gbsa_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Generalized Born force for running implicit solvent
calculations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>implicitSolvent</strong> : app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</p>
<blockquote>
<div><p>The Generalized Born implicit solvent model to use.</p>
</div></blockquote>
<p><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace. Default is NoCutoff</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating opint number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff</p>
</div></blockquote>
<p><strong>implicitSolventKappa</strong> : float or 1/distance Quantity = None</p>
<blockquote>
<div><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</div></blockquote>
<p><strong>implicitSolventSaltConc</strong> : float or amount/volume Quantity=0 moles/liter</p>
<blockquote>
<div><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</div></blockquote>
<p><strong>temperature</strong> : float or temperature Quantity = 298.15 kelvin</p>
<blockquote>
<div><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</div></blockquote>
<p><strong>soluteDielectric</strong> : float=1.0</p>
<blockquote>
<div><p>The dielectric constant of the protein interior used in GB</p>
</div></blockquote>
<p><strong>solventDielectric</strong> : float=78.5</p>
<blockquote class="last">
<div><p>The dielectric constant of the water used in GB</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_improper_force">
<tt class="descname">omm_improper_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_improper_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM improper torsion force (quadratic bias)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">CustomTorsionForce</p>
<blockquote class="last">
<div><p>With the formula k*(phi-phi0)^2, or None if there are no impropers</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_nonbonded_force">
<tt class="descname">omm_nonbonded_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_nonbonded_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM NonbondedForce (and CustomNonbondedForce if
necessary) to define the nonbonded interatomic potential for this
system. A CustomNonbondedForce is used for the r^-4 part of the 12-6-4
Lennard-Jones potential as well as any modified off-diagonal (i.e.,
NBFIX) terms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nonbondedMethod</strong> : cutoff method</p>
<blockquote>
<div><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</div></blockquote>
<p><strong>nonbondedCutoff</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</div></blockquote>
<p><strong>switchDistance</strong> : float or distance Quantity</p>
<blockquote>
<div><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</div></blockquote>
<p><strong>ewaldErrorTolerance</strong> : float=0.0005</p>
<blockquote>
<div><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</div></blockquote>
<p><strong>reactionFieldDielectric</strong> : float=78.5</p>
<blockquote>
<div><p>If the nonbondedMethod is CutoffPeriodic or CutoffNonPeriodic, the
region beyond the cutoff is treated using a reaction field method
with this dielectric constant. It should be set to 1 if another
implicit solvent model is being used (e.g., GB)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NonbondedForce [, CustomNonbondedForce]</p>
<blockquote class="last">
<div><p>If a CustomNonbondedForce is necessary, the return value is a
2-element tuple of NonbondedForce, CustomNonbondedForce. If only a
NonbondedForce is necessary, that is the return value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_out_of_plane_bend_force">
<tt class="descname">omm_out_of_plane_bend_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_out_of_plane_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba out-of-plane bend force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaOutOfPlaneBendForce</p>
<blockquote class="last">
<div><p>The out-of-plane bend Angle force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_pi_torsion_force">
<tt class="descname">omm_pi_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_pi_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba pi-torsion force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaPiTorsionForce</p>
<blockquote class="last">
<div><p>The pi-torsion force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_rb_torsion_force">
<tt class="descname">omm_rb_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_rb_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">RBTorsionForce</p>
<blockquote class="last">
<div><p>Or None if no torsions are present in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_set_virtual_sites">
<tt class="descname">omm_set_virtual_sites</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_set_virtual_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra
points defined in this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>system</strong> : mm.System</p>
<blockquote class="last">
<div><p>The system for which the virtual sites will be set. All particles
must have already been added to this System before calling this
method</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_stretch_bend_force">
<tt class="descname">omm_stretch_bend_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_stretch_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba stretch-bend force for this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaStretchBendForce</p>
<blockquote class="last">
<div><p>The stretch-bend force containing all terms in this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_torsion_torsion_force">
<tt class="descname">omm_torsion_torsion_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_torsion_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba coupled-torsion (CMAP) force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaTorsionTorsionForce</p>
<blockquote class="last">
<div><p>The torsion-torsion (CMAP) force with all coupled-torsion parameters
for this system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_trigonal_angle_force">
<tt class="descname">omm_trigonal_angle_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_trigonal_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba trigonal-angle force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">AmoebaInPlaneAngleForce</p>
<blockquote class="last">
<div><p>The trigonal in-plane Angle force</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.omm_urey_bradley_force">
<tt class="descname">omm_urey_bradley_force</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.omm_urey_bradley_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM Urey-Bradley force</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HarmonicBondForce</p>
<blockquote class="last">
<div><p>Or None, if no urey-bradleys are present</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.AmoebaParm.parse">
<em class="property">static </em><tt class="descname">parse</tt><big>(</big><em>filename</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Meant for use with the automatic file loader, this will automatically
return a subclass of AmberFormat corresponding to what the information
in the prmtop file contains (i.e., either an AmberParm, ChamberParm,
AmoebaParm, or AmberFormat)</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.positions">
<tt class="descname">positions</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of 3-element Quantity tuples of dimension length representing the
atomic positions for every atom in the system. If set with unitless
numbers, those numbers are assumed to be in angstroms. If any atoms do
not have coordinates, this is simply <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.prune_empty_terms">
<tt class="descname">prune_empty_terms</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.prune_empty_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks through all of the topological lists and gets rid of terms
in which at least one of the atoms is None or has an <cite>idx</cite> attribute set
to -1 (indicating that it has been removed from the <cite>atoms</cite> atom list)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.ptr">
<tt class="descname">ptr</tt><big>(</big><em>pointer</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.ptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the given pointer, and converts to upper-case so
it&#8217;s case-insensitive. A non-existent pointer meets with a KeyError</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pointer</strong> : str</p>
<blockquote>
<div><p>The AMBER pointer for which to extract the value</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>The returned integer is the value of that pointer</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.rdparm">
<tt class="descname">rdparm</tt><big>(</big><em>fname</em>, <em>slow=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.rdparm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.rdparm_old">
<tt class="descname">rdparm_old</tt><big>(</big><em>prmtop_lines</em>, <em>check=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.rdparm_old" title="Permalink to this definition">¶</a></dt>
<dd><p>This reads an old-style topology file and stores the results in the
same data structures as a new-style topology file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prmtop_lines</strong> : list of str</p>
<blockquote>
<div><p>List of all lines in the prmtop file</p>
</div></blockquote>
<p><strong>check</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, only the first couple sections will be read to determine if
this is, in fact, an old-style topology file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.rdparm_slow">
<tt class="descname">rdparm_slow</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.rdparm_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file. This parser is written in pure Python and
is therefore slower than the C++-optimized version</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.recalculate_LJ">
<tt class="descname">recalculate_LJ</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.recalculate_LJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the <tt class="docutils literal"><span class="pre">LENNARD_JONES_ACOEF</span></tt> and <tt class="docutils literal"><span class="pre">LENNARD_JONES_BCOEF</span></tt> arrays in
the <tt class="xref py py-attr docutils literal"><span class="pre">parm_data</span></tt> raw data dictionary by applying the canonical
Lorentz-Berthelot combining rules to the values in <tt class="xref py py-attr docutils literal"><span class="pre">LJ_radius</span></tt> and
<tt class="xref py py-attr docutils literal"><span class="pre">LJ_depth</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.rediscover_molecules">
<tt class="descname">rediscover_molecules</tt><big>(</big><em>solute_ions=True</em>, <em>fix_broken=True</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.rediscover_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>This determines the molecularity and sets the ATOMS_PER_MOLECULE and
SOLVENT_POINTERS sections of the prmtops. Returns the new atom sequence
in terms of the &#8216;old&#8217; atom indexes if re-ordering was necessary to fix
the tleap bug. Returns None otherwise.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.remake_parm">
<tt class="descname">remake_parm</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.remake_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Recomputes the topology file parameters and fills parm_data</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.save">
<tt class="descname">save</tt><big>(</big><em>fname</em>, <em>format=None</em>, <em>overwrite=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current Structure in the requested file format. Supported
formats can be specified explicitly or determined by file-name
extension. The following formats are supported, with the recognized
suffix and <tt class="docutils literal"><span class="pre">format</span></tt> keyword shown in parentheses:</p>
<blockquote>
<div><ul class="simple">
<li>PDB (.pdb, pdb)</li>
<li>PDBx/mmCIF (.cif, cif)</li>
<li>PQR (.pqr, pqr)</li>
<li>Amber topology file (.prmtop/.parm7, amber)</li>
<li>CHARMM PSF file (.psf, charmm)</li>
<li>CHARMM coordinate file (.crd, charmmcrd)</li>
<li>Gromacs topology file (.top, gromacs)</li>
<li>Gromacs GRO file (.gro, gro)</li>
<li>Mol2 file (.mol2, mol2)</li>
<li>Mol3 file (.mol3, mol3)</li>
<li>Amber ASCII restart (.rst7/.inpcrd/.restrt, rst7)</li>
<li>Amber NetCDF restart (.ncrst, ncrst)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>Name of the file to save. If <tt class="docutils literal"><span class="pre">format</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> (see below), the
file type will be determined based on the filename extension. If the
type cannot be determined, a ValueError is raised.</p>
</div></blockquote>
<p><strong>format</strong> : str, optional</p>
<blockquote>
<div><p>The case-insensitive keyword specifying what type of file <tt class="docutils literal"><span class="pre">fname</span></tt>
should be saved as. If <tt class="docutils literal"><span class="pre">None</span></tt> (default), the file type will be
determined from filename extension of <tt class="docutils literal"><span class="pre">fname</span></tt></p>
</div></blockquote>
<p><strong>overwrite</strong> : bool, optional</p>
<blockquote>
<div><p>If True, allow the target file to be overwritten. Otherwise, an
IOError is raised if the file exists. Default is False</p>
</div></blockquote>
<p><strong>kwargs</strong> : keyword-arguments</p>
<blockquote>
<div><p>Remaining arguments are passed on to the file writing routines that
are called by this function</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError if either filename extension or ``format`` are not recognized</strong></p>
<p><strong>TypeError if the structure cannot be converted to the desired format for</strong></p>
<p><strong>whatever reason</strong></p>
<p><strong>IOError if the file cannot be written either because it exists and</strong></p>
<p><strong>``overwrite`` is ``False``, the filesystem is read-only, or write</strong></p>
<p class="last"><strong>permissions are not granted for the user</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.set_version">
<tt class="descname">set_version</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.set_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the version string</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.split">
<tt class="descname">split</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the current Structure into separate Structure instances for each
unique molecule. A molecule is defined as all atoms connected by a graph
of covalent bonds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>[structs, counts]</strong> : list of (<tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt>, list) tuples</p>
<blockquote class="last">
<div><p>List of all molecules in the order that they appear first in the
parent structure accompanied by the list of the molecule numbers
in which that molecule appears in the Structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.strip">
<tt class="descname">strip</tt><big>(</big><em>selection</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a subset of the atoms corresponding to an atom-based selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>selection</strong> : AmberMask, str, or iterable of bool</p>
<blockquote class="last">
<div><p>This is the selection of atoms that will be deleted from this
structure. If it is a string, it will be interpreted as an
AmberMask. If it is an AmberMask, it will be converted to a
selection of atoms. If it is an iterable, it must be the same length
as the <cite>atoms</cite> list.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.to_dataframe">
<tt class="descname">to_dataframe</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a DataFrame from the current Structure&#8217;s atomic properties</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote class="last">
<div><p>DataFrame with all atomic properties</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.create_dataframe" title="parmed.utils.pandautils.create_dataframe"><tt class="xref py py-func docutils literal"><span class="pre">parmed.utils.pandautils.create_dataframe()</span></tt></a>, <tt class="xref py py-obj docutils literal"><span class="pre">documentation</span></tt></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.topology">
<tt class="descname">topology</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>The OpenMM Topology object. Cached when possible, but any changes to the
Structure instance results in the topology being deleted and rebuilt</p>
<p class="rubric">Notes</p>
<p>This function calls <tt class="docutils literal"><span class="pre">prune_empty_terms</span></tt> if any topology lists have
changed.</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.unchange">
<tt class="descname">unchange</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.unchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggles all lists so that they do not indicate any changes</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.update_dihedral_exclusions">
<tt class="descname">update_dihedral_exclusions</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.update_dihedral_exclusions" title="Permalink to this definition">¶</a></dt>
<dd><p>Nonbonded exclusions and exceptions have the following priority:</p>
<p>bond -&gt; angle -&gt; dihedral</p>
<p>Since bonds and angles are completely excluded, any ring systems in
which two atoms are attached by a bond or angle as well as a dihedral
should be completely excluded as the bond and angle exclusion rules take
precedence.  If a Bond or Angle was _added_ to the structure between a
pair of atoms previously connected only by a dihedral term, it&#8217;s
possible that those two atoms have both an exclusion <em>and</em> an exception
defined. The result of this scenario is that sander and pmemd will
happily compute an energy, _including_ the 1-4 nonbonded terms between
atoms now connected by a bond or an Angle.  OpenMM, on the other hand,
will complain about an exception specified multiple times. This method
scans through all of the dihedrals in which <cite>ignore_end</cite> is <cite>False</cite> and
turns it to <cite>True</cite> if the two end atoms are in the bond or angle
partners arrays</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>A (natom, 3)-shape numpy array with atomic velocities for every atom in
the system (in units of angstrom/picosecond), or None if there are no
velocities</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.vels">
<tt class="descname">vels</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.vels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.AmoebaParm.view">
<tt class="descname">view</tt><a class="headerlink" href="#parmed.amber.AmoebaParm.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an indexable object that can be indexed like a standard
Structure, but returns a <em>view</em> rather than a copy</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><tt class="xref py py-obj docutils literal"><span class="pre">Structure.__getitem__</span></tt></p>
</div>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.view_as">
<tt class="descname">view_as</tt><big>(</big><em>cls</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.view_as" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view of the current object as another object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : type</p>
<blockquote>
<div><p>Class definition of an AmberParm subclass for the current object to
be converted into</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of cls initialized from data in this object. This is NOT a deep</p>
<p>copy, so modifying the original object may modify this. The copy</p>
<p class="last">function will create a deep copy of any AmberFormat-derived object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.writeParm">
<tt class="descname">writeParm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.writeParm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.write_cif">
<tt class="descname">write_cif</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>renumber=True</em>, <em>coordinates=None</em>, <em>altlocs='all'</em>, <em>write_anisou=False</em>, <em>standard_resnames=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.write_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from the current Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The structure from which to write the PDBx/mmCIF file</p>
</div></blockquote>
<p><strong>dest</strong> : <tt class="docutils literal"><span class="pre">str</span> <span class="pre">or</span> <span class="pre">file-like</span></tt></p>
<blockquote>
<div><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</div></blockquote>
<p><strong>renumber</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously</p>
</div></blockquote>
<p><strong>coordinates</strong> : <tt class="docutils literal"><span class="pre">array-like</span> <span class="pre">of</span> <span class="pre">float</span></tt></p>
<blockquote>
<div><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the &#8220;original&#8221; PDB file if they
differ)</p>
</div></blockquote>
<p><strong>altlocs</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; : (default) print all alternate locations</li>
<li>&#8216;first&#8217; : print only the first alternate locations</li>
<li>&#8216;occupancy&#8217; : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</div></blockquote>
<p><strong>write_anisou</strong> : <tt class="docutils literal"><span class="pre">bool</span></tt></p>
<blockquote>
<div><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written</p>
</div></blockquote>
<p><strong>standard_resnames</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.write_parm">
<tt class="descname">write_parm</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.write_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current data in parm_data into a new topology file with a
given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file to write the prmtop to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.write_pdb">
<tt class="descname">write_pdb</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>renumber=True</em>, <em>coordinates=None</em>, <em>altlocs='all'</em>, <em>write_anisou=False</em>, <em>charmm=False</em>, <em>standard_resnames=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.write_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from a Structure instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The structure from which to write the PDB file</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</div></blockquote>
<p><strong>renumber</strong> : bool, optional</p>
<blockquote>
<div><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously. Default is True</p>
</div></blockquote>
<p><strong>coordinates</strong> : array-like of float, optional</p>
<blockquote>
<div><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the &#8220;original&#8221; PDB file if they
differ)</p>
</div></blockquote>
<p><strong>altlocs</strong> : str, optional</p>
<blockquote>
<div><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; : (default) print all alternate locations</li>
<li>&#8216;first&#8217; : print only the first alternate locations</li>
<li>&#8216;occupancy&#8217; : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</div></blockquote>
<p><strong>write_anisou</strong> : bool, optional</p>
<blockquote>
<div><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written. Default is False</p>
</div></blockquote>
<p><strong>charmm</strong> : bool, optional</p>
<blockquote>
<div><p>If True, SEGID will be written in columns 73 to 76 of the PDB file
in the typical CHARMM-style PDB output. This will be omitted for any
atom that does not contain a SEGID identifier. Default is False</p>
</div></blockquote>
<p><strong>standard_resnames</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.write_psf">
<tt class="descname">write_psf</tt><big>(</big><em>struct</em>, <em>dest</em>, <em>vmd=False</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.write_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a PSF file from the stored molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></p>
<blockquote>
<div><p>The Structure instance from which the PSF should be written</p>
</div></blockquote>
<p><strong>dest</strong> : str or file-like</p>
<blockquote>
<div><p>The place to write the output PSF file.  If it has a &#8220;write&#8221;
attribute, it will be used to print the PSF file. Otherwise, it will
be treated like a string and a file will be opened, printed, then
closed</p>
</div></blockquote>
<p><strong>vmd</strong> : bool</p>
<blockquote class="last">
<div><p>If True, it will write out a PSF in the format that VMD prints it in
(i.e., no NUMLP/NUMLPH or MOLNT sections)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">CharmmPsfFile</span><span class="p">(</span><span class="s">&#39;testfiles/test.psf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">write_psf</span><span class="p">(</span><span class="s">&#39;testfiles/test2.psf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.AmoebaParm.write_rst7">
<tt class="descname">write_rst7</tt><big>(</big><em>name</em>, <em>netcdf=None</em><big>)</big><a class="headerlink" href="#parmed.amber.AmoebaParm.write_rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a restart file with the current coordinates and velocities and
box info if it&#8217;s present</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote>
<div><p>Name of the file to write the restart file to</p>
</div></blockquote>
<p><strong>netcdf</strong> : bool=False</p>
<blockquote class="last">
<div><p>If True, write a NetCDF-format restart file (requires a NetCDF
backend; scipy, netCDF4, or ScientificPython; to be installed)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If <cite>netcdf</cite> is not specified and the filename extension given by <cite>name</cite>
is <cite>.ncrst</cite>, the a NetCDF restart file will be written. However, an
explicit value for <cite>netcdf</cite> will override any filename extensions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.Rst7">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">Rst7</tt><big>(</big><em>filename=None</em>, <em>natom=None</em>, <em>title=''</em>, <em>time=0.0</em><big>)</big><a class="headerlink" href="#parmed.amber.Rst7" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Amber input coordinate (or restart coordinate) file. Front-end for the
readers and writers, supports both NetCDF and ASCII restarts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, optional</p>
<blockquote>
<div><p>If a filename is provided, this file is parsed and the Rst7 data
populated from that file. The format (ASCII or NetCDF) is autodetected</p>
</div></blockquote>
<p><strong>natom</strong> : int, optional</p>
<blockquote>
<div><p>If no filename is provided, this value is required. If a filename is
provided, this value is ignored (and instead set to the value of natom
from the coordinate file). This is the number of atoms for which we have
coordinates. If not provided for a new file, it <em>must</em> be set later.</p>
</div></blockquote>
<p><strong>title</strong> : str, optional</p>
<blockquote>
<div><p>For a file that is to be written, this is the title that will be given
to that file. Default is an empty string</p>
</div></blockquote>
<p><strong>time</strong> : float, optional</p>
<blockquote class="last">
<div><p>The time to write to the restart file. This is cosmetic. Default is 0</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.Rst7.box_vectors" title="parmed.amber.Rst7.box_vectors"><tt class="xref py py-obj docutils literal"><span class="pre">box_vectors</span></tt></a></td>
<td>Unit cell vectors with units</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.Rst7.coords" title="parmed.amber.Rst7.coords"><tt class="xref py py-obj docutils literal"><span class="pre">coords</span></tt></a></td>
<td>Deprecated for coordinates now</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.Rst7.hasbox" title="parmed.amber.Rst7.hasbox"><tt class="xref py py-obj docutils literal"><span class="pre">hasbox</span></tt></a></td>
<td>Whether or not this Rst7 has unit cell information</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.Rst7.hasvels" title="parmed.amber.Rst7.hasvels"><tt class="xref py py-obj docutils literal"><span class="pre">hasvels</span></tt></a></td>
<td>Whether or not this Rst7 has velocities</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.Rst7.positions" title="parmed.amber.Rst7.positions"><tt class="xref py py-obj docutils literal"><span class="pre">positions</span></tt></a></td>
<td>Atomic coordinates with units</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.Rst7.velocities" title="parmed.amber.Rst7.velocities"><tt class="xref py py-obj docutils literal"><span class="pre">velocities</span></tt></a></td>
<td>Atomic velocities in units of angstroms/picoseconds</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.Rst7.copy_from" title="parmed.amber.Rst7.copy_from"><tt class="xref py py-obj docutils literal"><span class="pre">copy_from</span></tt></a>(thing)</td>
<td>Copies the coordinates, velocities, and box information from another</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.Rst7.open" title="parmed.amber.Rst7.open"><tt class="xref py py-obj docutils literal"><span class="pre">open</span></tt></a>(filename)</td>
<td>Constructor that opens and parses an input coordinate file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.Rst7.write" title="parmed.amber.Rst7.write"><tt class="xref py py-obj docutils literal"><span class="pre">write</span></tt></a>(fname[,&nbsp;netcdf])</td>
<td>Writes the coordinates and/or velocities to a restart file</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.Rst7.box_vectors">
<tt class="descname">box_vectors</tt><a class="headerlink" href="#parmed.amber.Rst7.box_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit cell vectors with units</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.Rst7.coords">
<tt class="descname">coords</tt><a class="headerlink" href="#parmed.amber.Rst7.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated for coordinates now</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.Rst7.copy_from">
<em class="property">classmethod </em><tt class="descname">copy_from</tt><big>(</big><em>thing</em><big>)</big><a class="headerlink" href="#parmed.amber.Rst7.copy_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the coordinates, velocities, and box information from another
instance</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.Rst7.hasbox">
<tt class="descname">hasbox</tt><a class="headerlink" href="#parmed.amber.Rst7.hasbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not this Rst7 has unit cell information</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.Rst7.hasvels">
<tt class="descname">hasvels</tt><a class="headerlink" href="#parmed.amber.Rst7.hasvels" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not this Rst7 has velocities</p>
</dd></dl>

<dl class="classmethod">
<dt id="parmed.amber.Rst7.open">
<em class="property">classmethod </em><tt class="descname">open</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.Rst7.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor that opens and parses an input coordinate file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>Name of the file to parse</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.Rst7.positions">
<tt class="descname">positions</tt><a class="headerlink" href="#parmed.amber.Rst7.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic coordinates with units</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.Rst7.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.Rst7.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic velocities in units of angstroms/picoseconds</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.Rst7.write">
<tt class="descname">write</tt><big>(</big><em>fname</em>, <em>netcdf=False</em><big>)</big><a class="headerlink" href="#parmed.amber.Rst7.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the coordinates and/or velocities to a restart file</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parmed.amber.BeemanRestart">
<em class="property">class </em><tt class="descclassname">parmed.amber.</tt><tt class="descname">BeemanRestart</tt><big>(</big><em>fname=None</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="parmed.amber.amberformat.html#parmed.amber.amberformat.AmberFormat" title="parmed.amber.amberformat.AmberFormat"><tt class="xref py py-class docutils literal"><span class="pre">parmed.amber.amberformat.AmberFormat</span></tt></a></p>
<p>The restart files written for/by the Beeman integrator has the same type of
format as the topology file</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.accelerations" title="parmed.amber.BeemanRestart.accelerations"><tt class="xref py py-obj docutils literal"><span class="pre">accelerations</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.box" title="parmed.amber.BeemanRestart.box"><tt class="xref py py-obj docutils literal"><span class="pre">box</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.coordinates" title="parmed.amber.BeemanRestart.coordinates"><tt class="xref py py-obj docutils literal"><span class="pre">coordinates</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.natom" title="parmed.amber.BeemanRestart.natom"><tt class="xref py py-obj docutils literal"><span class="pre">natom</span></tt></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.old_accelerations" title="parmed.amber.BeemanRestart.old_accelerations"><tt class="xref py py-obj docutils literal"><span class="pre">old_accelerations</span></tt></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.velocities" title="parmed.amber.BeemanRestart.velocities"><tt class="xref py py-obj docutils literal"><span class="pre">velocities</span></tt></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.addFlag" title="parmed.amber.BeemanRestart.addFlag"><tt class="xref py py-obj docutils literal"><span class="pre">addFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.add_flag" title="parmed.amber.BeemanRestart.add_flag"><tt class="xref py py-obj docutils literal"><span class="pre">add_flag</span></tt></a>(flag_name,&nbsp;flag_format[,&nbsp;data,&nbsp;...])</td>
<td>Adds a new flag with the given flag name and Fortran format string and</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.deleteFlag" title="parmed.amber.BeemanRestart.deleteFlag"><tt class="xref py py-obj docutils literal"><span class="pre">deleteFlag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.delete_flag" title="parmed.amber.BeemanRestart.delete_flag"><tt class="xref py py-obj docutils literal"><span class="pre">delete_flag</span></tt></a>(flag_name)</td>
<td>Removes a flag from the topology file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.id_format" title="parmed.amber.BeemanRestart.id_format"><tt class="xref py py-obj docutils literal"><span class="pre">id_format</span></tt></a>(filename)</td>
<td>Identifies the file type as either Amber-format file (like prmtop) or an old-style topology file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.parse" title="parmed.amber.BeemanRestart.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(filename,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Meant for use with the automatic file loader, this will automatically</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.rdparm" title="parmed.amber.BeemanRestart.rdparm"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm</span></tt></a>(fname[,&nbsp;slow])</td>
<td>Parses the Amber format file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.rdparm_old" title="parmed.amber.BeemanRestart.rdparm_old"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_old</span></tt></a>(prmtop_lines[,&nbsp;check])</td>
<td>This reads an old-style topology file and stores the results in the</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.rdparm_slow" title="parmed.amber.BeemanRestart.rdparm_slow"><tt class="xref py py-obj docutils literal"><span class="pre">rdparm_slow</span></tt></a>(fname)</td>
<td>Parses the Amber format file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.set_version" title="parmed.amber.BeemanRestart.set_version"><tt class="xref py py-obj docutils literal"><span class="pre">set_version</span></tt></a>()</td>
<td>Sets the version string</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.view_as" title="parmed.amber.BeemanRestart.view_as"><tt class="xref py py-obj docutils literal"><span class="pre">view_as</span></tt></a>(cls)</td>
<td>Returns a view of the current object as another object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.writeParm" title="parmed.amber.BeemanRestart.writeParm"><tt class="xref py py-obj docutils literal"><span class="pre">writeParm</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#parmed.amber.BeemanRestart.write_parm" title="parmed.amber.BeemanRestart.write_parm"><tt class="xref py py-obj docutils literal"><span class="pre">write_parm</span></tt></a>(name)</td>
<td>Writes the current data in parm_data into a new topology file with</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="parmed.amber.BeemanRestart.accelerations">
<tt class="descname">accelerations</tt><a class="headerlink" href="#parmed.amber.BeemanRestart.accelerations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.addFlag">
<tt class="descname">addFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.addFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.add_flag">
<tt class="descname">add_flag</tt><big>(</big><em>flag_name</em>, <em>flag_format</em>, <em>data=None</em>, <em>num_items=-1</em>, <em>comments=None</em>, <em>after=None</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.add_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new flag with the given flag name and Fortran format string and
initializes the array with the values given, or as an array of 0s
of length num_items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flag_name</strong> : str</p>
<blockquote>
<div><p>Name of the flag to insert. It is converted to all upper case</p>
</div></blockquote>
<p><strong>flag_format</strong> : str</p>
<blockquote>
<div><p>Fortran format string representing how the data in this section
should be written and read. Do not enclose in ()</p>
</div></blockquote>
<p><strong>data</strong> : list=None</p>
<blockquote>
<div><p>Sequence with data for the new flag. If None, a list of zeros of
length <tt class="docutils literal"><span class="pre">num_items</span></tt> (see below) is given as a holder</p>
</div></blockquote>
<p><strong>num_items</strong> : int=-1</p>
<blockquote>
<div><p>Number of items in the section. This variable is ignored if a set of
data are given in <cite>data</cite></p>
</div></blockquote>
<p><strong>comments</strong> : list of str=None</p>
<blockquote>
<div><p>List of comments to add to this section</p>
</div></blockquote>
<p><strong>after</strong> : str=None</p>
<blockquote>
<div><p>If provided, the added flag will be added after the one with the
name given to <cite>after</cite>. If this flag does not exist, IndexError will
be raised</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AmberError if flag already exists</strong></p>
<p class="last"><strong>IndexError if the ``after`` flag does not exist</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.BeemanRestart.box">
<tt class="descname">box</tt><a class="headerlink" href="#parmed.amber.BeemanRestart.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.BeemanRestart.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#parmed.amber.BeemanRestart.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.deleteFlag">
<tt class="descname">deleteFlag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.deleteFlag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.delete_flag">
<tt class="descname">delete_flag</tt><big>(</big><em>flag_name</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.delete_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a flag from the topology file</p>
</dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.BeemanRestart.id_format">
<em class="property">static </em><tt class="descname">id_format</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as either Amber-format file (like prmtop) or an
old-style topology file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Name of the file to check format for</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>is_fmt</strong> : bool</p>
<blockquote class="last">
<div><p>True if it is an Amber-style format, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.BeemanRestart.natom">
<tt class="descname">natom</tt><a class="headerlink" href="#parmed.amber.BeemanRestart.natom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="parmed.amber.BeemanRestart.old_accelerations">
<tt class="descname">old_accelerations</tt><a class="headerlink" href="#parmed.amber.BeemanRestart.old_accelerations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="parmed.amber.BeemanRestart.parse">
<em class="property">static </em><tt class="descname">parse</tt><big>(</big><em>filename</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Meant for use with the automatic file loader, this will automatically
return a subclass of AmberFormat corresponding to what the information
in the prmtop file contains (i.e., either an AmberParm, ChamberParm,
AmoebaParm, or AmberFormat)</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.rdparm">
<tt class="descname">rdparm</tt><big>(</big><em>fname</em>, <em>slow=False</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.rdparm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.rdparm_old">
<tt class="descname">rdparm_old</tt><big>(</big><em>prmtop_lines</em>, <em>check=False</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.rdparm_old" title="Permalink to this definition">¶</a></dt>
<dd><p>This reads an old-style topology file and stores the results in the
same data structures as a new-style topology file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prmtop_lines</strong> : list of str</p>
<blockquote>
<div><p>List of all lines in the prmtop file</p>
</div></blockquote>
<p><strong>check</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, only the first couple sections will be read to determine if
this is, in fact, an old-style topology file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.rdparm_slow">
<tt class="descname">rdparm_slow</tt><big>(</big><em>fname</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.rdparm_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the Amber format file. This parser is written in pure Python and
is therefore slower than the C++-optimized version</p>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.set_version">
<tt class="descname">set_version</tt><big>(</big><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.set_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the version string</p>
</dd></dl>

<dl class="attribute">
<dt id="parmed.amber.BeemanRestart.velocities">
<tt class="descname">velocities</tt><a class="headerlink" href="#parmed.amber.BeemanRestart.velocities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.view_as">
<tt class="descname">view_as</tt><big>(</big><em>cls</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.view_as" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view of the current object as another object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cls</strong> : type</p>
<blockquote>
<div><p>Class definition of an AmberParm subclass for the current object to
be converted into</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of cls initialized from data in this object. This is NOT a deep</p>
<p>copy, so modifying the original object may modify this. The copy</p>
<p class="last">function will create a deep copy of any AmberFormat-derived object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.writeParm">
<tt class="descname">writeParm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.writeParm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="parmed.amber.BeemanRestart.write_parm">
<tt class="descname">write_parm</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#parmed.amber.BeemanRestart.write_parm" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the current data in parm_data into a new topology file with
the given name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote class="last">
<div><p>Name of the file to write the topology file to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="parmed.amber.ConvertFromPSF">
<tt class="descclassname">parmed.amber.</tt><tt class="descname">ConvertFromPSF</tt><big>(</big><em>struct</em>, <em>params</em>, <em>title=''</em><big>)</big><a class="headerlink" href="#parmed.amber.ConvertFromPSF" title="Permalink to this definition">¶</a></dt>
<dd><p>This function instantiates a ChamberParm instance from a data structure
instantiated by a CHARMM PSF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> : Structure</p>
<blockquote>
<div><p>The structure object (typically loaded from a PSF file)</p>
</div></blockquote>
<p><strong>params</strong> : CharmmParameterSet</p>
<blockquote>
<div><p>The parameter set describing the parameters of the input struct</p>
</div></blockquote>
<p><strong>title</strong> : str=&#8217;&#8216;</p>
<blockquote>
<div><p>The title to assign to the topology file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ChamberParm</p>
<blockquote class="last">
<div><p>ChamberParm instance with all parameters loaded</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="parmed.amber.LoadParm">
<tt class="descclassname">parmed.amber.</tt><tt class="descname">LoadParm</tt><big>(</big><em>parmname</em>, <em>xyz=None</em>, <em>box=None</em>, <em>rst7_name=None</em><big>)</big><a class="headerlink" href="#parmed.amber.LoadParm" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a topology file using the correct class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>parmname</strong> : <tt class="docutils literal"><span class="pre">str</span></tt></p>
<blockquote>
<div><p>The name of the topology file to load</p>
</div></blockquote>
<p><strong>xyz</strong> : str or array, optional</p>
<blockquote>
<div><p>If provided, the coordinates and unit cell dimensions from the provided
Amber inpcrd/restart file will be loaded into the molecule, or the
coordinates will be loaded from the coordinate array</p>
</div></blockquote>
<p><strong>box</strong> : array, optional</p>
<blockquote>
<div><p>If provided, the unit cell information will be set from the provided
unit cell dimensions (a, b, c, alpha, beta, and gamma, respectively)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>parm</strong> : <a class="reference internal" href="#parmed.amber.AmberParm" title="parmed.amber.AmberParm"><tt class="xref py py-class docutils literal"><span class="pre">AmberParm</span></tt></a> (or subclass)</p>
<blockquote class="last">
<div><p>This function parses the topology file, determines if it is an
Amber-style (i.e., <em>traditional</em> Amber force field), Chamber-style
(i.e., CHARMM force field), or Amoeba-style (i.e., Amoeba force field),
and then returns an instance of the appropriate type.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">parmed.amber package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-parmed.amber">Module contents</a><ul>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/api/parmed/parmed.amber.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Jason Swails.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>