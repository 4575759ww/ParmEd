<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The structure module &mdash; ParmEd 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ParmEd 2.0 documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-structure-module">
<h1>The <tt class="xref py py-mod docutils literal"><span class="pre">structure</span></tt> module<a class="headerlink" href="#the-structure-module" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="xref py py-mod docutils literal"><span class="pre">structure</span></tt> module contains the core class defining systems of
particles &#8211; the <tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt> class. The API documentation makes this
class look intimidating, but its core features are the <tt class="docutils literal"><span class="pre">atoms</span></tt> attribute
(which is an <tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt>) and its <tt class="docutils literal"><span class="pre">residues</span></tt> attribute (which is a
<tt class="xref py py-class docutils literal"><span class="pre">ResidueList</span></tt>). These two attributes are enough to write numerous files
(e.g., PDB and PDBx/mmCIF), and these are the only two attributes currently
populated through the PDB and mmCIF parsing routines.</p>
<div class="section" id="structure-class">
<h2><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt> class<a class="headerlink" href="#structure-class" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="api/chemistry/chemistry.structure.html#chemistry.structure.Structure" title="chemistry.structure.Structure"><tt class="xref py py-obj docutils literal"><span class="pre">Structure</span></tt></a>()</td>
<td>A chemical structure composed of atoms, bonds, angles, torsions, and other</td>
</tr>
</tbody>
</table>
<p>The <a class="reference internal" href="api/chemistry/chemistry.structure.html#chemistry.structure.Structure" title="chemistry.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></a> class may be instantiated directly, but is more often
created by one of the parsers (see below for <tt class="xref py py-func docutils literal"><span class="pre">read_PDB()</span></tt> and
<tt class="xref py py-func docutils literal"><span class="pre">read_CIF()</span></tt> which both return a <a class="reference internal" href="api/chemistry/chemistry.structure.html#chemistry.structure.Structure" title="chemistry.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></a> instance) or extended to
support the structure files of various computational chemistry programs.</p>
</div>
<div class="section" id="read-pdb-and-read-cif-functions">
<h2><tt class="xref py py-func docutils literal"><span class="pre">read_PDB()</span></tt> and <tt class="xref py py-func docutils literal"><span class="pre">read_CIF()</span></tt> functions<a class="headerlink" href="#read-pdb-and-read-cif-functions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">read_PDB</span></tt></td>
<td></td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">read_CIF</span></tt></td>
<td></td>
</tr>
</tbody>
</table>
<p>PDB files and mmCIF files downloaded from the RCSB Protein Data Bank or the
world wide Protein Data Bank often contain a large amount of metadata describing
the structure, such as the citation information, experimental method (e.g.,
X-ray crystallography or NMR spectroscopy), authors, and related database
entries (such as BMRB entries for NMR-solved structures). This information is
extracted from both PDB and PDBx/mmCIF files when available, along with
anisotropic B-factors.</p>
<p>The following sections will briefly demonstrate parsing a PDB file and a mmCIF
file to a <a class="reference internal" href="api/chemistry/chemistry.structure.html#chemistry.structure.Structure" title="chemistry.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></a> instance.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>For the purposes of this example, we will download the 4LZT structure as both a
PDB file and a CIF file. These structures are both used in the ParmEd unittest
suite, so you can get the files from there, or <a class="reference external" href="http://www.rcsb.org/pdb/explore/explore.do?structureId=4LZT">download them from here.</a></p>
<hr class="docutils" />
<p>The first example demonstrates reading the PDB file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chemistry</span> <span class="kn">import</span> <span class="n">read_PDB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lzt_pdb</span> <span class="o">=</span> <span class="n">read_PDB</span><span class="p">(</span><span class="s">&#39;4lzt.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">lzt_pdb</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">1164</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">lzt_pdb</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
<span class="go">274</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lzt_pdb</span><span class="o">.</span><span class="n">experimental</span> <span class="c"># See the experimental method</span>
<span class="go">u&#39;X-RAY DIFFRACTION&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># See how many chains we have</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">lzt_pdb</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">chain_list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">chain</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain_list</span>
<span class="go">set([u&#39;A&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Only one chain. Now see how many atoms have alternate conformations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_with_altconf</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">lzt_pdb</span><span class="o">.</span><span class="n">atoms</span>
<span class="gp">... </span>                          <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">other_locations</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">atoms_with_altconf</span><span class="p">)</span>
<span class="go">19</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Just for sanity&#39;s sake, make sure that the sum of all atoms in all</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># residues is equal to the total number of atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">lzt_pdb</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
<span class="go">1164</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">lzt_pdb</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">1164</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lzt_pdb</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">anisou</span> <span class="c"># Look, we even get anisotropic B-factors!</span>
<span class="go">array([ 0.2066,  0.1204,  0.1269,  0.0044,  0.0126,  0.0191])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The second example demonstrates reading the CIF file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chemistry</span> <span class="kn">import</span> <span class="n">read_CIF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lzt_cif</span> <span class="o">=</span> <span class="n">read_CIF</span><span class="p">(</span><span class="s">&#39;4LZT.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">lzt_cif</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">1164</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">lzt_cif</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
<span class="go">274</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lzt_cif</span><span class="o">.</span><span class="n">experimental</span> <span class="c"># See the experimental method</span>
<span class="go">&#39;X-RAY DIFFRACTION&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># See how many chains we have</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">lzt_cif</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">chain_list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">chain</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain_list</span>
<span class="go">set([&#39;A&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Only one chain. Now see how many atoms have alternate conformations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms_with_altconf</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">lzt_cif</span><span class="o">.</span><span class="n">atoms</span>
<span class="gp">... </span>                         <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">other_locations</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">atoms_with_altconf</span><span class="p">)</span>
<span class="go">19</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Just for sanity&#39;s sake, make sure that the sum of all atoms in all</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># residues is equal to the total number of atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">lzt_cif</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
<span class="go">1164</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">lzt_pdb</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">1164</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lzt_cif</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">anisou</span> <span class="c"># Look, we even get anisotropic B-factors!</span>
<span class="go">array([ 0.2066,  0.1204,  0.1269,  0.0044,  0.0126,  0.0191])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="converting-pdbx-mmcif-files-to-pdb-files">
<h2>Converting PDBx/mmCIF files to PDB files<a class="headerlink" href="#converting-pdbx-mmcif-files-to-pdb-files" title="Permalink to this headline">¶</a></h2>
<p>If you noticed the <tt class="docutils literal"><span class="pre">write_cif</span></tt> and <tt class="docutils literal"><span class="pre">write_pdb</span></tt> methods attached to the
<a class="reference internal" href="api/chemistry/chemistry.structure.html#chemistry.structure.Structure" title="chemistry.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></a> class, you may have deduced that you can very simply convert
a PDBx/mmCIF file to a PDB file.</p>
<p>This is likely to be increasingly popular, since the PDB is moving to the mmCIF
format, but many programs in the field of computational chemistry and physics
has decades worth of legacy code built around PDB files. Not to worry!  A quick
1-liner will seamlessly convert PDBx to PDB:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">chemistry</span> <span class="kn">import</span> <span class="n">read_CIF</span>
<span class="n">read_CIF</span><span class="p">(</span><span class="s">&#39;4LZT.cif&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_pdb</span><span class="p">(</span><span class="s">&#39;4lzt_converted.pdb&#39;</span><span class="p">,</span> <span class="n">write_anisou</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                               <span class="n">renumber</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the metadata is <em>not</em> copied (i.e., the <tt class="docutils literal"><span class="pre">EXPTL</span></tt>, <tt class="docutils literal"><span class="pre">JRNL</span></tt>,
and <tt class="docutils literal"><span class="pre">AUTHOR</span></tt> records, to name a few). Only the coordinates, unit cell
(<tt class="docutils literal"><span class="pre">CYRST1</span></tt> record), and optionally anisotropic B-factor lines are translated.</p>
<p>The <tt class="docutils literal"><span class="pre">renumber</span></tt> argument tells <a class="reference internal" href="api/chemistry/chemistry.structure.html#chemistry.structure.Structure" title="chemistry.structure.Structure"><tt class="xref py py-class docutils literal"><span class="pre">Structure</span></tt></a> to use the original PDB
numbers, rather than its internal number scheme that numbers sequentially from 1
to N, where N is the number of residues.</p>
<p>If your system has more than 99,999 atoms (and/or more than 9,999 residues), the
numbering cycles back, such that the atom serial number after 99,999 is 0, and
the numbering starts again.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The <tt class="docutils literal"><span class="pre">structure</span></tt> module</a><ul>
<li><a class="reference internal" href="#structure-class"><tt class="docutils literal"><span class="pre">Structure</span></tt> class</a></li>
<li><a class="reference internal" href="#read-pdb-and-read-cif-functions"><tt class="docutils literal"><span class="pre">read_PDB()</span></tt> and <tt class="docutils literal"><span class="pre">read_CIF()</span></tt> functions</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#converting-pdbx-mmcif-files-to-pdb-files">Converting PDBx/mmCIF files to PDB files</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/structure.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Jason Swails.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>