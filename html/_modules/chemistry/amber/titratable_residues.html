<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>chemistry.amber.titratable_residues &mdash; ParmEd 2.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ParmEd 2.0 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">ParmEd 2.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for chemistry.amber.titratable_residues</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains all of the information for the titratable residues,</span>
<span class="sd">including reference energies, model compound pKas, and charge vectors for every</span>
<span class="sd">titratable residue treated.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>

<span class="n">titratable_residues</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;AS4&#39;</span><span class="p">,</span> <span class="s">&#39;GL4&#39;</span><span class="p">,</span> <span class="s">&#39;CYS&#39;</span><span class="p">,</span> <span class="s">&#39;TYR&#39;</span><span class="p">,</span> <span class="s">&#39;HIP&#39;</span><span class="p">,</span> <span class="s">&#39;LYS&#39;</span><span class="p">,</span> <span class="s">&#39;DAP&#39;</span><span class="p">,</span> <span class="s">&#39;DCP&#39;</span><span class="p">,</span>
                       <span class="s">&#39;DG&#39;</span><span class="p">,</span> <span class="s">&#39;DT&#39;</span><span class="p">,</span> <span class="s">&#39;AP&#39;</span><span class="p">,</span> <span class="s">&#39;CP&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="s">&#39;U&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">chemistry.exceptions</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CpinChargeWarning</span><span class="p">,</span> <span class="n">CpinRefEneWarning</span><span class="p">,</span>
        <span class="n">CpinResidueError</span><span class="p">,</span> <span class="n">CpinInputError</span><span class="p">,</span> <span class="n">CpinInputWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">chemistry.utils.six.moves</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c"># Print all CpinChargeWarning&#39;s</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">&#39;always&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">CpinChargeWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">&#39;always&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">CpinRefEneWarning</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">_State</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A protonation state &quot;&quot;&quot;</span>
    <span class="n">sort_by_resnum</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protcnt</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">refene</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="o">=</span> <span class="n">charges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refene</span> <span class="o">=</span> <span class="n">refene</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protcnt</span> <span class="o">=</span> <span class="n">protcnt</span>

<span class="k">class</span> <span class="nc">_ReferenceEnergy</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Reference energies for various solvent models &quot;&quot;&quot;</span>
    <span class="n">LN_TO_LOG</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">KB</span> <span class="o">=</span> <span class="mf">0.00199</span>
    <span class="n">TEMP</span> <span class="o">=</span> <span class="mf">300.0</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">igb1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pKa_is_set</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">igb1</span> <span class="o">=</span> <span class="n">igb1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">igb2</span> <span class="o">=</span> <span class="n">igb2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">igb5</span> <span class="o">=</span> <span class="n">igb5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">igb7</span> <span class="o">=</span> <span class="n">igb7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">igb8</span> <span class="o">=</span> <span class="n">igb8</span>

    <span class="k">def</span> <span class="nf">solvent_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">igb1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">igb7</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add solvent reference energies, copying the GB reference energies if</span>
<span class="sd">        none are explicitly given</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">igb1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">igb1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb1</span>
        <span class="k">if</span> <span class="n">igb2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">igb2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb2</span>
        <span class="k">if</span> <span class="n">igb5</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">igb5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb5</span>
        <span class="k">if</span> <span class="n">igb7</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">igb7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb7</span>
        <span class="k">if</span> <span class="n">igb8</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">igb8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="p">,</span> <span class="n">igb2</span><span class="p">,</span> <span class="n">igb5</span><span class="p">,</span> <span class="n">igb7</span><span class="p">,</span> <span class="n">igb8</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dielc2_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">igb1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">igb7</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add reference energies for a dielectric constant of 2.0. Since this has</span>
<span class="sd">        no reason to be near the original reference energies, do not use those</span>
<span class="sd">        in place of energies that aren&#39;t provided</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dielc2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="p">,</span> <span class="n">igb2</span><span class="p">,</span> <span class="n">igb5</span><span class="p">,</span> <span class="n">igb7</span><span class="p">,</span> <span class="n">igb8</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_pKa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pKa</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjusts the reference energies based on the pKa. If the reference energy</span>
<span class="sd">        is given for a deprotonated state, the pKa adjustment is subtracted from</span>
<span class="sd">        the reference energy. Otherwise, this state is a &#39;protonated&#39; state, so</span>
<span class="sd">        the pKa adjustment is added to the reference energy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pKa_is_set</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pKa_is_set</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KB</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LN_TO_LOG</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEMP</span> <span class="o">*</span> <span class="n">pKa</span>

        <span class="k">if</span> <span class="n">deprotonated</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb1</span> <span class="o">-=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb2</span> <span class="o">-=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb5</span> <span class="o">-=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb7</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb7</span> <span class="o">-=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb8</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb8</span> <span class="o">-=</span> <span class="n">factor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb1</span> <span class="o">+=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb2</span> <span class="o">+=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb5</span> <span class="o">+=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb7</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb7</span> <span class="o">+=</span> <span class="n">factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb8</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">igb8</span> <span class="o">+=</span> <span class="n">factor</span>
        <span class="c"># Now apply the correction to our solvent reference energies if we have</span>
        <span class="c"># them (and dielectric-2 energies, if we have them)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;solvent&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="n">pKa</span><span class="p">,</span> <span class="n">deprotonated</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;dielc2&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="n">pKa</span><span class="p">,</span> <span class="n">deprotonated</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">_LineBuffer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Buffer to add lines to the cpin file &quot;&quot;&quot;</span>

    <span class="n">CHARS_PER_LINE</span> <span class="o">=</span> <span class="mi">80</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">file</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="nb">file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">add_word</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHARS_PER_LINE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span> <span class="o">=</span> <span class="s">&#39; </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">word</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span> <span class="o">+=</span> <span class="n">word</span>

    <span class="k">def</span> <span class="nf">add_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">space_delimited</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds multiple words &quot;&quot;&quot;</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">space_delimited</span><span class="p">:</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="n">word</span> <span class="o">+</span> <span class="n">extra</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Flushes this buffer to the file &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linebuffer</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

<div class="viewcode-block" id="TitratableResidue"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue">[docs]</a><span class="k">class</span> <span class="nc">TitratableResidue</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A residue with different protonation states defined for Amber for use in</span>
<span class="sd">    the Constant pH MD method implemented in sander</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resname</span><span class="p">,</span> <span class="n">atom_list</span><span class="p">,</span> <span class="n">pka</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resname</span> <span class="o">=</span> <span class="n">resname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_list</span><span class="p">)</span> <span class="c"># list of atom names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_state</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pKa</span> <span class="o">=</span> <span class="n">pka</span>

    <span class="k">def</span> <span class="nf">_str_refenes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solvent</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">igb</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dielc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all reference energies into a formatted string with a message</span>
<span class="sd">        saying if the energy is not set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">igb</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">igb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solvent</span><span class="p">:</span>
            <span class="n">_getattr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">state</span><span class="p">,</span> <span class="n">igb</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">solvent</span><span class="p">,</span> <span class="s">&#39;igb</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">igb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_getattr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">state</span><span class="p">,</span> <span class="n">igb</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s">&#39;igb</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">igb</span><span class="p">)</span>

        <span class="n">ret_str</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dielc</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">refene</span> <span class="o">=</span> <span class="n">_getattr</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">refene</span><span class="o">.</span><span class="n">dielc2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">igb</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">refene</span> <span class="o">=</span> <span class="n">_getattr</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">refene</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">igb</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">refene</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%12s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="s">&#39;Not Set&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%12.5f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">refene</span>

        <span class="k">return</span> <span class="n">ret_str</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret_str</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%-4s</span><span class="se">\t</span><span class="s">pKa = </span><span class="si">%5.1f</span><span class="se">\n</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pKa</span><span class="p">,</span> <span class="s">&#39;ATOM&#39;</span><span class="p">)</span> <span class="o">+</span>
                   <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%12s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;STATE </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                           <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">))])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_list</span><span class="p">):</span>
            <span class="n">ret_str</span> <span class="o">+=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">atom</span> <span class="o">+</span>
                        <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%12.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">charges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="p">)</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">))</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="s">&#39;Prot Cnt&#39;</span> <span class="o">+</span>
                    <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%12d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">protcnt</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">])</span> <span class="o">+</span>
                    <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">))</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="p">(</span><span class="s">&#39;Reference Energies (ES = Explicit solvent, IS = Implicit &#39;</span>
                    <span class="s">&#39;solvent)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=1 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=2 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=5 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=7 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=8 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=1 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=2 ES&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=5 ES&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=7 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=8 ES&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">))</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;Reference Energies for Internal Dielectric of 2.0</span><span class="se">\n\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=1 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=2 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=5 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=7 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=8 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=1 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=2 ES&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=5 ES&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=7 IS&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%8s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;igb=8 ES&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_refenes</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="k">return</span> <span class="n">ret_str</span>

<div class="viewcode-block" id="TitratableResidue.add_state"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.add_state">[docs]</a>    <span class="k">def</span> <span class="nf">add_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protcnt</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">refene</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add a single titratable state for this titratable residue &quot;&quot;&quot;</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">_State</span><span class="p">(</span><span class="n">protcnt</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">refene</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_state</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CpinResidueError</span><span class="p">(</span><span class="s">&#39;Wrong number of charges for new state&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TitratableResidue.add_states"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.add_states">[docs]</a>    <span class="k">def</span> <span class="nf">add_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protcnts</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">refenes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add multiple titratable states for this titratable residue &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">protcnts</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">charges</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">protcnts</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">refenes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CpinResidueError</span><span class="p">(</span><span class="s">&#39;Inconsistent list of parameters for &#39;</span>
                                   <span class="s">&#39;TitratableResidue.add_states&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">protcnts</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">charges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">refenes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="TitratableResidue.cpin_pointers"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.cpin_pointers">[docs]</a>    <span class="k">def</span> <span class="nf">cpin_pointers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_atom</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets and returns the cpin info &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_state</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_charge</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CpinResidueError</span><span class="p">(</span><span class="s">&#39;Must set residue pointers before writing &#39;</span>
                                    <span class="s">&#39;cpin info!&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&#39;FIRST_ATOM&#39;</span> <span class="p">:</span> <span class="n">first_atom</span><span class="p">,</span>
                <span class="s">&#39;FIRST_CHARGE&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_charge</span><span class="p">,</span>
                <span class="s">&#39;FIRST_STATE&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_state</span><span class="p">,</span>
                <span class="s">&#39;NUM_ATOMS&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_list</span><span class="p">),</span>
                <span class="s">&#39;NUM_STATES&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)}</span>
</div>
<div class="viewcode-block" id="TitratableResidue.set_first_state"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.set_first_state">[docs]</a>    <span class="k">def</span> <span class="nf">set_first_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets the first state index &quot;&quot;&quot;</span>
        <span class="c"># Has the first state already been set?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_state</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_state</span> <span class="o">=</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="TitratableResidue.set_first_charge"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.set_first_charge">[docs]</a>    <span class="k">def</span> <span class="nf">set_first_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets the first charge index &quot;&quot;&quot;</span>
        <span class="c"># Has it already been set?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_charge</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_charge</span> <span class="o">=</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="TitratableResidue.reset"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Resets the pointers &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_state</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</div>
<div class="viewcode-block" id="TitratableResidue.check"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidue.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks that the charges are consistent w/ the protonation states &quot;&quot;&quot;</span>
        <span class="n">sum_charges</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">]</span>
        <span class="n">protcnts</span> <span class="o">=</span> <span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">protcnt</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">]</span>
        <span class="c"># All we have to do is make sure that the charges/proton counts are</span>
        <span class="c"># consistent between the first state and every other state</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sum_charges</span><span class="p">)):</span>
            <span class="n">charge_diff</span> <span class="o">=</span> <span class="n">sum_charges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">sum_charges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">prot_diff</span> <span class="o">=</span> <span class="n">protcnts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">protcnts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">charge_diff</span> <span class="o">-</span> <span class="n">prot_diff</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0001</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Inconsistencies detected in charge definitions &#39;</span>
                              <span class="s">&#39;in </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">CpinChargeWarning</span><span class="p">)</span>
        <span class="c"># Check all of the reference energies to make sure that the pKa was set</span>
        <span class="c"># for all but one of them</span>
        <span class="n">notset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
            <span class="n">notset</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">refene</span><span class="o">.</span><span class="n">pKa_is_set</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">notset</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Not enough states are pKa-adjusted in </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">resname</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atom</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">first_atom</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atom</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">first_atom</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atom</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">first_atom</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atom</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">first_atom</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atom</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">first_atom</span>
</div>
<div class="viewcode-block" id="TitratableResidueList"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidueList">[docs]</a><span class="k">class</span> <span class="nc">TitratableResidueList</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; List of all titratable residues &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s">&#39;Unknown&#39;</span><span class="p">,</span> <span class="n">solvated</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">first_solvent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resstates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">system_name</span> <span class="o">=</span> <span class="n">system_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solvated</span> <span class="o">=</span> <span class="n">solvated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_sol</span> <span class="o">=</span> <span class="n">first_solvent</span>
   
<div class="viewcode-block" id="TitratableResidueList.add_residue"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidueList.add_residue">[docs]</a>    <span class="k">def</span> <span class="nf">add_residue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">resnum</span><span class="p">,</span> <span class="n">first_atom</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a residue to the list &quot;&quot;&quot;</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_atom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resnum</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CpinInputError</span><span class="p">(</span><span class="s">&#39;Residue </span><span class="si">%s</span><span class="s"> only has states 0-</span><span class="si">%d</span><span class="s"> (</span><span class="si">%d</span><span class="s"> chosen)&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">states</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resstates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TitratableResidueList.set_states"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidueList.set_states">[docs]</a>    <span class="k">def</span> <span class="nf">set_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">statelist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the initial protonation states from a list -- make sure there are</span>
<span class="sd">        enough states in the list to set every residue, or emit a warning</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">statelist</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">((</span><span class="s">&#39;Number of states (</span><span class="si">%d</span><span class="s">) does not equal number of &#39;</span>
                            <span class="s">&#39;residues (</span><span class="si">%d</span><span class="s">). Using default initial states.&#39;</span><span class="p">)</span> <span class="o">%</span>
                            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">statelist</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span> <span class="n">CpinInputWarning</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c"># Check that all states are allowable</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">statelist</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">state</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">CpinInputError</span><span class="p">(</span><span class="s">&#39;Bad state choice (</span><span class="si">%d</span><span class="s">). Minimum is 0, &#39;</span>
                            <span class="s">&#39;maximum is </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">states</span><span class="p">)))</span>
        <span class="c"># If we got here, then we are OK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resstates</span> <span class="o">=</span> <span class="n">statelist</span>
</div>
<div class="viewcode-block" id="TitratableResidueList.sort"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidueList.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sorts by residue number &quot;&quot;&quot;</span>
        <span class="c"># Bubble sort, cuz who cares?</span>
        <span class="n">nswaps</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">nswaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nswaps</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">nswaps</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="TitratableResidueList.write_cpin"><a class="viewcode-back" href="../../../api/chemistry/chemistry.amber.titratable_residues.html#chemistry.amber.titratable_residues.TitratableResidueList.write_cpin">[docs]</a>    <span class="k">def</span> <span class="nf">write_cpin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">igb</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">intdiel</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">coions</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Writes the CPIN file based on the titrated residues &quot;&quot;&quot;</span>
        <span class="c"># Reset all residues</span>
        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span> <span class="n">res</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="c"># Sort our residue list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">_LineBuffer</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;&amp;CNSTPH&#39;</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39; CHRGDAT=&#39;</span><span class="p">)</span>
        <span class="n">charges</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">protcnts</span><span class="p">,</span> <span class="n">pointers</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">first_charge</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">first_state</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">first_charge</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">set_first_charge</span><span class="p">(</span><span class="n">first_charge</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">set_first_state</span><span class="p">(</span><span class="n">first_state</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
                    <span class="c"># See which dielectric reference energies we want</span>
                    <span class="k">if</span> <span class="n">intdiel</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">refene</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">refene</span><span class="o">.</span><span class="n">dielc2</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">refene</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">refene</span>
                    <span class="c"># See if we want the explicit solvent refene or not</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvated</span><span class="p">:</span>
                        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">refene</span><span class="o">.</span><span class="n">solvent</span><span class="p">,</span> <span class="s">&#39;igb</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">igb</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">refene</span><span class="p">,</span> <span class="s">&#39;igb</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">igb</span><span class="p">))</span>
                    <span class="c"># Add protonation count of this state</span>
                    <span class="n">protcnts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">protcnt</span><span class="p">)</span>

                <span class="n">first_state</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
                <span class="n">new_charges</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
                    <span class="n">new_charges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
                <span class="n">charges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_charges</span><span class="p">)</span>
                <span class="n">first_charge</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_charges</span><span class="p">)</span>
            <span class="n">pointers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">cpin_pointers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="c"># Print the charges</span>
        <span class="k">for</span> <span class="n">charge</span> <span class="ow">in</span> <span class="n">charges</span><span class="p">:</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">,&#39;</span> <span class="o">%</span> <span class="n">charge</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c"># Print the protcnts</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39; PROTCNT=&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">protcnt</span> <span class="ow">in</span> <span class="n">protcnts</span><span class="p">:</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">,&#39;</span> <span class="o">%</span> <span class="n">protcnt</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c"># Print the residue names</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot; RESNAME=&#39;System: </span><span class="si">%s</span><span class="s">&#39;,&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot;&#39;Residue: </span><span class="si">%s</span><span class="s"> </span><span class="si">%d</span><span class="s">&#39;,&quot;</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c"># Print the residue states</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot; RESSTATE=&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resstates</span><span class="p">:</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">,&#39;</span> <span class="o">%</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c"># Print the residue pointers</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="c"># get a leading space</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pointers</span><span class="p">):</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot;STATEINF(</span><span class="si">%d</span><span class="s">)</span><span class="si">%%</span><span class="s">FIRST_ATOM=</span><span class="si">%d</span><span class="s">, &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="s">&#39;FIRST_ATOM&#39;</span><span class="p">]))</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot;STATEINF(</span><span class="si">%d</span><span class="s">)</span><span class="si">%%</span><span class="s">FIRST_CHARGE=</span><span class="si">%d</span><span class="s">, &quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="s">&#39;FIRST_CHARGE&#39;</span><span class="p">]))</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot;STATEINF(</span><span class="si">%d</span><span class="s">)</span><span class="si">%%</span><span class="s">FIRST_STATE=</span><span class="si">%d</span><span class="s">, &quot;</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="s">&#39;FIRST_STATE&#39;</span><span class="p">]))</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot;STATEINF(</span><span class="si">%d</span><span class="s">)</span><span class="si">%%</span><span class="s">NUM_ATOMS=</span><span class="si">%d</span><span class="s">, &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="s">&#39;NUM_ATOMS&#39;</span><span class="p">]))</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&quot;STATEINF(</span><span class="si">%d</span><span class="s">)</span><span class="si">%%</span><span class="s">NUM_STATES=</span><span class="si">%d</span><span class="s">, &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="s">&#39;NUM_STATES&#39;</span><span class="p">]))</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c"># Print the reference energies</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39; STATENE=&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">energy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">energies</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">energy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CpinInputError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&#39;th reference energy not known for &quot;</span>
                                     <span class="s">&quot;igb = </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">igb</span><span class="p">))</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">,&#39;</span> <span class="o">%</span> <span class="n">energy</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c"># Print the # of residues and explicit solvent info if required</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39; TRESCNT=</span><span class="si">%d</span><span class="s">,&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvated</span><span class="p">:</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;CPHFIRST_SOL=</span><span class="si">%d</span><span class="s">, CPH_IGB=</span><span class="si">%d</span><span class="s">, CPH_INTDIEL=</span><span class="si">%s</span><span class="s">, &#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first_sol</span><span class="p">,</span> <span class="n">igb</span><span class="p">,</span> <span class="n">intdiel</span><span class="p">))</span>
            <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="c"># Now scan through all of the waters</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">add_word</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">);</span> <span class="n">buf</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="c"># Now define all of the titratable residues</span>

<span class="c"># Aspartate</span></div></div>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mf">21.4298008</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mf">26.8894581</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">26.5980488</span><span class="p">,</span>
                 <span class="n">igb7</span><span class="o">=</span><span class="mf">23.4181107</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mf">26.3448911</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">33.2613028</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">12.676908</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">13.084913</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">AS4</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;AS4&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;CA&#39;</span><span class="p">,</span> <span class="s">&#39;HA&#39;</span><span class="p">,</span> <span class="s">&#39;CB&#39;</span><span class="p">,</span> <span class="s">&#39;HB2&#39;</span><span class="p">,</span> <span class="s">&#39;HB3&#39;</span><span class="p">,</span> <span class="s">&#39;CG&#39;</span><span class="p">,</span>
                        <span class="s">&#39;OD1&#39;</span><span class="p">,</span> <span class="s">&#39;OD2&#39;</span><span class="p">,</span> <span class="s">&#39;HD21&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">,</span> <span class="s">&#39;HD22&#39;</span><span class="p">,</span> <span class="s">&#39;HD11&#39;</span><span class="p">,</span> <span class="s">&#39;HD12&#39;</span><span class="p">],</span>
                        <span class="n">pka</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
<span class="n">AS4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0341</span><span class="p">,</span> <span class="mf">0.0864</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1783</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0122</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0122</span><span class="p">,</span> <span class="mf">0.7994</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8014</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8014</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
              <span class="mf">0.0</span><span class="p">])</span>
<span class="n">AS4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated syn-O2</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0341</span><span class="p">,</span> <span class="mf">0.0864</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0316</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span>
              <span class="mf">0.6462</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6376</span><span class="p">,</span> <span class="mf">0.4747</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">AS4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated anti-O2</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0341</span><span class="p">,</span> <span class="mf">0.0864</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0316</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span>
              <span class="mf">0.6462</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6376</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.4747</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">AS4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated syn-O1</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0341</span><span class="p">,</span> <span class="mf">0.0864</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0316</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span>
              <span class="mf">0.6462</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6376</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5554</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4747</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">AS4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated anti-O1</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0341</span><span class="p">,</span> <span class="mf">0.0864</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0316</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span>
              <span class="mf">0.6462</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6376</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5554</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4747</span><span class="p">])</span>
<span class="n">AS4</span><span class="o">.</span><span class="n">check</span><span class="p">()</span> <span class="c"># check that everything is consistent</span>

<span class="c"># Glutamate</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mf">3.89691326</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mf">8.4057785</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">8.0855764</span><span class="p">,</span>
               <span class="n">igb7</span><span class="o">=</span><span class="mf">5.305949</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mf">8.3591335</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">15.20019319</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">3.455596</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">3.957270</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">4.4</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">GL4</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;GL4&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;CA&#39;</span><span class="p">,</span> <span class="s">&#39;HA&#39;</span><span class="p">,</span> <span class="s">&#39;CB&#39;</span><span class="p">,</span> <span class="s">&#39;HB2&#39;</span><span class="p">,</span> <span class="s">&#39;HB3&#39;</span><span class="p">,</span> <span class="s">&#39;CG&#39;</span><span class="p">,</span>
                        <span class="s">&#39;HG2&#39;</span><span class="p">,</span> <span class="s">&#39;HG3&#39;</span><span class="p">,</span> <span class="s">&#39;CD&#39;</span><span class="p">,</span> <span class="s">&#39;OE1&#39;</span><span class="p">,</span> <span class="s">&#39;OE2&#39;</span><span class="p">,</span> <span class="s">&#39;HE21&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">,</span>
                        <span class="s">&#39;HE22&#39;</span><span class="p">,</span> <span class="s">&#39;HE11&#39;</span><span class="p">,</span> <span class="s">&#39;HE12&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">4.4</span><span class="p">)</span>
<span class="n">GL4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0145</span><span class="p">,</span> <span class="mf">0.0779</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0398</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0173</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0173</span><span class="p">,</span> <span class="mf">0.0136</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0425</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0425</span><span class="p">,</span> <span class="mf">0.8054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8188</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8188</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
              <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">GL4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated syn-O2</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0145</span><span class="p">,</span> <span class="mf">0.0779</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0071</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0174</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.6801</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6511</span><span class="p">,</span> <span class="mf">0.4641</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">GL4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated anti-O2</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0145</span><span class="p">,</span> <span class="mf">0.0779</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0071</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0174</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.6801</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6511</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.4641</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">GL4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated syn-O1</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0145</span><span class="p">,</span> <span class="mf">0.0779</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0071</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0174</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.6801</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6511</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5838</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4641</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">GL4</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated syn-O2</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0145</span><span class="p">,</span> <span class="mf">0.0779</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0071</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span> <span class="mf">0.0256</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0174</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.0430</span><span class="p">,</span> <span class="mf">0.6801</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6511</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5838</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5679</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4641</span><span class="p">])</span>
<span class="n">GL4</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Tyrosine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">65.113428</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">64.166385</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=-</span><span class="mf">61.3305355</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">65.003415</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">64.047229</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">32.167520</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">31.751177</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">9.6</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">TYR</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;TYR&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;CA&#39;</span><span class="p">,</span> <span class="s">&#39;HA&#39;</span><span class="p">,</span> <span class="s">&#39;CB&#39;</span><span class="p">,</span> <span class="s">&#39;HB2&#39;</span><span class="p">,</span> <span class="s">&#39;HB3&#39;</span><span class="p">,</span> <span class="s">&#39;CG&#39;</span><span class="p">,</span>
                        <span class="s">&#39;CD1&#39;</span><span class="p">,</span> <span class="s">&#39;HD1&#39;</span><span class="p">,</span> <span class="s">&#39;CE1&#39;</span><span class="p">,</span> <span class="s">&#39;HE1&#39;</span><span class="p">,</span> <span class="s">&#39;CZ&#39;</span><span class="p">,</span> <span class="s">&#39;OH&#39;</span><span class="p">,</span> <span class="s">&#39;HH&#39;</span><span class="p">,</span> <span class="s">&#39;CE2&#39;</span><span class="p">,</span>
                        <span class="s">&#39;HE2&#39;</span><span class="p">,</span> <span class="s">&#39;CD2&#39;</span><span class="p">,</span> <span class="s">&#39;HD2&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">9.6</span><span class="p">)</span>
<span class="n">TYR</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.0876</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0152</span><span class="p">,</span> <span class="mf">0.0295</span><span class="p">,</span>
              <span class="mf">0.0295</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0011</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1906</span><span class="p">,</span> <span class="mf">0.1699</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2341</span><span class="p">,</span> <span class="mf">0.1656</span><span class="p">,</span> <span class="mf">0.3226</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5579</span><span class="p">,</span> <span class="mf">0.3992</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2341</span><span class="p">,</span> <span class="mf">0.1656</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1906</span><span class="p">,</span> <span class="mf">0.1699</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5679</span><span class="p">])</span>
<span class="n">TYR</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.0876</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0858</span><span class="p">,</span> <span class="mf">0.0190</span><span class="p">,</span>
              <span class="mf">0.0190</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2130</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1030</span><span class="p">,</span> <span class="mf">0.1320</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4980</span><span class="p">,</span> <span class="mf">0.1320</span><span class="p">,</span> <span class="mf">0.7770</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.8140</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4980</span><span class="p">,</span> <span class="mf">0.1320</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1030</span><span class="p">,</span> <span class="mf">0.1320</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">])</span>
<span class="n">TYR</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Histidine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb7</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=-</span><span class="mf">4.208863</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=-</span><span class="mf">2.84183</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">2.86001</span><span class="p">,</span>
               <span class="n">igb7</span><span class="o">=-</span><span class="mf">1.741947</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=-</span><span class="mf">3.4000</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">2.77641</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">2.90517</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">1.628110</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">1.691093</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">refene3</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb1</span><span class="o">=-</span><span class="mf">8.230643</span><span class="p">,</span> <span class="n">igb2</span><span class="o">=-</span><span class="mf">6.58793</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">6.70726</span><span class="p">,</span>
               <span class="n">igb7</span><span class="o">=-</span><span class="mf">5.118453</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=-</span><span class="mf">6.3190</span><span class="p">)</span>
<span class="n">refene3</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">6.483630</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">6.82684</span><span class="p">)</span>
<span class="n">refene3</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">3.444200</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">3.070113</span><span class="p">)</span>
<span class="n">refene3</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene3</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">7.1</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">HIP</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;HIP&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;CA&#39;</span><span class="p">,</span> <span class="s">&#39;HA&#39;</span><span class="p">,</span> <span class="s">&#39;CB&#39;</span><span class="p">,</span> <span class="s">&#39;HB2&#39;</span><span class="p">,</span> <span class="s">&#39;HB3&#39;</span><span class="p">,</span> <span class="s">&#39;CG&#39;</span><span class="p">,</span>
                        <span class="s">&#39;ND1&#39;</span><span class="p">,</span> <span class="s">&#39;HD1&#39;</span><span class="p">,</span> <span class="s">&#39;CE1&#39;</span><span class="p">,</span> <span class="s">&#39;HE1&#39;</span><span class="p">,</span> <span class="s">&#39;NE2&#39;</span><span class="p">,</span> <span class="s">&#39;HE2&#39;</span><span class="p">,</span> <span class="s">&#39;CD2&#39;</span><span class="p">,</span> <span class="s">&#39;HD2&#39;</span><span class="p">,</span>
                        <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">6.6</span><span class="p">)</span>
<span class="n">HIP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># HIP</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.3479</span><span class="p">,</span> <span class="mf">0.2747</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1354</span><span class="p">,</span> <span class="mf">0.1212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0414</span><span class="p">,</span> <span class="mf">0.0810</span><span class="p">,</span>
              <span class="mf">0.0810</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1513</span><span class="p">,</span> <span class="mf">0.3866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0170</span><span class="p">,</span> <span class="mf">0.2681</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1718</span><span class="p">,</span>
              <span class="mf">0.3911</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1141</span><span class="p">,</span> <span class="mf">0.2317</span><span class="p">,</span> <span class="mf">0.7341</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5894</span><span class="p">])</span>
<span class="n">HIP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># HID</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.3479</span><span class="p">,</span> <span class="mf">0.2747</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1354</span><span class="p">,</span> <span class="mf">0.1212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1110</span><span class="p">,</span> <span class="mf">0.0402</span><span class="p">,</span>
              <span class="mf">0.0402</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0266</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3811</span><span class="p">,</span> <span class="mf">0.3649</span><span class="p">,</span> <span class="mf">0.2057</span><span class="p">,</span> <span class="mf">0.1392</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5727</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
              <span class="mf">0.1292</span><span class="p">,</span> <span class="mf">0.1147</span><span class="p">,</span> <span class="mf">0.7341</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5894</span><span class="p">])</span>
<span class="n">HIP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene3</span><span class="p">,</span> <span class="c"># HIE</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.3479</span><span class="p">,</span> <span class="mf">0.2747</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1354</span><span class="p">,</span> <span class="mf">0.1212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1012</span><span class="p">,</span> <span class="mf">0.0367</span><span class="p">,</span>
              <span class="mf">0.0367</span><span class="p">,</span> <span class="mf">0.1868</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5432</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1635</span><span class="p">,</span> <span class="mf">0.1435</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2795</span><span class="p">,</span> <span class="mf">0.3339</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.2207</span><span class="p">,</span> <span class="mf">0.1862</span><span class="p">,</span> <span class="mf">0.7341</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5894</span><span class="p">])</span>
<span class="n">HIP</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Lysine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">15.2423959</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">14.5392838</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=-</span><span class="mf">18.393654</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">15.1417977</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">14.3152107</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">7.239587</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">6.825997</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">10.4</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>

<span class="n">LYS</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;LYS&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;CA&#39;</span><span class="p">,</span> <span class="s">&#39;HA&#39;</span><span class="p">,</span> <span class="s">&#39;CB&#39;</span><span class="p">,</span> <span class="s">&#39;HB2&#39;</span><span class="p">,</span> <span class="s">&#39;HB3&#39;</span><span class="p">,</span> <span class="s">&#39;CG&#39;</span><span class="p">,</span>
                        <span class="s">&#39;HG2&#39;</span><span class="p">,</span> <span class="s">&#39;HG3&#39;</span><span class="p">,</span> <span class="s">&#39;CD&#39;</span><span class="p">,</span> <span class="s">&#39;HD2&#39;</span><span class="p">,</span> <span class="s">&#39;HD3&#39;</span><span class="p">,</span> <span class="s">&#39;CE&#39;</span><span class="p">,</span> <span class="s">&#39;HE2&#39;</span> <span class="p">,</span><span class="s">&#39;HE3&#39;</span><span class="p">,</span>
                        <span class="s">&#39;NZ&#39;</span><span class="p">,</span> <span class="s">&#39;HZ1&#39;</span><span class="p">,</span> <span class="s">&#39;HZ2&#39;</span><span class="p">,</span> <span class="s">&#39;HZ3&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">10.4</span><span class="p">)</span>
<span class="n">LYS</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.3479</span><span class="p">,</span> <span class="mf">0.2747</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2400</span><span class="p">,</span> <span class="mf">0.1426</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0094</span><span class="p">,</span> <span class="mf">0.0362</span><span class="p">,</span>
              <span class="mf">0.0362</span><span class="p">,</span> <span class="mf">0.0187</span><span class="p">,</span> <span class="mf">0.0103</span><span class="p">,</span> <span class="mf">0.0103</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0479</span><span class="p">,</span> <span class="mf">0.0621</span><span class="p">,</span> <span class="mf">0.0621</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0143</span><span class="p">,</span>
              <span class="mf">0.1135</span><span class="p">,</span> <span class="mf">0.1135</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3854</span><span class="p">,</span> <span class="mf">0.3400</span><span class="p">,</span> <span class="mf">0.3400</span><span class="p">,</span> <span class="mf">0.3400</span><span class="p">,</span> <span class="mf">0.7341</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5894</span><span class="p">])</span>
<span class="n">LYS</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.3479</span><span class="p">,</span> <span class="mf">0.2747</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2400</span><span class="p">,</span> <span class="mf">0.1426</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10961</span><span class="p">,</span> <span class="mf">0.0340</span><span class="p">,</span>
              <span class="mf">0.0340</span><span class="p">,</span> <span class="mf">0.06612</span><span class="p">,</span> <span class="mf">0.01041</span><span class="p">,</span> <span class="mf">0.01041</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03768</span><span class="p">,</span> <span class="mf">0.01155</span><span class="p">,</span> <span class="mf">0.01155</span><span class="p">,</span>
              <span class="mf">0.32604</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03358</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03358</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.03581</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.38604</span><span class="p">,</span> <span class="mf">0.38604</span><span class="p">,</span>
              <span class="mf">0.7341</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5894</span><span class="p">])</span>
<span class="n">LYS</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Cysteine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">77.4666763</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">76.2588331</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mf">71.5804519</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">77.6041407</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">76.2827217</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">38.090523</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">37.454637</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">38.489170</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>

<span class="n">CYS</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;CYS&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;CA&#39;</span><span class="p">,</span> <span class="s">&#39;HA&#39;</span><span class="p">,</span> <span class="s">&#39;CB&#39;</span><span class="p">,</span> <span class="s">&#39;HB2&#39;</span><span class="p">,</span> <span class="s">&#39;HB3&#39;</span><span class="p">,</span> <span class="s">&#39;SG&#39;</span><span class="p">,</span>
                        <span class="s">&#39;HG&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;O&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">8.5</span><span class="p">)</span>
<span class="n">CYS</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0213</span><span class="p">,</span> <span class="mf">0.1124</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1231</span><span class="p">,</span> <span class="mf">0.1112</span><span class="p">,</span> <span class="mf">0.1112</span><span class="p">,</span>
                       <span class="o">-</span><span class="mf">0.3119</span><span class="p">,</span> <span class="mf">0.1933</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">])</span>
<span class="n">CYS</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.4157</span><span class="p">,</span> <span class="mf">0.2719</span><span class="p">,</span> <span class="mf">0.0213</span><span class="p">,</span> <span class="mf">0.1124</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3593</span><span class="p">,</span> <span class="mf">0.1122</span><span class="p">,</span> <span class="mf">0.1122</span><span class="p">,</span>
                       <span class="o">-</span><span class="mf">0.8844</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5679</span><span class="p">])</span>
<span class="n">CYS</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Deoxy-adenine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">19.8442</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">19.8442</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">9.106013</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">9.404867</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">9.779586</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>

<span class="n">DAP</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;DAP&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                        <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N9&#39;</span><span class="p">,</span> <span class="s">&#39;C8&#39;</span><span class="p">,</span> <span class="s">&#39;H8&#39;</span><span class="p">,</span>
                        <span class="s">&#39;N7&#39;</span><span class="p">,</span> <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;N6&#39;</span><span class="p">,</span> <span class="s">&#39;H61&#39;</span><span class="p">,</span> <span class="s">&#39;H62&#39;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;H2&#39;</span><span class="p">,</span>
                        <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;2&quot;</span><span class="p">,</span> <span class="s">&quot;O3&#39;&quot;</span><span class="p">,</span>
                        <span class="s">&#39;H1&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">3.9</span><span class="p">)</span>
<span class="n">DAP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
              <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="mf">0.0431</span><span class="p">,</span> <span class="mf">0.1838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0268</span><span class="p">,</span> <span class="mf">0.1607</span><span class="p">,</span>
              <span class="mf">0.1877</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6175</span><span class="p">,</span> <span class="mf">0.0725</span><span class="p">,</span> <span class="mf">0.6897</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9123</span><span class="p">,</span> <span class="mf">0.4167</span><span class="p">,</span> <span class="mf">0.4167</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7624</span><span class="p">,</span>
              <span class="mf">0.5716</span><span class="p">,</span> <span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7417</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span>
              <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">DAP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
              <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="mf">0.0431</span><span class="p">,</span> <span class="mf">0.1838</span><span class="p">,</span> <span class="mf">0.0944</span><span class="p">,</span> <span class="mf">0.1617</span><span class="p">,</span>
              <span class="mf">0.2281</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5674</span><span class="p">,</span> <span class="mf">0.1358</span><span class="p">,</span> <span class="mf">0.5711</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8251</span><span class="p">,</span> <span class="mf">0.4456</span><span class="p">,</span> <span class="mf">0.4456</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.575</span><span class="p">,</span>
              <span class="mf">0.4251</span><span class="p">,</span> <span class="mf">0.1437</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5611</span><span class="p">,</span> <span class="mf">0.3421</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span>
              <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">,</span> <span class="mf">0.4301</span><span class="p">])</span>
<span class="n">DAP</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Deoxy-cytosine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">40.526</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">40.526</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">19.447553</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">19.842087</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">20.121129</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">4.3</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>

<span class="n">DCP</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;DCP&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                        <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;H6&#39;</span><span class="p">,</span>
                        <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;H5&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&#39;N4&#39;</span><span class="p">,</span> <span class="s">&#39;H41&#39;</span><span class="p">,</span> <span class="s">&#39;H42&#39;</span><span class="p">,</span> <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;O2&#39;</span><span class="p">,</span>
                        <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;2&quot;</span><span class="p">,</span> <span class="s">&quot;O3&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;H3&#39;</span><span class="p">],</span>
                        <span class="n">pka</span><span class="o">=</span><span class="mf">4.3</span><span class="p">)</span>
<span class="n">DCP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># deprotonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
              <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0116</span><span class="p">,</span> <span class="mf">0.1963</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0339</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.0183</span><span class="p">,</span> <span class="mf">0.2293</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5222</span><span class="p">,</span> <span class="mf">0.1863</span><span class="p">,</span> <span class="mf">0.8439</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9773</span><span class="p">,</span> <span class="mf">0.4314</span><span class="p">,</span> <span class="mf">0.4314</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.7748</span><span class="p">,</span> <span class="mf">0.7959</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6548</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">0.5232</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">DCP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated</span>
              <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
              <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0116</span><span class="p">,</span> <span class="mf">0.1963</span><span class="p">,</span> <span class="mf">0.2167</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0282</span><span class="p">,</span>
              <span class="mf">0.2713</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4162</span><span class="p">,</span> <span class="mf">0.2179</span><span class="p">,</span> <span class="mf">0.6653</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.859</span><span class="p">,</span> <span class="mf">0.4598</span><span class="p">,</span> <span class="mf">0.4598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4956</span><span class="p">,</span>
              <span class="mf">0.5371</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5028</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">,</span>
              <span class="mf">0.4108</span><span class="p">])</span>
<span class="n">DCP</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Deoxy-guanine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">90.0011</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">90.0011</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">44.031593</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">43.588343</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">45.090067</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">9.2</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">DG</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;DG&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                       <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N9&#39;</span><span class="p">,</span> <span class="s">&#39;C8&#39;</span><span class="p">,</span> <span class="s">&#39;H8&#39;</span><span class="p">,</span>
                       <span class="s">&#39;N7&#39;</span><span class="p">,</span> <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;O6&#39;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;H1&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;N2&#39;</span><span class="p">,</span> <span class="s">&#39;H21&#39;</span><span class="p">,</span>
                       <span class="s">&#39;H22&#39;</span><span class="p">,</span> <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;2&quot;</span><span class="p">,</span>
                       <span class="s">&quot;O3&#39;&quot;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">9.2</span><span class="p">)</span>
<span class="n">DG</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
             <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="mf">0.0358</span><span class="p">,</span> <span class="mf">0.1746</span><span class="p">,</span> <span class="mf">0.0577</span><span class="p">,</span> <span class="mf">0.0736</span><span class="p">,</span>
             <span class="mf">0.1997</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5725</span><span class="p">,</span> <span class="mf">0.1991</span><span class="p">,</span> <span class="mf">0.4918</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5699</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5053</span><span class="p">,</span> <span class="mf">0.352</span><span class="p">,</span> <span class="mf">0.7432</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.923</span><span class="p">,</span> <span class="mf">0.4235</span><span class="p">,</span> <span class="mf">0.4235</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6636</span><span class="p">,</span> <span class="mf">0.1814</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span>
             <span class="mf">0.0718</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">])</span>
<span class="n">DG</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
             <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="mf">0.0358</span><span class="p">,</span> <span class="mf">0.1746</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0507</span><span class="p">,</span> <span class="mf">0.0779</span><span class="p">,</span>
             <span class="mf">0.1516</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6122</span><span class="p">,</span> <span class="mf">0.0806</span><span class="p">,</span> <span class="mf">0.7105</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7253</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8527</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.9561</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.9903</span><span class="p">,</span> <span class="mf">0.3837</span><span class="p">,</span> <span class="mf">0.3837</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8545</span><span class="p">,</span> <span class="mf">0.2528</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span>
             <span class="mf">0.0718</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">])</span>
<span class="n">DG</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Deoxy-thymine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">56.7729</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">56.7729</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">28.429391</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">28.085730</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">27.298290</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">9.7</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">DT</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;DT&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                       <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;H6&#39;</span><span class="p">,</span>
                       <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;C7&#39;</span><span class="p">,</span> <span class="s">&#39;H71&#39;</span><span class="p">,</span> <span class="s">&#39;H72&#39;</span><span class="p">,</span> <span class="s">&#39;H73&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&#39;O4&#39;</span><span class="p">,</span> <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;H3&#39;</span><span class="p">,</span>
                       <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;O2&#39;</span><span class="p">,</span> <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;2&quot;</span><span class="p">,</span> <span class="s">&quot;O3&#39;&quot;</span><span class="p">],</span>
                       <span class="n">pka</span><span class="o">=</span><span class="mf">9.7</span><span class="p">)</span>
<span class="n">DT</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
             <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="mf">0.068</span><span class="p">,</span> <span class="mf">0.1804</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0239</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2209</span><span class="p">,</span>
             <span class="mf">0.2607</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2269</span><span class="p">,</span> <span class="mf">0.077</span><span class="p">,</span> <span class="mf">0.077</span><span class="p">,</span> <span class="mf">0.077</span><span class="p">,</span> <span class="mf">0.5194</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5563</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.434</span><span class="p">,</span> <span class="mf">0.342</span><span class="p">,</span> <span class="mf">0.5677</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5881</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span>
             <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">])</span>
<span class="n">DT</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4954</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0069</span><span class="p">,</span> <span class="mf">0.0754</span><span class="p">,</span>
             <span class="mf">0.0754</span><span class="p">,</span> <span class="mf">0.1629</span><span class="p">,</span> <span class="mf">0.1176</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3691</span><span class="p">,</span> <span class="mf">0.068</span><span class="p">,</span> <span class="mf">0.1804</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2861</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1874</span><span class="p">,</span>
             <span class="mf">0.2251</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1092</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2602</span><span class="p">,</span> <span class="mf">0.0589</span><span class="p">,</span> <span class="mf">0.0589</span><span class="p">,</span> <span class="mf">0.0589</span><span class="p">,</span> <span class="mf">0.8263</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7396</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.9169</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.9167</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7722</span><span class="p">,</span> <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0854</span><span class="p">,</span> <span class="mf">0.0718</span><span class="p">,</span>
             <span class="mf">0.0718</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5232</span><span class="p">])</span>
<span class="n">DT</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Adenine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">14.851840012</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">15.1166001033</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">15.026098360790293</span><span class="p">,</span><span class="n">igb5</span><span class="o">=</span><span class="mf">15.143651997474915</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">6.953887</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">7.092043</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">7.544988</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">AP</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;AP&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                       <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N9&#39;</span><span class="p">,</span> <span class="s">&#39;C8&#39;</span><span class="p">,</span> <span class="s">&#39;H8&#39;</span><span class="p">,</span>
                       <span class="s">&#39;N7&#39;</span><span class="p">,</span> <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;N6&#39;</span><span class="p">,</span> <span class="s">&#39;H61&#39;</span><span class="p">,</span> <span class="s">&#39;H62&#39;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;H2&#39;</span><span class="p">,</span>
                       <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;O2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;HO&#39;2&quot;</span><span class="p">,</span>
                       <span class="s">&quot;O3&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;H1&#39;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">3.9</span><span class="p">)</span>
<span class="n">AP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># deprotonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
             <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0394</span><span class="p">,</span> <span class="mf">0.2007</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0251</span><span class="p">,</span> <span class="mf">0.2006</span><span class="p">,</span> <span class="mf">0.1553</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.6073</span><span class="p">,</span> <span class="mf">0.0515</span><span class="p">,</span> <span class="mf">0.7009</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9019</span><span class="p">,</span> <span class="mf">0.4115</span><span class="p">,</span> <span class="mf">0.4115</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7615</span><span class="p">,</span> <span class="mf">0.5875</span><span class="p">,</span>
             <span class="mf">0.0473</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6997</span><span class="p">,</span> <span class="mf">0.3053</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span>
             <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">AP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
             <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0394</span><span class="p">,</span> <span class="mf">0.2007</span><span class="p">,</span> <span class="mf">0.0961</span><span class="p">,</span> <span class="mf">0.2011</span><span class="p">,</span> <span class="mf">0.1965</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.5569</span><span class="p">,</span> <span class="mf">0.1136</span><span class="p">,</span> <span class="mf">0.5845</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8152</span><span class="p">,</span> <span class="mf">0.4403</span><span class="p">,</span> <span class="mf">0.4403</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5776</span><span class="p">,</span> <span class="mf">0.4435</span><span class="p">,</span>
             <span class="mf">0.1307</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5201</span><span class="p">,</span> <span class="mf">0.2681</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span>
             <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">,</span> <span class="mf">0.431</span><span class="p">])</span>
<span class="n">AP</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Cytosine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">37.501800178</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">38.0081251132</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">37.378544257354164</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">37.90444570773976</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mf">18.483513</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mf">19.016390</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">4.2</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">CP</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;CP&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                       <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;H6&#39;</span><span class="p">,</span>
                       <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;H5&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&#39;N4&#39;</span><span class="p">,</span> <span class="s">&#39;H41&#39;</span><span class="p">,</span> <span class="s">&#39;H42&#39;</span><span class="p">,</span> <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;O2&#39;</span><span class="p">,</span>
                       <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;O2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;HO&#39;2&quot;</span><span class="p">,</span> <span class="s">&quot;O3&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;H3&#39;</span><span class="p">],</span>
                       <span class="n">pka</span><span class="o">=</span><span class="mf">4.3</span><span class="p">)</span>
<span class="n">CP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># deprotonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
             <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0066</span><span class="p">,</span> <span class="mf">0.2029</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0484</span><span class="p">,</span> <span class="mf">0.0053</span><span class="p">,</span> <span class="mf">0.1958</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.5215</span><span class="p">,</span> <span class="mf">0.1928</span><span class="p">,</span> <span class="mf">0.8185</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.953</span><span class="p">,</span> <span class="mf">0.4234</span><span class="p">,</span> <span class="mf">0.4234</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7584</span><span class="p">,</span> <span class="mf">0.7538</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.6252</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span> <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">])</span>
<span class="n">CP</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># protonated</span>
             <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
             <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0066</span><span class="p">,</span> <span class="mf">0.2029</span><span class="p">,</span> <span class="mf">0.1954</span><span class="p">,</span> <span class="mf">0.0028</span><span class="p">,</span> <span class="mf">0.2366</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.4218</span><span class="p">,</span> <span class="mf">0.2253</span><span class="p">,</span> <span class="mf">0.6466</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8363</span><span class="p">,</span> <span class="mf">0.4518</span><span class="p">,</span> <span class="mf">0.4518</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4871</span><span class="p">,</span> <span class="mf">0.5039</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.4753</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span> <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">,</span>
             <span class="mf">0.4128</span><span class="p">])</span>
<span class="n">CP</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Guanine</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">97.094725165</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">96.0365352027</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">97.31657849010276</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">95.95654436492156</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">47.410980</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">47.008233</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">48.222021</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">9.2</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                      <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N9&#39;</span><span class="p">,</span> <span class="s">&#39;C8&#39;</span><span class="p">,</span> <span class="s">&#39;H8&#39;</span><span class="p">,</span> <span class="s">&#39;N7&#39;</span><span class="p">,</span>
                      <span class="s">&#39;C5&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;O6&#39;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;H1&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;N2&#39;</span><span class="p">,</span> <span class="s">&#39;H21&#39;</span><span class="p">,</span> <span class="s">&#39;H22&#39;</span><span class="p">,</span>
                      <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;O2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;HO&#39;2&quot;</span><span class="p">,</span>
                      <span class="s">&quot;O3&#39;&quot;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">9.2</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
            <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
            <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0191</span><span class="p">,</span> <span class="mf">0.2006</span><span class="p">,</span> <span class="mf">0.0492</span><span class="p">,</span> <span class="mf">0.1374</span><span class="p">,</span> <span class="mf">0.164</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.5709</span><span class="p">,</span> <span class="mf">0.1744</span><span class="p">,</span> <span class="mf">0.477</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4787</span><span class="p">,</span> <span class="mf">0.3424</span><span class="p">,</span> <span class="mf">0.7657</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9672</span><span class="p">,</span>
            <span class="mf">0.4364</span><span class="p">,</span> <span class="mf">0.4364</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6323</span><span class="p">,</span> <span class="mf">0.1222</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span> <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
            <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
            <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0191</span><span class="p">,</span> <span class="mf">0.2006</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0623</span><span class="p">,</span> <span class="mf">0.1479</span><span class="p">,</span> <span class="mf">0.1137</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.6127</span><span class="p">,</span> <span class="mf">0.0488</span><span class="p">,</span> <span class="mf">0.7137</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7191</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8557</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.9976</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0387</span><span class="p">,</span>
            <span class="mf">0.3969</span><span class="p">,</span> <span class="mf">0.3969</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8299</span><span class="p">,</span> <span class="mf">0.1992</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span> <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">])</span>
<span class="n">G</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c"># Uracil</span>
<span class="n">refene1</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">igb8</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">refene1</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span> <span class="o">=</span> <span class="n">_ReferenceEnergy</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">136.326020191</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">134.938275039</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">136.5653533428478</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">135.06973320905044</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2_energies</span><span class="p">(</span><span class="n">igb2</span><span class="o">=-</span><span class="mf">67.270690</span><span class="p">,</span> <span class="n">igb5</span><span class="o">=-</span><span class="mf">66.605330</span><span class="p">)</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">dielc2</span><span class="o">.</span><span class="n">solvent_energies</span><span class="p">()</span>
<span class="n">refene2</span><span class="o">.</span><span class="n">set_pKa</span><span class="p">(</span><span class="mf">9.2</span><span class="p">,</span> <span class="n">deprotonated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">TitratableResidue</span><span class="p">(</span><span class="s">&#39;U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;P&#39;</span><span class="p">,</span> <span class="s">&#39;O1P&#39;</span><span class="p">,</span> <span class="s">&#39;O2P&#39;</span><span class="p">,</span> <span class="s">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;H5&#39;2&quot;</span><span class="p">,</span>
                      <span class="s">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="s">&#39;C6&#39;</span><span class="p">,</span> <span class="s">&#39;H6&#39;</span><span class="p">,</span> <span class="s">&#39;C5&#39;</span><span class="p">,</span>
                      <span class="s">&#39;H5&#39;</span><span class="p">,</span> <span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="s">&#39;O4&#39;</span><span class="p">,</span> <span class="s">&#39;N3&#39;</span><span class="p">,</span> <span class="s">&#39;H3&#39;</span><span class="p">,</span> <span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="s">&#39;O2&#39;</span><span class="p">,</span> <span class="s">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H3&#39;&quot;</span><span class="p">,</span>
                      <span class="s">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;H2&#39;1&quot;</span><span class="p">,</span> <span class="s">&quot;O2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;HO&#39;2&quot;</span><span class="p">,</span> <span class="s">&quot;O3&#39;&quot;</span><span class="p">],</span> <span class="n">pka</span><span class="o">=</span><span class="mf">9.3</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene1</span><span class="p">,</span> <span class="c"># protonated</span>
            <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
            <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0674</span><span class="p">,</span> <span class="mf">0.1824</span><span class="p">,</span> <span class="mf">0.0418</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1126</span><span class="p">,</span> <span class="mf">0.2188</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.3635</span><span class="p">,</span> <span class="mf">0.1811</span><span class="p">,</span> <span class="mf">0.5952</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3549</span><span class="p">,</span> <span class="mf">0.3154</span><span class="p">,</span> <span class="mf">0.4687</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5477</span><span class="p">,</span>
            <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span> <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">])</span>
<span class="n">U</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">protcnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">refene</span><span class="o">=</span><span class="n">refene2</span><span class="p">,</span> <span class="c"># deprotonated</span>
            <span class="n">charges</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4989</span><span class="p">,</span> <span class="mf">0.0558</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span> <span class="mf">0.0679</span><span class="p">,</span>
            <span class="mf">0.1065</span><span class="p">,</span> <span class="mf">0.1174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3548</span><span class="p">,</span> <span class="mf">0.0674</span><span class="p">,</span> <span class="mf">0.1824</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2733</span><span class="p">,</span> <span class="mf">0.0264</span><span class="p">,</span> <span class="mf">0.1501</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.582</span><span class="p">,</span> <span class="mf">0.156</span><span class="p">,</span> <span class="mf">0.9762</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9327</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.8698</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7435</span><span class="p">,</span>
            <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.0615</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.0972</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6139</span><span class="p">,</span> <span class="mf">0.4186</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5246</span><span class="p">])</span>
<span class="n">U</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">ParmEd 2.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Jason Swails.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>