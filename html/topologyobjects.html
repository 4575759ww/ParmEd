<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The topologyobjects module &mdash; ParmEd 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ParmEd 2.0 documentation" href="index.html" />
    <link rel="next" title="parmed.topologyobjects.Atom" href="topobj/parmed.topologyobjects.Atom.html" />
    <link rel="prev" title="ParmEd" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="topobj/parmed.topologyobjects.Atom.html" title="parmed.topologyobjects.Atom"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="ParmEd"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-topologyobjects-module">
<h1>The <tt class="xref py py-mod docutils literal"><span class="pre">topologyobjects</span></tt> module<a class="headerlink" href="#the-topologyobjects-module" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="xref py py-mod docutils literal"><span class="pre">topologyobjects</span></tt> module contains a wide array of classes used
extensively in the core <tt class="xref py py-class docutils literal"><span class="pre">structure.Structure</span></tt> class.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-obj docutils literal"><span class="pre">Atom</span></tt></a>([list,&nbsp;atomic_number,&nbsp;name,&nbsp;type,&nbsp;...])</td>
<td>An atom.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-obj docutils literal"><span class="pre">Residue</span></tt></a>(name[,&nbsp;number,&nbsp;chain,&nbsp;...])</td>
<td>A single residue that is composed of a small number of atoms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-obj docutils literal"><span class="pre">AtomList</span></tt></a>([arg])</td>
<td>Array of Atoms</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.ResidueList.html#parmed.topologyobjects.ResidueList" title="parmed.topologyobjects.ResidueList"><tt class="xref py py-obj docutils literal"><span class="pre">ResidueList</span></tt></a>([arg])</td>
<td>Array of <cite>Residue</cite> instances</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-obj docutils literal"><span class="pre">Bond</span></tt></a>(atom1,&nbsp;atom2[,&nbsp;type])</td>
<td>A covalent bond connecting two atoms.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-obj docutils literal"><span class="pre">Angle</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3[,&nbsp;type])</td>
<td>A valence angle between 3 atoms separated by two covalent bonds.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.UreyBradley.html#parmed.topologyobjects.UreyBradley" title="parmed.topologyobjects.UreyBradley"><tt class="xref py py-obj docutils literal"><span class="pre">UreyBradley</span></tt></a>(atom1,&nbsp;atom2[,&nbsp;type])</td>
<td>A Urey-Bradley angle type with a set of parameters.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Dihedral.html#parmed.topologyobjects.Dihedral" title="parmed.topologyobjects.Dihedral"><tt class="xref py py-obj docutils literal"><span class="pre">Dihedral</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4[,&nbsp;...])</td>
<td>A valence dihedral between 4 atoms separated by three covalent bonds.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Improper.html#parmed.topologyobjects.Improper" title="parmed.topologyobjects.Improper"><tt class="xref py py-obj docutils literal"><span class="pre">Improper</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4[,&nbsp;type])</td>
<td>A CHARMM-style improper torsion between 4 atoms.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.Cmap.html#parmed.topologyobjects.Cmap" title="parmed.topologyobjects.Cmap"><tt class="xref py py-obj docutils literal"><span class="pre">Cmap</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4,&nbsp;atom5[,&nbsp;type])</td>
<td>A coupled-torsion correction map term defined between 5 atoms connected by four covalent bonds.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.AtomType.html#parmed.topologyobjects.AtomType" title="parmed.topologyobjects.AtomType"><tt class="xref py py-obj docutils literal"><span class="pre">AtomType</span></tt></a>(name,&nbsp;number,&nbsp;mass,&nbsp;atomic_number)</td>
<td>Atom types can either be compared by indexes or names.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.BondType.html#parmed.topologyobjects.BondType" title="parmed.topologyobjects.BondType"><tt class="xref py py-obj docutils literal"><span class="pre">BondType</span></tt></a>(k,&nbsp;req[,&nbsp;list])</td>
<td>A bond type with a set of bond parameters</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.AngleType.html#parmed.topologyobjects.AngleType" title="parmed.topologyobjects.AngleType"><tt class="xref py py-obj docutils literal"><span class="pre">AngleType</span></tt></a>(k,&nbsp;theteq[,&nbsp;list])</td>
<td>An angle type with a set of angle parameters</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.DihedralType.html#parmed.topologyobjects.DihedralType" title="parmed.topologyobjects.DihedralType"><tt class="xref py py-obj docutils literal"><span class="pre">DihedralType</span></tt></a>(phi_k,&nbsp;per,&nbsp;phase[,&nbsp;scee,&nbsp;...])</td>
<td>A dihedral type with a set of dihedral parameters</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.DihedralTypeList.html#parmed.topologyobjects.DihedralTypeList" title="parmed.topologyobjects.DihedralTypeList"><tt class="xref py py-obj docutils literal"><span class="pre">DihedralTypeList</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Dihedral types are a Fourier expansion of terms.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.ImproperType.html#parmed.topologyobjects.ImproperType" title="parmed.topologyobjects.ImproperType"><tt class="xref py py-obj docutils literal"><span class="pre">ImproperType</span></tt></a>(psi_k,&nbsp;psi_eq[,&nbsp;list])</td>
<td>An improper type with a set of improper torsion parameters</td>
</tr>
</tbody>
</table>
<div class="section" id="using-the-atom-class">
<h2>Using the <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> class<a class="headerlink" href="#using-the-atom-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> class behaves much as you would expect it to.  It has various
attributes, including the <tt class="docutils literal"><span class="pre">name</span></tt> of the atom, the <tt class="docutils literal"><span class="pre">type</span></tt> of the atom, its
<tt class="docutils literal"><span class="pre">mass</span></tt>, <tt class="docutils literal"><span class="pre">atomic_number</span></tt>, and many other properties typically stored in one
of the supported file formats.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;CA&quot;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="mf">12.01</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&quot;CT&quot;</span><span class="p">,</span> <span class="n">atomic_number</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;CA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">type</span>
<span class="go">&#39;CT&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">atomic_number</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">mass</span>
<span class="go">12.01</span>
</pre></div>
</div>
<ul class="simple">
<li>It also stores references to all of the parameter types in which this belongs.
For instance, the <tt class="docutils literal"><span class="pre">bonds</span></tt>, <tt class="docutils literal"><span class="pre">angles</span></tt>, <tt class="docutils literal"><span class="pre">dihedrals</span></tt>, <tt class="docutils literal"><span class="pre">impropers</span></tt>, and
<tt class="docutils literal"><span class="pre">cmaps</span></tt> attributes are <em>lists</em> of references to the <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a>,
<a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-class docutils literal"><span class="pre">Angle</span></tt></a>, <a class="reference internal" href="topobj/parmed.topologyobjects.Dihedral.html#parmed.topologyobjects.Dihedral" title="parmed.topologyobjects.Dihedral"><tt class="xref py py-class docutils literal"><span class="pre">Dihedral</span></tt></a>, <a class="reference internal" href="topobj/parmed.topologyobjects.Improper.html#parmed.topologyobjects.Improper" title="parmed.topologyobjects.Improper"><tt class="xref py py-class docutils literal"><span class="pre">Improper</span></tt></a>, and <a class="reference internal" href="topobj/parmed.topologyobjects.Cmap.html#parmed.topologyobjects.Cmap" title="parmed.topologyobjects.Cmap"><tt class="xref py py-class docutils literal"><span class="pre">Cmap</span></tt></a>
instances in which this atom is a member.</li>
<li>Instances of <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> should be considered <em>singletons</em> &#8211; that is, their
equality is based on identity. As such, you should use the <tt class="docutils literal"><span class="pre">is</span></tt> operator
rather than <tt class="docutils literal"><span class="pre">==</span></tt> when comparing the equality of two atoms. In fact,
<tt class="docutils literal"><span class="pre">Atom.__eq__</span></tt> is not implemented at all, so it works the same way that
<tt class="docutils literal"><span class="pre">is</span></tt> does in this case. This is an important distinction, because it makes
<a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances <em>hashable</em>, meaning that they can serve as keys in a
<tt class="docutils literal"><span class="pre">dict</span></tt> or can be added to a <tt class="docutils literal"><span class="pre">set</span></tt>.</li>
<li>Atom ordering is determined based on positions within a particular
<a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>. When an <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> belongs to an <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>, it
knows its absolute position within that list via the <tt class="xref py py-attr docutils literal"><span class="pre">idx</span></tt> attribute
(which is set to <tt class="docutils literal"><span class="pre">-1</span></tt> if the Atom is not part of an <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>). The
<tt class="xref py py-attr docutils literal"><span class="pre">idx</span></tt> attribute is automatically updated if the parent <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>
is changed in any way (e.g., some atoms are deleted or inserted). This allows
sublists of <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances to be sorted according to their order in
their main <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>. (Note, each <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> can belong to no more
than one <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>)</li>
<li>Atoms store lists of other <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances that are connected to that
atom via covalent bonds, angles, torsions, or coupled-torsions maps in the
<tt class="docutils literal"><span class="pre">bond_partners</span></tt>, <tt class="docutils literal"><span class="pre">angle_partners</span></tt>, <tt class="docutils literal"><span class="pre">dihedral_partners</span></tt>, and
<tt class="docutils literal"><span class="pre">tortor_partners</span></tt>, respectively. These are primarily used to determine pairs
of atoms that are excluded from a nonbonded interaction in traditional force
fields. There is an additional <tt class="docutils literal"><span class="pre">exclusion_partners</span></tt> array that contains a
list of arbitrary pairs of atoms that are not connected by any of the valence
terms mentioned above. Each atom can appear in one, and only one list of
another atom, with preference given to the &#8220;partner&#8221; arrays in the order they
were listed above. Membership in these arrays is always symmetric&#8212;that is,
if one atom is in the <tt class="docutils literal"><span class="pre">bond_partners</span></tt> array of another, that other atom is
also in the <tt class="docutils literal"><span class="pre">bond_partners</span></tt> array of the first. These lists are populated
automatically when the relevant valence terms are created (see below).</li>
</ul>
<p>You will typically not have to instantiate an <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> or <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a>
instance on your own, as they are created as part of a
<tt class="xref py py-class docutils literal"><span class="pre">structure.Structure</span></tt> instance created by the various structure file
parsers.</p>
</div>
<div class="section" id="using-the-residue-class">
<h2>Using the <a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> class<a class="headerlink" href="#using-the-residue-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> class is an object that represents a typical <em>residue</em> in a
biomolecular system. Examples include a single amino or nucleic acid in a
peptide or nucleotide chain.  A <a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> is a collection of atoms, each
of which is connected to the other ones through a network of bonds (and may be
bonded to other residues as well, although that is not required).</p>
<p>Residues have 4 primary attributes of general use:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> : The name of the residue</li>
<li><tt class="docutils literal"><span class="pre">chain</span></tt> : The chain identifier of the residue (a common identifier in
the PDB)</li>
<li><tt class="docutils literal"><span class="pre">insertion_code</span></tt> : Also used as part of the PDB, these are primarily
used to align homologous sequences when some homologies have an extra
residue compared to the other(s)</li>
<li><tt class="docutils literal"><span class="pre">atoms</span></tt> : A <tt class="docutils literal"><span class="pre">list</span></tt> of <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances contained within the
residue</li>
</ul>
</div></blockquote>
<p>Residues are uniquely identified by their <tt class="docutils literal"><span class="pre">name</span></tt>, <tt class="docutils literal"><span class="pre">chain</span></tt>, and
<tt class="docutils literal"><span class="pre">insertion_code</span></tt> within a single system.</p>
<div class="section" id="common-things-you-can-do-with-a-residue">
<h3>Common things you can do with a <a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a><a class="headerlink" href="#common-things-you-can-do-with-a-residue" title="Permalink to this headline">¶</a></h3>
<p>In the following code sample, assume <tt class="docutils literal"><span class="pre">atom</span></tt> is an instance of <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a>
which is one of the atoms inside <tt class="docutils literal"><span class="pre">residue</span></tt> (an instance of <a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a>).</p>
<ol class="arabic">
<li><p class="first">Iterate through the atoms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Get the i&#8217;th atom from a residue:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">atomI</span> <span class="o">=</span> <span class="n">residue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first">Determine if an atom is part of a residue:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Atom </span><span class="si">%s</span><span class="s"> is inside residue </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p class="first">Find out how many atoms are in a residue:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">n_atoms_in_res</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Add an atom to a residue:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">residue</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span>
</pre></div>
</div>
</li>
<li><p class="first">Delete an atom from a residue:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">residue</span><span class="o">.</span><span class="n">delete_atom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">residue</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="the-atomlist-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a> class<a class="headerlink" href="#the-atomlist-class" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a> is a subclass of the basic Python <em>list</em> type, with some added
features:</p>
<ul class="simple">
<li>The <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a> claims ownership of any <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> added to it and
sets the <tt class="docutils literal"><span class="pre">idx</span></tt> attribute of each of the atoms to their position in the
array. Atoms should never be part of multiple <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a> instances.</li>
<li>The <a class="reference internal" href="topobj/parmed.topologyobjects.AtomList.html#parmed.topologyobjects.AtomList" title="parmed.topologyobjects.AtomList"><tt class="xref py py-class docutils literal"><span class="pre">AtomList</span></tt></a> has a <tt class="docutils literal"><span class="pre">changed</span></tt> attribute that is set to <tt class="docutils literal"><span class="pre">True</span></tt> any
time the list is changed (i.e., if an atom is added, deleted, inserted, moved,
etc.) &#8211; you must manaully set this <tt class="docutils literal"><span class="pre">changed</span></tt> attribute to <tt class="docutils literal"><span class="pre">False</span></tt>
afterwards if you wish to track any future changes.</li>
</ul>
<p>This class is also typically instantiated by the <tt class="xref py py-class docutils literal"><span class="pre">structure.Structure</span></tt>
parsers (e.g., <tt class="xref py py-func docutils literal"><span class="pre">structure.read_PDB()</span></tt>, <tt class="xref py py-func docutils literal"><span class="pre">structure.read_CIF()</span></tt>, ...)</p>
</div>
<div class="section" id="the-residuelist-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.ResidueList.html#parmed.topologyobjects.ResidueList" title="parmed.topologyobjects.ResidueList"><tt class="xref py py-class docutils literal"><span class="pre">ResidueList</span></tt></a> class<a class="headerlink" href="#the-residuelist-class" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="topobj/parmed.topologyobjects.ResidueList.html#parmed.topologyobjects.ResidueList" title="parmed.topologyobjects.ResidueList"><tt class="xref py py-class docutils literal"><span class="pre">ResidueList</span></tt></a> is also a subclass of <em>list</em> with some added features of
its own:</p>
<ul>
<li><p class="first">The <a class="reference internal" href="topobj/parmed.topologyobjects.ResidueList.html#parmed.topologyobjects.ResidueList" title="parmed.topologyobjects.ResidueList"><tt class="xref py py-class docutils literal"><span class="pre">ResidueList</span></tt></a> contains a list of <a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> instances, and
sets the <tt class="docutils literal"><span class="pre">idx</span></tt> attribute on them to point to their current location in the
list.</p>
</li>
<li><p class="first">Atoms can be added directly to the residue list. This is done because most
file formats list atoms sequentially, and the beginning and end of each
residue is detected by either the residue name, number, chain ID, or insertion
code changing. As long as these residue properties are the same as the last
<a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instance you added, the atom will be added to that last residue.
If it is a new residue, <a class="reference internal" href="topobj/parmed.topologyobjects.ResidueList.html#parmed.topologyobjects.ResidueList" title="parmed.topologyobjects.ResidueList"><tt class="xref py py-class docutils literal"><span class="pre">ResidueList</span></tt></a> will create a new
<a class="reference internal" href="topobj/parmed.topologyobjects.Residue.html#parmed.topologyobjects.Residue" title="parmed.topologyobjects.Residue"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> object, append it to itself, and add that atom to it. For
example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span> <span class="o">=</span> <span class="n">ResidueList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;C1&#39;</span><span class="p">),</span> <span class="s">&#39;RE1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;C2&#39;</span><span class="p">),</span> <span class="s">&#39;RE1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;C3&#39;</span><span class="p">),</span> <span class="s">&#39;RE1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;C4&#39;</span><span class="p">),</span> <span class="s">&#39;RE2&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">)</span> <span class="c"># new residue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;C5&#39;</span><span class="p">),</span> <span class="s">&#39;RE2&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">)</span> <span class="c"># new residue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="the-bond-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> class<a class="headerlink" href="#the-bond-class" title="Permalink to this headline">¶</a></h2>
<p>The covalent bond is the simplest of topological features in a molecule. The
<a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> class represents a covalent bonds between two <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a>
instances. Creating a <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> between two <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances adds
the resulting <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> to the <tt class="docutils literal"><span class="pre">bonds</span></tt> list of both atoms. It also adds
each atom to the <tt class="docutils literal"><span class="pre">bond_partners</span></tt> list of the other atom. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;CB&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="o">.</span><span class="n">bonds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">bond</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span><span class="o">.</span><span class="n">bonds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">bond</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="ow">in</span> <span class="n">a1</span><span class="o">.</span><span class="n">bond_partners</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">a2</span><span class="o">.</span><span class="n">bond_partners</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Bonds can also <em>contain</em> <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances. Continuing from the example
above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">bond</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="ow">in</span> <span class="n">bond</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a3</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;HA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a3</span> <span class="ow">in</span> <span class="n">bond</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Bonds are unique valence terms since they are the simplest of valence terms.
Other valence terms (described below) can <em>contain</em> both <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> and
<a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> instances.</p>
<p>The ordering of the two atoms in the <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> constructor does not matter,
as the bond <tt class="docutils literal"><span class="pre">a1--a2</span></tt> and <tt class="docutils literal"><span class="pre">a2--a1</span></tt> are equivalent.</p>
</div>
<div class="section" id="the-angle-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-class docutils literal"><span class="pre">Angle</span></tt></a> class<a class="headerlink" href="#the-angle-class" title="Permalink to this headline">¶</a></h2>
<p>The valence angle is formed from two adjacent bonds that form a common center.
The <a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-class docutils literal"><span class="pre">Angle</span></tt></a> class represents a valence angle between 3 atoms in which two
of the three atoms are bonded to a central atom. In this case, the order of the
<em>middle</em> atom in the constructor matters, but the order of the outer atoms does
not. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;CB&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a3</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;CG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b1</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b2</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b3</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span> <span class="c"># let&#39;s make this a triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above example, our angle is formed between the bonds <tt class="docutils literal"><span class="pre">a1--a2--a3</span></tt>, so
<tt class="docutils literal"><span class="pre">angle</span></tt> contains the three atoms as well as <tt class="docutils literal"><span class="pre">b1</span></tt> and <tt class="docutils literal"><span class="pre">b2</span></tt>, but <em>not</em>
<tt class="docutils literal"><span class="pre">b3</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">angle</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="ow">in</span> <span class="n">angle</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a3</span> <span class="ow">in</span> <span class="n">angle</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b1</span> <span class="ow">in</span> <span class="n">angle</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b2</span> <span class="ow">in</span> <span class="n">angle</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b3</span> <span class="ow">in</span> <span class="n">angle</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Like with the <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> class, creating an <a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-class docutils literal"><span class="pre">Angle</span></tt></a> adds the created
angle to the <tt class="docutils literal"><span class="pre">angles</span></tt> list on all three of the atoms.  Furthermore, the
<tt class="docutils literal"><span class="pre">angle_partners</span></tt> attribute of <tt class="docutils literal"><span class="pre">a1</span></tt> and <tt class="docutils literal"><span class="pre">a3</span></tt> have <tt class="docutils literal"><span class="pre">a3</span></tt> and <tt class="docutils literal"><span class="pre">a1</span></tt> added
to them, respectively. As mentioned above, the same <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instance will
never appear in two <tt class="docutils literal"><span class="pre">xxx_partners</span></tt> arrays. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">a3</span><span class="o">.</span><span class="n">angle_partners</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">a3</span><span class="o">.</span><span class="n">bond_partners</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">a2</span><span class="o">.</span><span class="n">bond_partners</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="ow">in</span> <span class="n">a3</span><span class="o">.</span><span class="n">angle_partners</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<div class="section" id="the-ureybradley-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.UreyBradley.html#parmed.topologyobjects.UreyBradley" title="parmed.topologyobjects.UreyBradley"><tt class="xref py py-class docutils literal"><span class="pre">UreyBradley</span></tt></a> class<a class="headerlink" href="#the-ureybradley-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="topobj/parmed.topologyobjects.UreyBradley.html#parmed.topologyobjects.UreyBradley" title="parmed.topologyobjects.UreyBradley"><tt class="xref py py-class docutils literal"><span class="pre">UreyBradley</span></tt></a> class defines a covalent bond-like interaction between
two atoms separated by a valence angle, adding anharmonicity to purely harmonic
angle terms. The interface to <a class="reference internal" href="topobj/parmed.topologyobjects.UreyBradley.html#parmed.topologyobjects.UreyBradley" title="parmed.topologyobjects.UreyBradley"><tt class="xref py py-class docutils literal"><span class="pre">UreyBradley</span></tt></a> terms is analogous to those
for <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> and <a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-class docutils literal"><span class="pre">Angle</span></tt></a> above.</p>
</div>
<div class="section" id="the-dihedral-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.Dihedral.html#parmed.topologyobjects.Dihedral" title="parmed.topologyobjects.Dihedral"><tt class="xref py py-class docutils literal"><span class="pre">Dihedral</span></tt></a> class<a class="headerlink" href="#the-dihedral-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="topobj/parmed.topologyobjects.Dihedral.html#parmed.topologyobjects.Dihedral" title="parmed.topologyobjects.Dihedral"><tt class="xref py py-class docutils literal"><span class="pre">Dihedral</span></tt></a> class follows the same trend as the <a class="reference internal" href="topobj/parmed.topologyobjects.Angle.html#parmed.topologyobjects.Angle" title="parmed.topologyobjects.Angle"><tt class="xref py py-class docutils literal"><span class="pre">Angle</span></tt></a> class
described above, and behaves in an analogous way. There are a couple unique
aspects to Dihedrals, though. A <a class="reference internal" href="topobj/parmed.topologyobjects.Dihedral.html#parmed.topologyobjects.Dihedral" title="parmed.topologyobjects.Dihedral"><tt class="xref py py-class docutils literal"><span class="pre">Dihedral</span></tt></a> can be an improper dihedral
(in which all 4 atoms are ideally coplanar, with the third atom being the
&#8220;central&#8221; atom bonded to all of the others). The <a class="reference internal" href="topobj/parmed.topologyobjects.Dihedral.html#parmed.topologyobjects.Dihedral" title="parmed.topologyobjects.Dihedral"><tt class="xref py py-class docutils literal"><span class="pre">Dihedral</span></tt></a> instance has
a boolean attribute <tt class="docutils literal"><span class="pre">improper</span></tt> that indicates whether or not it is an improper
torsion.</p>
</div>
<div class="section" id="the-improper-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.Improper.html#parmed.topologyobjects.Improper" title="parmed.topologyobjects.Improper"><tt class="xref py py-class docutils literal"><span class="pre">Improper</span></tt></a> class<a class="headerlink" href="#the-improper-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="topobj/parmed.topologyobjects.Improper.html#parmed.topologyobjects.Improper" title="parmed.topologyobjects.Improper"><tt class="xref py py-class docutils literal"><span class="pre">Improper</span></tt></a> class is <em>strictly</em> an improper torsion, and is used where
certain force fields utilize a separate functional form for &#8220;proper&#8221; and
&#8220;improper&#8221; torsions (e.g., the CHARMM force field). You are forwarded to the API
documentation for <a class="reference internal" href="topobj/parmed.topologyobjects.Improper.html#parmed.topologyobjects.Improper" title="parmed.topologyobjects.Improper"><tt class="xref py py-class docutils literal"><span class="pre">Improper</span></tt></a> for more details.</p>
</div>
<div class="section" id="the-cmap-class">
<h2>The <a class="reference internal" href="topobj/parmed.topologyobjects.Cmap.html#parmed.topologyobjects.Cmap" title="parmed.topologyobjects.Cmap"><tt class="xref py py-class docutils literal"><span class="pre">Cmap</span></tt></a> class<a class="headerlink" href="#the-cmap-class" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="topobj/parmed.topologyobjects.Cmap.html#parmed.topologyobjects.Cmap" title="parmed.topologyobjects.Cmap"><tt class="xref py py-class docutils literal"><span class="pre">Cmap</span></tt></a> class is a correction map defined between adjacent torsions
(i.e., 5 atoms separated by 4 bonds). Like the other valence terms described
above, it contains 5 <a class="reference internal" href="topobj/parmed.topologyobjects.Atom.html#parmed.topologyobjects.Atom" title="parmed.topologyobjects.Atom"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances and may contain 4 <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a>
instances (as tested via the <tt class="docutils literal"><span class="pre">in</span></tt> operator). See the API documentation for
<a class="reference internal" href="topobj/parmed.topologyobjects.Cmap.html#parmed.topologyobjects.Cmap" title="parmed.topologyobjects.Cmap"><tt class="xref py py-class docutils literal"><span class="pre">Cmap</span></tt></a> for more details.</p>
</div>
<div class="section" id="the-xyztype-classes">
<h2>The <tt class="docutils literal"><span class="pre">XyzType</span></tt> classes<a class="headerlink" href="#the-xyztype-classes" title="Permalink to this headline">¶</a></h2>
<p>Every valence term described above contains a <tt class="docutils literal"><span class="pre">type</span></tt> attribute that is either
<tt class="docutils literal"><span class="pre">None</span></tt> if unassigned or the relevant <tt class="docutils literal"><span class="pre">ParameterType</span></tt> (e.g.,
<a class="reference internal" href="topobj/parmed.topologyobjects.BondType.html#parmed.topologyobjects.BondType" title="parmed.topologyobjects.BondType"><tt class="xref py py-class docutils literal"><span class="pre">BondType</span></tt></a> for <a class="reference internal" href="topobj/parmed.topologyobjects.Bond.html#parmed.topologyobjects.Bond" title="parmed.topologyobjects.Bond"><tt class="xref py py-class docutils literal"><span class="pre">Bond</span></tt></a> and <a class="reference internal" href="topobj/parmed.topologyobjects.UreyBradley.html#parmed.topologyobjects.UreyBradley" title="parmed.topologyobjects.UreyBradley"><tt class="xref py py-class docutils literal"><span class="pre">UreyBradley</span></tt></a> classes) instance.
Certain functionality (e.g., simulations using OpenMM or writing Amber topology
files) requires all parameters be present and assigned. These types have, where
applicable, force constants and equilibrium values for the various parameter
types.</p>
</div>
<div class="section" id="amoeba-specific-terms">
<h2>Amoeba-specific terms<a class="headerlink" href="#amoeba-specific-terms" title="Permalink to this headline">¶</a></h2>
<p>The AMOEBA force field has nominal support in ParmEd (with improved support
planned). This force field contains a large number of additional terms and
parameters for use with the AMOEBA force field. For convenience, they are listed
below. Consult the API documentation in the resulting links for more
information.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.TrigonalAngle.html#parmed.topologyobjects.TrigonalAngle" title="parmed.topologyobjects.TrigonalAngle"><tt class="xref py py-obj docutils literal"><span class="pre">TrigonalAngle</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4[,&nbsp;type])</td>
<td>A trigonal-angle term in the AMOEBA force field.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.OutOfPlaneBend.html#parmed.topologyobjects.OutOfPlaneBend" title="parmed.topologyobjects.OutOfPlaneBend"><tt class="xref py py-obj docutils literal"><span class="pre">OutOfPlaneBend</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4[,&nbsp;...])</td>
<td>Out-of-plane bending term in the AMOEBA force field.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.OutOfPlaneBendType.html#parmed.topologyobjects.OutOfPlaneBendType" title="parmed.topologyobjects.OutOfPlaneBendType"><tt class="xref py py-obj docutils literal"><span class="pre">OutOfPlaneBendType</span></tt></a>(k[,&nbsp;list])</td>
<td>An angle type with a set of angle parameters</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.PiTorsion.html#parmed.topologyobjects.PiTorsion" title="parmed.topologyobjects.PiTorsion"><tt class="xref py py-obj docutils literal"><span class="pre">PiTorsion</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4,&nbsp;atom5,&nbsp;...)</td>
<td>Defines a pi-torsion term in the AMOEBA force field.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.StretchBend.html#parmed.topologyobjects.StretchBend" title="parmed.topologyobjects.StretchBend"><tt class="xref py py-obj docutils literal"><span class="pre">StretchBend</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3[,&nbsp;type])</td>
<td>This term models the stretching and bending of a standard valence angle, and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.StretchBendType.html#parmed.topologyobjects.StretchBendType" title="parmed.topologyobjects.StretchBendType"><tt class="xref py py-obj docutils literal"><span class="pre">StretchBendType</span></tt></a>(k1,&nbsp;k2,&nbsp;req1,&nbsp;req2,&nbsp;theteq)</td>
<td>A stretch-bend type with two distances and an angle in AMOEBA</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.TorsionTorsion.html#parmed.topologyobjects.TorsionTorsion" title="parmed.topologyobjects.TorsionTorsion"><tt class="xref py py-obj docutils literal"><span class="pre">TorsionTorsion</span></tt></a>(atom1,&nbsp;atom2,&nbsp;atom3,&nbsp;atom4,&nbsp;atom5)</td>
<td>This is a coupled-torsion map used in the AMOEBA force field similar to the</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.TorsionTorsionType.html#parmed.topologyobjects.TorsionTorsionType" title="parmed.topologyobjects.TorsionTorsionType"><tt class="xref py py-obj docutils literal"><span class="pre">TorsionTorsionType</span></tt></a>(dims,&nbsp;ang1,&nbsp;ang2,&nbsp;f[,&nbsp;...])</td>
<td>The type containing the parameter maps for the Amoeba torsion-torsion potentials.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.ChiralFrame.html#parmed.topologyobjects.ChiralFrame" title="parmed.topologyobjects.ChiralFrame"><tt class="xref py py-obj docutils literal"><span class="pre">ChiralFrame</span></tt></a>(atom1,&nbsp;atom2,&nbsp;chirality)</td>
<td>A chiral frame as defined in the AMOEBA force field.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.MultipoleFrame.html#parmed.topologyobjects.MultipoleFrame" title="parmed.topologyobjects.MultipoleFrame"><tt class="xref py py-obj docutils literal"><span class="pre">MultipoleFrame</span></tt></a>(atom,&nbsp;frame_pt_num,&nbsp;vectail,&nbsp;...)</td>
<td>This defines the frame of reference for computing multipole interactions in the AMOEBA force field.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="topobj/parmed.topologyobjects.NonbondedException.html#parmed.topologyobjects.NonbondedException" title="parmed.topologyobjects.NonbondedException"><tt class="xref py py-obj docutils literal"><span class="pre">NonbondedException</span></tt></a>(atom1,&nbsp;atom2[,&nbsp;type])</td>
<td>The AMOEBA force field has complex exclusion and exception rules (referred to as &#8220;adjustments&#8221; in the Amber-converted files).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="topobj/parmed.topologyobjects.NonbondedExceptionType.html#parmed.topologyobjects.NonbondedExceptionType" title="parmed.topologyobjects.NonbondedExceptionType"><tt class="xref py py-obj docutils literal"><span class="pre">NonbondedExceptionType</span></tt></a>(rmin,&nbsp;epsilon[,&nbsp;...])</td>
<td>A parameter describing how the various nonbonded interactions between a</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The <tt class="docutils literal"><span class="pre">topologyobjects</span></tt> module</a><ul>
<li><a class="reference internal" href="#using-the-atom-class">Using the <tt class="docutils literal"><span class="pre">Atom</span></tt> class</a></li>
<li><a class="reference internal" href="#using-the-residue-class">Using the <tt class="docutils literal"><span class="pre">Residue</span></tt> class</a><ul>
<li><a class="reference internal" href="#common-things-you-can-do-with-a-residue">Common things you can do with a <tt class="docutils literal"><span class="pre">Residue</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-atomlist-class">The <tt class="docutils literal"><span class="pre">AtomList</span></tt> class</a></li>
<li><a class="reference internal" href="#the-residuelist-class">The <tt class="docutils literal"><span class="pre">ResidueList</span></tt> class</a></li>
<li><a class="reference internal" href="#the-bond-class">The <tt class="docutils literal"><span class="pre">Bond</span></tt> class</a></li>
<li><a class="reference internal" href="#the-angle-class">The <tt class="docutils literal"><span class="pre">Angle</span></tt> class</a></li>
<li><a class="reference internal" href="#the-ureybradley-class">The <tt class="docutils literal"><span class="pre">UreyBradley</span></tt> class</a></li>
<li><a class="reference internal" href="#the-dihedral-class">The <tt class="docutils literal"><span class="pre">Dihedral</span></tt> class</a></li>
<li><a class="reference internal" href="#the-improper-class">The <tt class="docutils literal"><span class="pre">Improper</span></tt> class</a></li>
<li><a class="reference internal" href="#the-cmap-class">The <tt class="docutils literal"><span class="pre">Cmap</span></tt> class</a></li>
<li><a class="reference internal" href="#the-xyztype-classes">The <tt class="docutils literal"><span class="pre">XyzType</span></tt> classes</a></li>
<li><a class="reference internal" href="#amoeba-specific-terms">Amoeba-specific terms</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/topologyobjects.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="topobj/parmed.topologyobjects.Atom.html" title="parmed.topologyobjects.Atom"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="ParmEd"
             >previous</a> |</li>
        <li><a href="index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Jason Swails.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>