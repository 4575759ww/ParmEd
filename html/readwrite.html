<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>File input/output with ParmEd &mdash; ParmEd 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ParmEd 2.0 documentation" href="index.html" />
    <link rel="next" title="parmed.formats.registry.load_file" href="fileio/parmed.formats.registry.load_file.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fileio/parmed.formats.registry.load_file.html" title="parmed.formats.registry.load_file"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="file-input-output-with-parmed">
<h1>File input/output with ParmEd<a class="headerlink" href="#file-input-output-with-parmed" title="Permalink to this headline">¶</a></h1>
<p>ParmEd has several convenience functions designed specifically to make file
input/output easier for a wide range of file formats.</p>
<p>The API for parsing different file types is not always consistent due to the
technical needs of each class.  For instance, the Amber topology file class
subclasses from <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a>, so it can be
instantiated directly from a filename. On the other hand, <a class="reference internal" href="api/parmed/parmed.formats.pdb.html#parmed.formats.pdb.PDBFile" title="parmed.formats.pdb.PDBFile"><code class="xref py py-class docutils literal"><span class="pre">PDBFile</span></code></a> contains a <code class="docutils literal"><span class="pre">parse</span></code> static method that returns a
<a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> instance directly rather than
subclassing.</p>
<div class="section" id="reading-files-with-load-file">
<h2>Reading files with <a class="reference internal" href="structobj/parmed.formats.registry.load_file.html#parmed.formats.registry.load_file" title="parmed.formats.registry.load_file"><code class="xref py py-func docutils literal"><span class="pre">load_file</span></code></a><a class="headerlink" href="#reading-files-with-load-file" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="structobj/parmed.formats.registry.load_file.html#parmed.formats.registry.load_file" title="parmed.formats.registry.load_file"><code class="xref py py-obj docutils literal"><span class="pre">load_file</span></code></a>(filename,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Identifies the file format of the specified file and returns its parsed contents.</td>
</tr>
</tbody>
</table>
<p>To provide a single interface for parsing <em>any</em> type of file, the
<a class="reference internal" href="structobj/parmed.formats.registry.load_file.html#parmed.formats.registry.load_file" title="parmed.formats.registry.load_file"><code class="xref py py-func docutils literal"><span class="pre">load_file</span></code></a> function takes a filename
and any relevant arguments or keyword arguments for the supported file formats
and calls the appropriate parsing function.  Supported file formats along with
the extra supported keyword arguments (if applicable) are shown in the table
below (the filename argument is omitted):</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File type</th>
<th class="head">Supported arguments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Amber ASCII restart file</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>Amber prmtop</td>
<td><code class="docutils literal"><span class="pre">xyz</span></code>, <code class="docutils literal"><span class="pre">box</span></code></td>
</tr>
<tr class="row-even"><td>Amber MDL (e.g., RISM)</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>Amber MDCRD trajectory</td>
<td><code class="docutils literal"><span class="pre">natom</span></code>*, <code class="docutils literal"><span class="pre">hasbox</span></code>*</td>
</tr>
<tr class="row-even"><td>Amber OFF library</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>Amber frcmod/parm.dat</td>
<td>list of filenames</td>
</tr>
<tr class="row-even"><td>PDBx/mmCIF file</td>
<td><code class="docutils literal"><span class="pre">skip_bonds</span></code></td>
</tr>
<tr class="row-odd"><td>CHARMM coordinate file</td>
<td>None</td>
</tr>
<tr class="row-even"><td>CHARMM restart file</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>Gromacs GRO file</td>
<td><code class="docutils literal"><span class="pre">skip_bonds</span></code></td>
</tr>
<tr class="row-even"><td>Gromacs topology file</td>
<td><code class="docutils literal"><span class="pre">defines</span></code>, <code class="docutils literal"><span class="pre">parametrize</span></code>
<code class="docutils literal"><span class="pre">xyz</span></code>, <code class="docutils literal"><span class="pre">box</span></code></td>
</tr>
<tr class="row-odd"><td>Mol2 and Mol3 files</td>
<td><code class="docutils literal"><span class="pre">structure</span></code></td>
</tr>
<tr class="row-even"><td>NetCDF restart file</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>NetCDF trajectory file</td>
<td>None</td>
</tr>
<tr class="row-even"><td>PDB file</td>
<td><code class="docutils literal"><span class="pre">skip_bonds</span></code></td>
</tr>
<tr class="row-odd"><td>PQR file</td>
<td><code class="docutils literal"><span class="pre">skip_bonds</span></code></td>
</tr>
<tr class="row-even"><td>PSF file</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>Serialized System XML</td>
<td>None</td>
</tr>
<tr class="row-even"><td>Serialized State XML</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>Serialized Integrator
XML file</td>
<td>None</td>
</tr>
<tr class="row-even"><td>ForceField XML file</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>*These arguments are <em>required</em> when parsing the corresponding format file</p>
<p>The optional keyword arguments are described below:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">xyz</span></code> &#8211; Either a file name for a coordinate file or an array with the
coordinates. If the unit cell information is stored in the coordinate file, it
is used (unless an explicit <code class="docutils literal"><span class="pre">box</span></code> argument is given; see below). If the file
is a trajectory file, the first frame is used for the coordinates.</li>
<li><code class="docutils literal"><span class="pre">box</span></code> &#8211; The unit cell dimensions in Angstroms (and angles in degrees).</li>
<li><code class="docutils literal"><span class="pre">natom</span></code> &#8211; The number of atoms from which the file was written</li>
<li><code class="docutils literal"><span class="pre">hasbox</span></code> &#8211; Whether unit cell information is stored in this trajectory file</li>
<li><code class="docutils literal"><span class="pre">defines</span></code> &#8211; <code class="docutils literal"><span class="pre">dict</span></code> of preprocessor defines (order is respected if given
via an <code class="docutils literal"><span class="pre">OrderedDict</span></code>)</li>
<li><code class="docutils literal"><span class="pre">parametrize</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, parameters are assigned from the parameter
database.  If <code class="docutils literal"><span class="pre">False</span></code>, they are not (default is <code class="docutils literal"><span class="pre">True</span></code>).</li>
<li><code class="docutils literal"><span class="pre">structure</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, return the Mol2/Mol3 file as a <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> instance. Default is <code class="docutils literal"><span class="pre">False</span></code></li>
<li><code class="docutils literal"><span class="pre">skip_bonds</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, no attempt is made to identify covalent bonds
between any atoms for these formats. If <code class="docutils literal"><span class="pre">False</span></code> (default), bonds are first
assigned by comparing to standard residue templates, then based on distance
criteria for any atom not specified within the templates. This has a
side-effect of improving element identification for PDB files that have no
element columns specified as well as substantially improving element
identification for ions in GRO files. You are suggested to keep the default
(<code class="docutils literal"><span class="pre">False</span></code>) unless you are <em>only</em> using the coordinates, in which case setting
<code class="docutils literal"><span class="pre">skip_bonds</span></code> to <code class="docutils literal"><span class="pre">True</span></code> will result in significantly improved performance.</li>
</ul>
<p><a class="reference internal" href="structobj/parmed.formats.registry.load_file.html#parmed.formats.registry.load_file" title="parmed.formats.registry.load_file"><code class="xref py py-func docutils literal"><span class="pre">load_file()</span></code></a> automatically inspects the contents of the file with the given
name to determine what format the file is based on the first couple lines.
Except in rare, pathological cases, the file format detection mechanism is
fairly robust. If any files <em>fail</em> this detection, feel free to file an issue on
the Github issue tracker to improve file type prediction.</p>
<p><a class="reference internal" href="structobj/parmed.formats.registry.load_file.html#parmed.formats.registry.load_file" title="parmed.formats.registry.load_file"><code class="xref py py-func docutils literal"><span class="pre">load_file()</span></code></a> has a number of helpful features. For instance, files ending
with the <code class="docutils literal"><span class="pre">.gz</span></code> or <code class="docutils literal"><span class="pre">.bz2</span></code> suffix will automatically be decompressed in-memory
using Gzip or Bzip2, respectively (except for some binary file formats, like
NetCDF). Furthermore, URLs beginning with <code class="docutils literal"><span class="pre">http://</span></code>, <code class="docutils literal"><span class="pre">https://</span></code>, or
<code class="docutils literal"><span class="pre">ftp://</span></code> are valid file names and will result in the remote file being
downloaded and processed (again, in-memory).</p>
<p>Finally, to make it so that you can always retrieve a <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> instance from file types that support returning
one by passing the <code class="docutils literal"><span class="pre">structure=True</span></code> keyword to <code class="docutils literal"><span class="pre">load_file</span></code>. If this argument
is not supported by the resulting file type, it is simply ignored, as is the
<code class="docutils literal"><span class="pre">natom</span></code>, <code class="docutils literal"><span class="pre">hasbox</span></code>, and <code class="docutils literal"><span class="pre">skip_bonds</span></code> keywords.</p>
</div>
<div class="section" id="writing-files-with-structure-save">
<h2>Writing files with <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure.save" title="parmed.structure.Structure.save"><code class="xref py py-meth docutils literal"><span class="pre">Structure.save</span></code></a><a class="headerlink" href="#writing-files-with-structure-save" title="Permalink to this headline">¶</a></h2>
<p>Many of the file formats supported by ParmEd either parse directly to a
<a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> instance or subclass, and many
of the desired file type conversions that ParmEd is designed to facilitate are
between these formats (e.g., Amber topology, PDB, CHARMM PSF file, etc.).</p>
<p>To facilitate the required conversion and file writing, the base
<a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> class has a <code class="docutils literal"><span class="pre">save</span></code> method that
will convert to the requested file format and write the output file. The desired
format is specified either explicitly or by file name extension (with explicit
format specifications taking precedence).  Because <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure.save" title="parmed.structure.Structure.save"><code class="xref py py-meth docutils literal"><span class="pre">Structure.save</span></code></a> is a convenience method, it will protect
against accidentally overwriting an existing file. The <code class="docutils literal"><span class="pre">overwrite</span></code> argument,
when set to <code class="docutils literal"><span class="pre">True</span></code>, will allow an existing file to be overwritten. If set to
<code class="docutils literal"><span class="pre">False</span></code> (or left at its default), <code class="docutils literal"><span class="pre">IOError</span></code> will be raised when attempting
to overwrite an existing file. The supported file formats, along with their
supported extra keyword arguments, are detailed in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="31%" />
<col width="20%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File type</th>
<th class="head">Recognized extension(s)</th>
<th class="head">Format keyword</th>
<th class="head">Supported arguments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>PDB</td>
<td><code class="docutils literal"><span class="pre">.pdb</span></code></td>
<td><code class="docutils literal"><span class="pre">pdb</span></code></td>
<td rowspan="2"><code class="docutils literal"><span class="pre">charmm</span></code>*,
<code class="docutils literal"><span class="pre">renumber</span></code>,
<code class="docutils literal"><span class="pre">coordinates</span></code>,
<code class="docutils literal"><span class="pre">altlocs</span></code>,
<code class="docutils literal"><span class="pre">write_anisou</span></code>,
<code class="docutils literal"><span class="pre">standard_resnames</span></code></td>
</tr>
<tr class="row-odd"><td>PDBx/mmCIF</td>
<td><code class="docutils literal"><span class="pre">.cif</span></code>, <code class="docutils literal"><span class="pre">.pdbx</span></code></td>
<td><code class="docutils literal"><span class="pre">cif</span></code></td>
</tr>
<tr class="row-even"><td>PQR</td>
<td><code class="docutils literal"><span class="pre">.pqr</span></code></td>
<td><code class="docutils literal"><span class="pre">pqr</span></code></td>
<td><code class="docutils literal"><span class="pre">renumber</span></code>,
<code class="docutils literal"><span class="pre">coordinates</span></code>,
<code class="docutils literal"><span class="pre">standard_resnames</span></code></td>
</tr>
<tr class="row-odd"><td>Amber prmtop</td>
<td><code class="docutils literal"><span class="pre">.parm7</span></code>, <code class="docutils literal"><span class="pre">.prmtop</span></code></td>
<td><code class="docutils literal"><span class="pre">amber</span></code></td>
<td>None</td>
</tr>
<tr class="row-even"><td>CHARMM PSF</td>
<td><code class="docutils literal"><span class="pre">.psf</span></code></td>
<td><code class="docutils literal"><span class="pre">charmm</span></code></td>
<td><code class="docutils literal"><span class="pre">vmd</span></code></td>
</tr>
<tr class="row-odd"><td>Gromacs
topology</td>
<td><code class="docutils literal"><span class="pre">.top</span></code></td>
<td><code class="docutils literal"><span class="pre">gromacs</span></code></td>
<td><code class="docutils literal"><span class="pre">combine</span></code>,
<code class="docutils literal"><span class="pre">parameters</span></code></td>
</tr>
<tr class="row-even"><td>Gromacs GRO</td>
<td><code class="docutils literal"><span class="pre">.gro</span></code></td>
<td><code class="docutils literal"><span class="pre">gro</span></code></td>
<td><code class="docutils literal"><span class="pre">precision</span></code>, <code class="docutils literal"><span class="pre">nobox</span></code></td>
</tr>
<tr class="row-odd"><td>Mol2</td>
<td><code class="docutils literal"><span class="pre">.mol2</span></code></td>
<td><code class="docutils literal"><span class="pre">mol2</span></code></td>
<td><code class="docutils literal"><span class="pre">split</span></code></td>
</tr>
<tr class="row-even"><td>Mol3</td>
<td><code class="docutils literal"><span class="pre">.mol3</span></code></td>
<td><code class="docutils literal"><span class="pre">mol3</span></code></td>
<td><code class="docutils literal"><span class="pre">split</span></code></td>
</tr>
<tr class="row-odd"><td>Amber ASCII
coordinates</td>
<td><code class="docutils literal"><span class="pre">.rst7</span></code>, <code class="docutils literal"><span class="pre">.inpcrd</span></code>,
<code class="docutils literal"><span class="pre">.restrt</span></code></td>
<td><code class="docutils literal"><span class="pre">rst7</span></code></td>
<td><code class="docutils literal"><span class="pre">title</span></code>, <code class="docutils literal"><span class="pre">time</span></code></td>
</tr>
<tr class="row-even"><td>Amber NetCDF
restart</td>
<td><code class="docutils literal"><span class="pre">.ncrst</span></code></td>
<td><code class="docutils literal"><span class="pre">ncrst</span></code></td>
<td><code class="docutils literal"><span class="pre">title</span></code>, <code class="docutils literal"><span class="pre">time</span></code></td>
</tr>
</tbody>
</table>
<p>* PDB format only</p>
<p>The meanings and default values of each of the keywords is described in the next
subsection.</p>
<div class="section" id="keywords">
<h3>Keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">charmm</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, the SEGID will be printed in columns 73 to 76 of
the PDB file (default is <code class="docutils literal"><span class="pre">False</span></code>)</li>
<li><code class="docutils literal"><span class="pre">renumber</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, atoms and residues will be numbered according to
their absolute index (starting from 1) in the system. If <code class="docutils literal"><span class="pre">False</span></code>, the
numbers will be retained from their original source (e.g., in the original PDB
file). Default is <code class="docutils literal"><span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">coordinates</span></code> &#8211; A set of coordinates for one or multiple frames. If more
than one frame is provided, the resulting PDB or PDBx/mmCIF file will have
multiple models defined. Default is <code class="docutils literal"><span class="pre">None</span></code>, and the generated coordinates
are the ones stored on the atoms themselves.</li>
<li><code class="docutils literal"><span class="pre">altlocs</span></code> &#8211; Allowable values are <code class="docutils literal"><span class="pre">all</span></code> (print all alternate locations for
all conformers), <code class="docutils literal"><span class="pre">first</span></code> (print only the first alternate conformer), and
<code class="docutils literal"><span class="pre">occupancy</span></code> (print the conformer with the highest occupancy). Default is
<code class="docutils literal"><span class="pre">all</span></code></li>
<li><code class="docutils literal"><span class="pre">write_anisou</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, print anistropic B-factors for the various
atoms (either as a separate CIF section or as <code class="docutils literal"><span class="pre">ANISOU</span></code> records in a PDB
file). Default is <code class="docutils literal"><span class="pre">False</span></code></li>
<li><code class="docutils literal"><span class="pre">standard_resnames</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, residue names will be regularlized from
common alternatives back to the PDB standard. For example, ASH and GLH will be
translated to ASP and GLU, respectively, as they often refer to different
protomers of aspartate and glutamate.</li>
<li><code class="docutils literal"><span class="pre">vmd</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, write a VMD-style PSF file. This is very similar to
XPLOR format PSF files. Default is <code class="docutils literal"><span class="pre">False</span></code>.</li>
<li><code class="docutils literal"><span class="pre">combine</span></code> &#8211; Can be <code class="docutils literal"><span class="pre">None</span></code> to combine no molecules when writing a GROMACS
topology file. A value of <code class="docutils literal"><span class="pre">all</span></code> will combine all of the molecules into a
single moleculetype. Default is <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><code class="docutils literal"><span class="pre">parameters</span></code> &#8211; Can be <code class="docutils literal"><span class="pre">inline</span></code> (write the parameters inline in the
GROMACS topology file). Can also be a string or a file-like object. If it is
the same as the topology file name, it will be written in the previous
sections of the GROMACS topology file. Other strings will be interpreted as
filenames to print the parameters to as an include topology file. Default is
<code class="docutils literal"><span class="pre">inline</span></code>.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; The number of decimal places to print coordinates with in GRO
files. Default is 3.</li>
<li><code class="docutils literal"><span class="pre">nobox</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code> and the <code class="docutils literal"><span class="pre">Structure</span></code> does not have a unit cell
defined, no box is written to the bottom of the GRO file. Otherwise, an
enclosing box (buffered by 5 angstroms) is written</li>
<li><code class="docutils literal"><span class="pre">split</span></code> &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, all residues will be split into separate mol2 or
mol3 entries in the same file (like the ZINC database, for example). If
<code class="docutils literal"><span class="pre">False</span></code>, all residues will be part of the same mol2 or mol3 entry. Default
is <code class="docutils literal"><span class="pre">False</span></code>.</li>
<li><code class="docutils literal"><span class="pre">title</span></code> &#8211; Purely cosmetic, it will specify the title that will be written
to the coordinate files</li>
<li><code class="docutils literal"><span class="pre">time</span></code> &#8211; Also cosmetic, this is the time corresponding to the snapshot that
will be written to the coordinate files</li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The following examples use various files from the ParmEd test suite, which can
be found in the <code class="docutils literal"><span class="pre">test/files/</span></code> directory of the ParmEd source code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">parmed</span> <span class="kn">as</span> <span class="nn">pmd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a Mol2 file</span>
<span class="gp">... </span><span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;tripos1.mol2&#39;</span><span class="p">)</span>
<span class="go">&lt;ResidueTemplate DAN: 31 atoms; 33 bonds; head=None; tail=None&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a Mol2 file as a Structure</span>
<span class="gp">... </span><span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;tripos1.mol2&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;Structure 31 atoms; 1 residues; 33 bonds; NOT parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load an Amber topology file</span>
<span class="gp">... </span><span class="n">parm</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;trx.prmtop&#39;</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="s1">&#39;trx.inpcrd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parm</span>
<span class="go">&lt;AmberParm 1654 atoms; 108 residues; 1670 bonds; parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a CHARMM PSF file</span>
<span class="gp">... </span><span class="n">psf</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;ala_ala_ala.psf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psf</span>
<span class="go">&lt;CharmmPsfFile 33 atoms; 3 residues; 32 bonds; NOT parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a PDB and CIF file</span>
<span class="gp">... </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;4lzt.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cif</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;4LZT.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span>
<span class="go">&lt;Structure 1164 atoms; 274 residues; 1043 bonds; PBC (triclinic); NOT parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cif</span>
<span class="go">&lt;Structure 1164 atoms; 274 residues; 1043 bonds; PBC (triclinic); NOT parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a Gromacs topology file -- only works with Gromacs installed</span>
<span class="gp">... </span><span class="n">top</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;1aki.ff99sbildn.top&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span>
<span class="go">&lt;GromacsTopologyFile 40560 atoms [9650 EPs]; 9779 residues; 30934 bonds; parametrized&gt;</span>
</pre></div>
</div>
<p>Any of the <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> subclasses shown
above can be saved as any other kind of <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> class or subclass <em>for which the conversion is
supported</em>. For instance, a raw PDB file has no defined parameters, so it cannot
be saved as an Amber topology file. An Amber topology file, on the other hand,
has all of the information required for a PDB, and so that conversion is
supported:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parm</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test_parm.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can also convert CIF to PDB</span>
<span class="gp">... </span><span class="n">cif</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test_cif.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or you can convert PDB to CIF</span>
<span class="gp">... </span><span class="n">pdb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test_pdb.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check the resulting saved files</span>
<span class="gp">... </span><span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;test_parm.pdb&#39;</span><span class="p">)</span>
<span class="go">&lt;Structure 1654 atoms; 108 residues; 1670 bonds; NOT parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;test_cif.pdb&#39;</span><span class="p">)</span>
<span class="go">&lt;Structure 1164 atoms; 274 residues; 1043 bonds; PBC (triclinic); NOT parametrized&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pmd</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;test_pdb.cif&#39;</span><span class="p">)</span>
<span class="go">&lt;Structure 1164 atoms; 274 residues; 1043 bonds; PBC (triclinic); NOT parametrized&gt;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">File input/output with ParmEd</a><ul>
<li><a class="reference internal" href="#reading-files-with-load-file">Reading files with <code class="docutils literal"><span class="pre">load_file</span></code></a></li>
<li><a class="reference internal" href="#writing-files-with-structure-save">Writing files with <code class="docutils literal"><span class="pre">Structure.save</span></code></a><ul>
<li><a class="reference internal" href="#keywords">Keywords</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/readwrite.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fileio/parmed.formats.registry.load_file.html" title="parmed.formats.registry.load_file"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ParmEd 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Jason Swails.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>